#! /usr/bin/env python

"""
Usage: getRefTripletCounts reference

Example:
./getRefTripletCounts hg19 > hg19.triplets
"""

import sys, os
myBinDir = os.path.normpath(os.path.dirname(sys.argv[0]))
sys.path.append(myBinDir + "/../src")

from seqTools.seqTools import SeqReader, Spectrum

# Vars
chroms = ["chr1","chr2","chr3","chr4","chr5","chr6","chr7","chr8","chr9","chr10","chr11","chr12","chr13","chr14","chr15","chr16","chr17","chr18","chr19","chr20","chr21","chr22","chrX","chrY"]
chromInfo = {"chr1":"249250621","chr2":"243199373","chr3":"198022430","chr4":"191154276","chr5":"180915260","chr6":"171115067","chr7":"159138663","chrX":"155270560","chr8":"146364022","chr9":"141213431","chr10":"135534747","chr11":"135006516","chr12":"133851895","chr13":"115169878","chr14":"107349540","chr15":"102531392","chr16":"90354753","chr17":"81195210","chr18":"78077248","chr20":"63025520","chrY":"59373566","chr19":"59128983","chr22":"51304566","chr21":"48129895"}

def main():

	seqFetcher = SeqReader(sys.argv[1])
	if sys.argv[1] != "hg19":
		raise Exception("Only hg19 currently supported. Need correct chromosome length for each genome release.")
	refMutSpec = Spectrum()

	if sys.argv[2] not in chroms:
		raise Exception("Please enter a valid chromosome.")
	sys.stderr.write("Now processing " + sys.argv[2] + ".\n" )
	start = 0
	end = 3	
	#chromLen = int(chromInfo.get(sys.argv[2]))
	chromseq = seqFetcher.getChromSeq(sys.argv[2])
	while end < len(chromseq):
		#refMutSpec.add(seqFetcher.getSeq(sys.argv[2], start, end))
		refMutSpec.add(chromseq[start:end])
		start += 1
		end += 1
	refMutSpec.reportNcount()
	print refMutSpec
			


if __name__ == "__main__":
	main()
