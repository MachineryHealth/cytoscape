#! /usr/bin/env python

import sys, os
myBinDir = os.path.normpath(os.path.dirname(sys.argv[0]))
sys.path.append(myBinDir + "/../src")

from illumina.vcfTools import VCFReader

class VarTable(object):

   def __init__(self, filename):
      self.varByUid = {}
      for var in VCFReader(filename):
         if var.isVariant:
            var.UID = var.chrom +"_"+var.pos +"_"+var.refNuc+"_"+var.altNuc
            self.varByUid[var.UID] = var
   
   def hasVar(self, uid):
      return self.varByUid.has_key(uid)

def main():
   
   varlist1 = VarTable(sys.argv[1])

   outdir = sys.argv[3]
   outdir = outdir + "/" if not outdir.endswith("/") else outdir
   commonfile = file(outdir + SNVs.common,'w') 
   difffile = file(outdir + SNVs.different,'w') 
   for var in VCFReader(sys.argv[2]):
      if var.isVariant:
         var.UID = var.chrom +"_"+var.pos +"_"+var.refNuc+"_"+var.altNuc
         if varlist1.hasVar(var.UID):
            print >> commonfile, var
         else:
            print >> difffile, var
   commonfile.close()
   difffile.close()


if __name__ == "__main__":
   main()
