package org.cytoscape.browser.ui;


import java.awt.Frame;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import java.util.Arrays;
import java.util.Set;

import javax.swing.AbstractListModel;
import javax.swing.GroupLayout;
import javax.swing.GroupLayout.Alignment;
import javax.swing.JDialog;
import javax.swing.LayoutStyle;
import javax.swing.LayoutStyle.ComponentPlacement;


import org.cytoscape.browser.internal.BrowserTableModel;
import org.cytoscape.model.CyTable;


public class DeletionDialog extends JDialog {
	private CyTable attributes;

	/** Creates new form DeletionDialog */
	protected DeletionDialog(final Frame parent, final CyTable attributes) {
		super(parent, "Delete Attributes", /* modal = */ true);

		this.attributes = attributes;
		initComponents();
	}

	/**
	 * This method is called from within the constructor to initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is always
	 * regenerated by the Form Editor.
	 */

	// <editor-fold defaultstate="collapsed" desc=" Generated Code ">
	private void initComponents() {
		deletionPane = new javax.swing.JScrollPane();
		attributeList = new javax.swing.JList();
		deleteButton = new javax.swing.JButton();
		cancelButton = new javax.swing.JButton();
		descriptionLabel = new javax.swing.JLabel();

		setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
		attributeList.setModel(new AbstractListModel() {
				public int getSize() {
					return attributes.getColumnTypeMap().size();
				}

				public Object getElementAt(int i) {
					final Set<String> columnNames = attributes.getColumnTypeMap().keySet();
					final String[] sortedColumnNames = new String[columnNames.size()];
					columnNames.toArray(sortedColumnNames);
					Arrays.sort(sortedColumnNames);
					return sortedColumnNames[i];
				}
			});
		deletionPane.setViewportView(attributeList);

		deleteButton.setText("Delete");
		deleteButton.addActionListener(new ActionListener() {
				public void actionPerformed(java.awt.event.ActionEvent evt) {
					deleteButtonActionPerformed(evt);
				}
			});

		cancelButton.setText("Cancel");
		cancelButton.addActionListener(new ActionListener() {
				public void actionPerformed(java.awt.event.ActionEvent evt) {
					cancelButtonActionPerformed(evt);
					;
				}
			});

		descriptionLabel.setText("Please select attributes to be deleted:");

		final GroupLayout layout = new GroupLayout(getContentPane());
		getContentPane().setLayout(layout);
		layout.setHorizontalGroup(layout.createParallelGroup(Alignment.LEADING)
		                                .addGroup(layout.createSequentialGroup().addContainerGap()
		                                           .addGroup(layout.createParallelGroup(Alignment.LEADING)
		                                                      .addGroup(Alignment.TRAILING,
		                                                           layout.createSequentialGroup()
		                                                                 .addComponent(deleteButton)
		                                                                 .addPreferredGap(ComponentPlacement.RELATED)
		                                                                 .addComponent(cancelButton)
		                                                                 .addContainerGap())
		                                                      .addGroup(Alignment.TRAILING,
		                                                           layout.createSequentialGroup()
		                                                                 .addComponent(deletionPane,
		                                                                      GroupLayout.DEFAULT_SIZE,
		                                                                      229, Short.MAX_VALUE)
		                                                                 .addGap(12, 12, 12))
		                                                      .addGroup(layout.createSequentialGroup()
		                                                                 .addComponent(descriptionLabel)
		                                                                 .addContainerGap(26,
		                                                                                  Short.MAX_VALUE)))));
		layout.setVerticalGroup(layout.createParallelGroup(Alignment.LEADING)
		                              .addGroup(Alignment.TRAILING,
		                                   layout.createSequentialGroup().addContainerGap()
		                                         .addComponent(descriptionLabel).addGap(12, 12, 12)
		                                         .addComponent(deletionPane,
		                                              GroupLayout.DEFAULT_SIZE,
		                                              200, Short.MAX_VALUE)
		                                         .addPreferredGap(ComponentPlacement.RELATED)
		                                         .addGroup(layout.createParallelGroup(Alignment.BASELINE)
		                                                    .addComponent(deleteButton).addComponent(cancelButton))
		                                         .addContainerGap()));
		pack();
	} // </editor-fold>

	private void deleteButtonActionPerformed(ActionEvent evt) {
		final Object[] selected = attributeList.getSelectedValues();
		for (int i = 0; i < selected.length; i++)
			attributes.deleteColumn(selected[i].toString());
		dispose();
	}

	private void cancelButtonActionPerformed(ActionEvent evt) {
		dispose();
	}

	// Variables declaration - do not modify
	private javax.swing.JList attributeList;
	private javax.swing.JButton cancelButton;
	private javax.swing.JButton deleteButton;
	private javax.swing.JScrollPane deletionPane;
	private javax.swing.JLabel descriptionLabel;

	// End of variables declaration
}
