<?xml version="1.0"?>
<!-- build.xml - Build file for Sample Cytoscape Plugin -->
<project name="Cytoscape" default="jar" basedir=".">	
	<!-- Name of Plug In -->
	<!-- The name is used to create the plugin JAR file -->
	<property name="plugin.name" value="motifFinder"/>

  	<property name="src.dir" value="src"/>
	<property name="cs.dir" value="../../../../cytoscape"/>
 	<property name="build.dir" value="${basedir}/build"/>
  	<property name="classes.dir" value="${build.dir}/classes"/>
        <property name="lib.dir" value="${basedir}/../lib"/>
	<property name="cytotalk.dir" value="${basedir}/../cytoTalk"/>
	
	<!-- Global "magic" property for <javac> -->
	<property name="build.compiler" value="modern"/>
	<!--<property name="build.compiler" value="jikes"/> -->
	
	<!-- Classpath with all lib JAR Files and all Cytoscape Core classes -->
	<path id="classpath">	
		<fileset dir="${cs.dir}/lib"><include name="**/*.jar"/></fileset>
		<fileset dir="${lib.dir}"><include name="**/*.jar"/></fileset>
		<pathelement location="${classes.dir}"/>	
		<pathelement location="${cs.dir}/build/classes"/>
		<fileset dir="${cytotalk.dir}"><include name="**/*.jar"/></fileset>
		<fileset dir="${basedir}/../sequence"><include name="**/*.jar"/></fileset>
	</path>

	<!-- Target to compile cytotalk plugin class files  -->
	<target name="build_cytotalk">
		<ant antfile="${cytotalk.dir}/build.xml" inheritAll="false" target="jar"/>
	</target>

	<!--  Target to compile all Plug In Code -->
  	<target name="compile" depends="build_cytotalk">
    		<mkdir dir="${build.dir}"/>
    		<mkdir dir="${classes.dir}"/>
    		<javac srcdir="${src.dir}:${basedir}/../util/src" destdir="${classes.dir}" nowarn="on" 
		                           source="1.4" listfiles="yes" debug="yes">
			<include name="csplugins/**"/>
			<classpath refid="classpath"/>
		</javac>
                <copy todir="${classes.dir}/csplugins/isb/dreiss">
                    <fileset dir="${basedir}/../resources">
                       <include name="motifFinder.properties"/>
                    </fileset>
                </copy>   
	</target>

	<!--  Create PlugIn Jar File (Unobfuscated) -->
   	<target name="jar" depends="compile" description="Creates PlugIn Jar File.">
           <taskdef resource="genjar.properties" classpath="${lib.dir}/GenJar.jar"/>
           <!--<delete file="${build.dir}/${plugin.name}.jar"/>-->
           <genjar jarfile="${build.dir}/${plugin.name}.jar">
	      <classpath refid="classpath"/>
              <class><fileset dir="${classes.dir}">
                 <include name="**/*.class"/>
              </fileset></class>
              <resource><fileset dir="${classes.dir}">
                 <include name="**/*.properties"/>
              </fileset></resource>
              <!--<class name="djr.motif.sampler.MultiSampler"/>-->
              <library jar="${lib.dir}/sampler.jar"/>
              <classfilter>
                 <exclude name="cytoscape."/>
                 <exclude name="y."/>
                 <exclude name="ptolemy."/>
                 <exclude name="Acme."/>
                 <exclude name="org.hsqldb."/>
                 <exclude name="org.xml.sax."/>
                 <exclude name="org.apache.xmlrpc."/>
                 <exclude name="giny."/>
              </classfilter>
           </genjar>                    
	</target>

  	<!--  Target to Run Cytoscape with non-obfuscated jar file and this plugin -->
  	<target name="run" depends="jar" description="Runs Cytoscape.">
	<!-- Classpath for running Cytoscape with non-obfuscated Cytoscape Jar file -->
		<java classname="cytoscape.cytoscape" fork="true" failonerror="false">
			<classpath refid="classpath"/>
			<arg value="-p ${basedir}/../data/project"/>
		</java>
	</target>

</project>