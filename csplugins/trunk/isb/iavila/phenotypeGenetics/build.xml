<?xml version = "1.0"?>
<project name = "phenotypeGenetics" default = "compile_dev" basedir = ".">
   
   <property name = "src" location = "src"/>
   <property name = "build" location = "build"/>
   <property name = "build.compiler" value = "modern"/>
	
   <property name = "cytoscape.release" location = "../../../../cytoscape-v2.2/"/>
   <property name = "cytoscape.dev" location = "../../../../cytoscape"/>
	
   <property name = "local.lib" location = "lib"/>
   <property name = "dist" location = "dist"/>

   <property name="cytoscape.plugin.release" value="../../../../cytoscape-v2.2/plugins/extras"/>
   <property name="cytoscape.plugin.dev" value="../../../../cytoscape/plugins"/>
	
	
   <path id = "classpath_release">
       <fileset dir = "${cytoscape.release}">
          <include name = "**/*.jar"/>
       </fileset>
   	   <fileset dir = "${local.lib}">
   	      <include name = "**/*.jar"/>
   	   </fileset>
   </path>
   
   <path id = "classpath_dev">
       <fileset dir = "${cytoscape.dev}">
          <include name = "**/*.jar"/>
       </fileset>
   	   <fileset dir = "${local.lib}">
   	      <include name = "**/*.jar"/>
   	   </fileset>
   </path>

   <target name="prepare" depends="clean">
      <mkdir dir="${build}"/>
   </target>

   <target name="compile_release" depends="prepare" description="Compile with Cytoscape release">
   <!-- Compile the java code from ${src} into ${build} -->
   <javac source = "1.4" srcdir = "${src}" destdir="${build}" deprecation="on">
      <classpath refid = "classpath_release"/>
   </javac>
   </target>

   <target name="compile_dev" depends = "prepare" description="Compile with Cytoscape under development">
   <!-- Compile the java code from ${src} into ${build} -->
   <javac source = "1.4" srcdir = "${src}" destdir="${build}" deprecation="on">
      <classpath refid = "classpath_dev"/>
   </javac>
   </target>
   
   <target name="clean" description="clean up" >
      <delete dir="${build}"/>
      <delete dir="${dist}"/>
   </target>

   <target name ="jar_dev" depends="compile_dev" description="Makes jar of phenotypeGenetics, compiles using Cytoscape under development">
	 <mkdir dir = "${dist}"/>
	 <unjar overwrite="Yes" dest = "${build}">
   	 	<fileset dir = "${local.lib}">
        		<include name="**/*.jar"/>
   		</fileset>
   	 </unjar>
   	<copy file="sampleData/phenGenModes.xml" todir="${build}/phenotypeGenetics"/>
   	 <jar jarfile="${dist}/phenGen.jar">
        <fileset dir="${build}"/>
	 </jar>
   	<copy file="${dist}/phenGen.jar" todir="${cytoscape.plugin.dev}"/>
   	<echo message="phenGen.jar is complete, it is located in ${dist} and in ${cytoscape.plugin.dev}"/>
   </target>

   <target name = "jar_release" depends="compile_release" description="Makes jar of phenotypeGenetics, compiles using Cytoscape release">
	 <mkdir dir = "${dist}"/>
    	 <unjar overwrite="Yes" dest = "${build}">
   	 	<fileset dir = "${local.lib}">
   	    		<include name="**/*.jar"/>
   	    </fileset>
     </unjar>
   	 
   	 <copy file="sampleData/phenGenModes.xml" todir="${build}/phenotypeGenetics"/>
   	 <jar jarfile="${dist}/phenGen.jar">
   	 	<fileset dir="${build}"/>
     </jar>
   	<copy file="${dist}/phenGen.jar" todir="${cytoscape.plugin.release}"/>
	<echo message="phenGen.jar is complete, it is located in ${dist} and in ${cytoscape.plugin.release}"/>
   </target>
	
</project>
