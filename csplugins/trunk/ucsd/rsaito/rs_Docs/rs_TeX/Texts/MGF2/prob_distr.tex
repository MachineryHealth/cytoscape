\section{確率分布}
\label{prob_distr}


\subsection{度数分布}
\label{freq_distr}

日常生活で我々は極めて多くの「数」に接している。気温、株価、通勤時間、経
費、商品の売り上げ高、...と枚挙に暇がない。その中でも経費など我々の意思
でかなりコントロールできる数と、気温のように我々の意思ではほとんどコント
ロールができない数が存在する。商品の売り上げ高などは、一部我々の意思でコ
ントロールできる微妙なものであろう。これから取り上げたいのは、我々の意思
ではなかなか完全にコントロールできないような数がどのような法則に従ってい
るかである。

\begin{figure}
\begin{center}
\includegraphics[scale=0.7]{Figures/popu1}
\end{center}
\vspace{-2em}
\caption{2008年の日本の年齢別人口(男女別)}
\label{popu1}
\end{figure}

同じ性質を持った多数の数がどのような法則に従っているかを捉える第一歩は
{\bf 度数分布}\index{どすうぶんぷ@度数分布}を調べることであろう。これは
各値がどれくらいの頻度で観測されるかを表すものである。例えば図
\ref{popu1}(a)は、日本人の各年齢別の人口を表したものである。横軸が年齢、
縦軸はその年齢の人口を表している。度数分布をこのように縦軸に値、横軸にそ
の値の頻度をとって各棒の位置と高さで各値とその頻度を表したものを{\bf ヒ
ストグラム}\index{ヒストグラム}と呼ぶ。

この例では、より人口が多い中国やインドで同様のヒストグラムを描くと、ヒス
トグラム全体の高さも上昇する。人数そのものには関心がなく、日本の人口に対
してどの年齢層にどれくらいの割合が分布しているかを知りたいときは、縦軸に
人数そのものではなく、該当する年齢層の全体に対する割合をプロットするとい
いだろう。このようにしたのが、図\ref{popu1}(b)である。分布の形状は変わっ
ていないが、縦軸の目盛りが変わっているのが分かるだろう。人口の総数を\(N\)、
年齢\(i\)に該当する人口を\(n_{i}\)で表すと、年齢\(i\)に該当する割合
\(p_{i}\)は、

\begin{equation}
p_{i}=\frac{n_{i}}{N}
\end{equation}

\noindent
となる。ここで、

\begin{eqnarray}
p_{i}         & \geq & 0\label{eqn_bsc1}\\
\sum_{i}p_{i} & =    & 1\label{eqn_bsc2}\\
a\mbox{以上}b\mbox{未満の割合} & = & \sum_{a \leq i < b}p_{i}\label{eqn_bsc3}
\end{eqnarray}

\noindent
が成立する\footnote{この例の場合、式\ref{eqn_bsc3}は\(a\)歳以上\(b\)歳未満の人口の割合を表す。}。
このように横軸を数値、縦軸をその数値が出現する割合にした分布は後ほど述べる確率分布で使われるので、ぜひ慣れて頂きたい。

\begin{figure}
\begin{center}
\includegraphics[scale=0.7]{Figures/bread1}
\end{center}
\vspace{-2em}
\caption{パン屋から受け取るパンの重量の分布}
\label{bread1}
\end{figure}

度数分布に関しては次のような興味深い話がある\cite{Gakken1}。第二次大戦後のドイツでは食
料が不足し、1人当たりのパンの配給量は200gと決められていた。ある学者はパ
ン屋から毎日受け取るパンの重さに疑いをもち、毎日重さを量り、度数分布を作
成した。すると、図\ref{bread1}(a)のように左右がほぼ対称釣り鐘状の分布に
なったが、中心の位置が200gより低い位置にあることが分かった。

そこで学者は「君はパンの目方をちゃんと量っていないぞ。」と伝えた。すると
パン屋は「パンなんて重いものもあれば、軽いものもありますよ。」そこで学者
はヒストグラムを見せ、「本気で200gにしようとしたならば、グラフは図
\ref{bread1}(b)のようになるはずだ。ところが君が作るパンのグラフは図
\ref{bread1}(a)のようになっている。明らかに目方が不足しているじゃない
か。」と告げた。パン屋は「これからは気をつけます。」と言った。

そして次の日から学者に配給されるパンは目方が不足しなくなった。しかし、学
者がまた目方のヒストグラムを描いてみたところ、図\ref{bread1}(c)のようなグラフになった。
これでパン屋が量を多くしたのではなく、学者のところにだけ目方が足りている
パンを選んで渡していることが分かってしまった。度数分布の威力を示す1つの
例である。


\subsection{離散確率分布}
\label{sec_desc_prob}

変数\(X\)が様々な値を取り、またどのような値を取るかが確率的に決まる時、
\(X\)を確率変数\index{かくりつへんすう@確率変数}と呼ぶ。例えばサイコロを振ったときに出た目を\(X\)とすると、\(X\)
は確率的に決まるため、確率変数である。\(X\)がある値\(x\)を取る確率を\(P(X=x)\)
と表す\footnote{本書では値が変わる確率変数を意識するときは\(X\)など大文字の表記を使い、確率変数が取りうる特定の
数または特定の標本の値を意識するときは\(x\)など小文字の表記を使うように心がけたが、両者の境界や使い分けは必ずしも厳密でないときもある。}。
例えば\(X\)をサイコロを振ったときに出る目とすれば、サイコロの目が2になる確率
は\(P(X=2)=1/6\)と表される。誤解を招く恐れがないときは、\(P(x)\)と省略する。

\begin{figure}
\begin{center}
\includegraphics[scale=0.5]{Figures/dice_plot1}
\end{center}
% x <- sapply(0:10, dbinom, size=10, prob=1.0/6)
% names(x) <- 0:10
% barplot(x)
\vspace{-2em}
\caption{サイコロを例にした確率分布の例}
\label{dice_plot1}
\begin{small}
\begin{quotation}
(a) サイコロの各目が出る確率 (b) サイコロを3回振ったときの目の合計とその確率。合計が9以上11以下の確率に
該当する棒の色を濃く示した。
\end{quotation}
\end{small}
\end{figure}

\(X\)が取り得る値\(x_{1},x_{2},x_{3},\cdots\)を横軸に、その値を取る確率\(p_{1},p_{2},p_{3}\cdots\)を
縦軸にしたヒストグラムを描くと、変数\(X\)の特性が分かる。例えば横軸にサイコロの目、縦軸にその目が出る確率をヒストグラムで表すと
図\ref{dice_plot1}(a)のようになるし、またサイコロを3回振ったときの目の合計を横軸、その確率を縦軸にすると、
図\ref{dice_plot1}(b)のようになる。このように変数\(X\)の確率的な分布を表したものを確率分布\index{かくりつぶんぷ@確率分布}と呼ぶ。

図\ref{dice_plot1}の場合、ヒストグラムの各棒の幅を1とすれば、各棒の面積が確率変数が取り得る各値の確率となり、
さらに以下の3つの重要な性質が得られる。

\begin{enumerate}
\label{pd_def1}
\item \label{pd_def1_0} 棒の高さは必ず0以上となる
\item \label{pd_def1_1} 棒の面積の合計が1となる
\item \label{pd_def1_2} \(X\)が\(a\)以上、\(b\)未満となる確率\(P(a \leq X < b)\)は、以下の式で与えられる。 %\footnote{\(P(X=x_{i})\)を\(P(x_{i})\)と略した。}。
\begin{equation}
P(a \leq X < b)=\sum_{a \leq x_{i} < b}P(X=x_{i})
\label{eq_prob_basic126}
\end{equation}
\end{enumerate}

\noindent
逆に必要条件として、確率分布は上記3つの性質を満たすもの、と約束する。こうすることによって様々な確率分布に対して
その特性の計算方法を統一できる。サイコロを3回振る例で、目の合計が9以上11以下になる
確率は\(P(9)+P(10)+P(11)\)、すなわち図\ref{dice_plot1}の色の濃い棒の面積の和で表されることが分かる。

上記の例では確率分布をヒストグラムで表したが、確率変数\(X\)が値\(x\)を取る確
率\(P(x)\)を数式で表現できれば最も客観的である。これを
考えると、図\ref{dice_plot1}(a)の
分布は\(P(x)=\frac{1}{6}\)と表されるし、図\ref{dice_plot1}(b)の分布は
\(P(x)=\sum_{i=0}^{\lfloor \frac{1}{6}x-2 \rfloor} 
\frac{3(x-6i-1)(x-6i-2)}{i!(3-i)!}(-1)^{i}\)である\footnote{より一般的に
はサイコロの目の数を\(q\)(一般的なサイコロは\(q=6\))、振る回数を\(n\)と
して、\begin{equation} P(x)=\sum_{i=0}^{\lfloor \frac{x - n}{q} \rfloor} 
\frac{(x-qi-1)!}{(n-1)!(x-qi-n)!}\cdot 
\frac{n!}{i!(n-i)!}(-1)^{i}\nonumber\end{equation}
となる(Wikipedia\cite{wikipedia}の"サイコロ"参照)。
}。但し、\(\lfloor 
\alpha \rfloor\)は\(\alpha\)以下の最大の整数を表す(小数以下を切捨てた整
数)。このように確率変数\(X\)が各値\(x\)を取る確率を関数で表したものを
{\bf 確率関数}\index{かくりつかんすう@確率関数}(probability function)と呼ぶ。
さらに確率変数\(X\)が\(x\)以下の値を取る確率を\(x\)の関数で表したものを
{\bf 分布関数}(distribution function)\index{ぶんぷかんすう@分布関数}という。
例えば確率変数\(X\)がサイコロの目を表すとすれば、\(X\)の分布関数\(F(x)\)は

\begin{equation}
F(x)=\left\{
\begin{array}{ll}
0 & {\rm for}\ \ x < 0\\
\frac{\lfloor x \rfloor}{6} & {\rm for}\ \ 0 \leq x  < 6\\
1 & {\rm for}\ \ x \geq 6\\
\end{array}
\right.
\label{eq_dice_distr_func10}
\end{equation}

\noindent
となる。

確率関数を\(P(x)\)、分布関数を\(F(x)\)としたとき、式\ref{eq_prob_basic126}より

\begin{equation}
F(x)=\sum_{x_{i} \leq x}P(X=x_{i})
\end{equation}

\noindent
の関係が成立する。

さて確率分布の性質を3つ挙げたが、これは小節\ref{freq_distr}で
挙げた度数分布を割合に直したときの式
\ref{eqn_bsc1},\ref{eqn_bsc2},\ref{eqn_bsc3}と同じである。従って度数分布
に対して定義された式の\underline{割合}(\(p_{i}\))の部分を\underline{確率}(\(P(X=x_{i})\))に変えても、その式は変える前と
同じような数学的性質を持つことが想像できる。実際節\ref{avvar1}で説明するように、
"平均"を度数およびその割合に対して定義すると、それは容易に確率変数に対する定義に
拡張することができる。

さらに確率分布と度数分布の間には密接な関係
がある。\(N\)回の試行で\(X=x_{i}\)となる現象が\(n_{i}\)回起こったとする。
但し、その現象が起こる確率は\(P(X=x_{i})\)である。このとき、\(N\)が大き
くなるにつれて、\(n_{i}/{N}\)は\(P(X=x_{i})\)に近づいてゆく。これを少し見方を変えて
説明しよう。ある順不同の\(n\)個の数値の羅列\(x_{1},x_{2},\cdots,x_{n}\)(例えば全日本人の年齢の羅列など)を考え、そこから
無作為に1つを選び出すときの数値を確率変数\(X\)で表すとする。すると、縦軸を割合にした場合のその数値の度数分布と
\(X\)の確率分布は一致する。この意味で、羅列中の1つ1つの数値は確率変数\(X\)が取りうる値とみなすことができ、
さらに\(P(X=x_{i})=p_{i}\)の関係が成り立つ。


\vspace{1em}

\refstepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~各年に特定の都市Aで大地震が起きる確率は\(\frac{1}{60}\)であるとする。
今年の始めから終わりまでを1年目とし、\(x\)年目に初めて大地震が起こる確率を\(P(x)\)としたとき、\(P(x)\)の確率関数を求めよ。

\refstepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~上記確率関数の分布関数を求めよ。


\subsection{連続確率分布}
\label{cont_dist1}

\begin{figure}
\begin{center}
\includegraphics[scale=0.8]{Figures/roulette2}
\end{center}
\vspace{-1em}
\caption{サイコロルーレット}
\label{roulette2}
\end{figure}

サイコロの例では確率変数\(X\)は離散値、すなわち1,2,3,4,5,6と整数値を取
り、2.5など間の数を取ることはなかったし、1から6という範囲の中で取り得る
値は6個と有限であった。確かに現実で起こる確率的と思われる現象の中には、
気象を例に取ればある地域における年間の台風発生数、落雷数など離散的な数
で表されるものもある。しかし、降水量や平均気温など取り得る値が実数で無
限にある確率変数も存在する。これを連続量と呼ぶが、連続量に対しては確率
分布や確率関数をどのように考えればよいだろうか。図\ref{roulette2}の"サ
イコロルーレット"を例にとって説明しよう。この装置は円盤と自由に動く針で
構成されている。円盤には0から5までの数が刻んである。針を力強く弾くと、
針は何回転もした後、摩擦で停止する。停止したときに針が指し示す実数
を\(X\)とすれば、針は0と1の間などどこにでも停止しうるため、\(X\)は連続
値となる。確率変数が離散値を取るときと同じような論法で\(X\)が例えば3を
取る確率を論じることはできない。針が寸分の狂いもなくちょうど3のところで
停止することはあり得ず、確率が0になってしまうからである
\footnote{
もう少し正確に述べると、\(P(3-\frac{\Delta x}{2} \leq X \leq 3+\frac{\Delta x}{2})=\frac{\Delta x}{6}\)。
従って\(\Delta x\to 0\)のとき、\(\frac{\Delta x}{6}\to 0\)だから、
\(P(3-\frac{\Delta x}{2} \leq X \leq 3+\frac{\Delta x}{2}) \to 0\)。
\(P(X=3)\)を
\(\lim_{\Delta x\to 0}P(3-\frac{\Delta x}{2} \leq X \leq 3+\frac{\Delta x}{2})\)と考えるなら、その値は0となる。
}。

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{Figures/dice_plot_c_flat}
\end{center}
\vspace{-2em}
\caption{連続分布の離散分布への変換}
\label{dice_plot_c_flat}
\begin{small}
\begin{quotation}
サイコロルーレットから得られる値\(X\)を離散確率分布に近似したもの。
\(P(3\leq X < 5)\)となる面積を濃い色で表してある。
(a) 区間の幅を1にした場合。(b) 区間の幅をさらに縮めて0.5にした場合。
\end{quotation}
\end{small}
\end{figure}

そこで連続値を離散値に直すことを考えてみよう。例えば、サイコロルーレッ
トの針が差す数値が0以上1未満になる確率、1以上2未満になる確率、...という
ように連続値を各範囲に小分けにして離散値として扱ってはどうだろうか。この場合、
各区間の幅\(\Delta x\)は1である。
すると図\ref{dice_plot_c_flat}(a)に示すように、\(X\)の取り得る範囲は6つの
領域に分かれ、各範囲内に\(X\)が収まる確率は全て\(\frac{1}{6}\)となる。
またこの確率関数は、小節\ref{sec_desc_prob}(p.\pageref{pd_def1})で述べた確率分布の3つの性質を満
たす。すなわち、\(0 \leq a < b \leq 6\)を満たす任意の整数\(a,b\)について

\begin{equation}
P(a \leq X < b) \geq 0
\end{equation}

\noindent
より、\ref{pd_def1_0}番目の性質は満たされ、また

\begin{equation}
P(a \leq X < b)= \sum_{a \leq i < b}P(i \leq X < i + 1)
\end{equation}

\noindent
なので\ref{pd_def1_2}番目の性質も満たされている。ここで、\(i\)も整数である。また、

\begin{equation}
P(0 \leq X < 6)= \sum_{0 \leq i < 6}P(i \leq X < i + 1)=1
\end{equation}

\noindent
より、\ref{pd_def1_1}の性質も満たす。\(X\)が3以上5未満になる確率は濃い色の棒の面積の
合計で表されることも確認されたい。


区画をさらに細かくして\(\Delta x=0.5\)、すなわち0以上0.5未満、0.5以上1未
満、\(\cdots\)という範囲に分ければ、図\ref{dice_plot_c_flat}(b) のような
分布が出来上がる。区間が小さくなれば、\(X\)がその区画に入る確率は当然小
さくなってゆく。このとき注意しなければならないのは、\(\Delta x=0.5\)とな
っているため、区画\(x \leq X < x+\Delta x\)における棒の高さ=その範囲に\(X\)が収まる確率としてしまうと、
棒の面積は棒の高さ\(\times 0.5\)により、実際の確率の半分になってしまう。
そこで棒の面積をその棒の裾の範囲に\(X\)が収まる確率にするためには、
\((X\mbox{が入る区画の確率}/\Delta x)\)という補正をかける必要がある。これによって

\begin{equation}
P(x \leq X < x+\Delta x)=\mbox{区画}x \leq X < x+\Delta x\mbox{における棒の高さ}\times \Delta x
\label{eqn_bar10}
\end{equation}

\noindent
という重要な関係が保たれる。その代わり棒の高さはもはや\underline{確率ではなくなる}ことに注意されたい。

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{Figures/dice_plot2}
\end{center}
\vspace{-2em}
\caption{サイコロルーレットを3回まわしたときの合計値の離散確率分布による近似}
\label{dice_plot2}
\begin{small}
\begin{quotation}
合計値が9以上12未満になる確率に相当する面積を濃い色で表示した。
(a)区間を1刻みにして近似した分布。(b)区間を0.5刻みにして近似した分布。
\end{quotation}
\end{small}
\end{figure}

これをサイコロルーレットを3回回したときの合計値の分布で考えてみよう。区
画幅を1にしたとき(\(\Delta x=1\))は図\ref{dice_plot2}(a)のような分布に
なり、区間幅を0.5とより細かくしたとき(\(\Delta x = 0.5\))は、
図\ref{dice_plot2}(b)のようによりスムーズな曲線に近づく。区間
幅\(\Delta x\)を極限まで小さくしていったときに、幅が限りなく0に近い棒の
高さが一定値に収束するならば、その高さの推移こそが合計値の従う連続確率を表す分布となる。

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{Figures/dice_plot_limit2}
\end{center}
\vspace{-2em}
\caption{サイコロルーレットの合計値の連続分布}
\label{dice_plot_limit2}
\begin{small}
\begin{quotation}
(a) サイコロルーレットを1回回したときに出る値の連続確率分布。値が3以上5未満に
なる確率を濃い部分の面積で表した。(b)サイコロルーレットを3回回したときに得られる
値の合計値の連続確率分布。合計値が9以上12未満になる確率を濃い面積で表してある。
\end{quotation}
\end{small}
\end{figure}

例えば図\ref{dice_plot_c_flat}の分布は図\ref{dice_plot_limit2}(a)の分布
に収束するし、図\ref{dice_plot2}の分布は、図\ref{dice_plot_limit2}(b)の
分布に収束する。このように収束した分布
において、横軸の位置が\(x\)のときの棒の高さを\(x\)における確率密度といい、
また\(x\)に対して確率密度を与える関数\(f(x)\)のことを
{\bf 確率密度関数}\index{かくりつみつどかんすう@確率密度関数}(probability density function)と呼ぶ。
また確率変数\(X\)が確率密度関数\(f(x)\)に従うことを\(X \sim f(x)\)と表す。
例えば図\ref{dice_plot_limit2}(a)の確率分布を表す確率密度関数は、

\begin{equation}
f(x)=\left\{\begin{array}{ll}
0           & x < 0 \\
\frac{1}{6} & 0 \leq x < 6\\
0           & x \geq 6
\end{array}\right.
\label{eq_dice_roulette10}
\end{equation}

\noindent
となるし、また図\ref{dice_plot_limit2}(b)の確率分布を表す確率密度関数は、

\begin{displaymath}
f(x)=\left\{\begin{array}{ll}
0             & x < 0 \\
\frac{1}{432}x^{2} & 0 \leq x < 6\\
\frac{1}{216}(-x^{2}+18x-54) & 6 \leq x < 12\\
\frac{1}{432}(x^{2}-36x+324) & 12 \leq x < 18\\
0 & x \geq 18
\end{array}\right.
\end{displaymath}

\noindent
となる\cite{Hall,Irwin}。ちなみに図\ref{dice_plot_limit2}(a)の確率分布のようにある一定の範囲で一定の確率密度を持ち、
それ以外の範囲で確率密度が0になるような確率分布のことを{\bf 一様分布}\index{いちようぶんぷ@一様分布}と呼ぶ
\footnote{\(0 \leq x \leq 1\)で確率密度が1の一様分布に従う確率変
数\(X\)を\(n\)回足した合計値が従う連続分布は\(
f(x)=\frac{1}{2(n-1)!}\sum_{k=0}^{n}(-1)^k\frac{n!}{k!(n-k)!}(x-k)^{n-1}
{\rm sgn}(x-k) \)で表される\cite{Hall,Irwin}。}。

さてこれらの分布を幅\(\Delta x\)が限りなく0に近い棒の集合と考えるならば、式\ref{eqn_bar10}より、

\begin{equation}
P(x \leq X < x+\Delta x)=f(x)\Delta x
\label{eqn_bar_po11}
\end{equation}

\noindent
となり、また離散確率分布のところで述べた\ref{pd_def1_2}番目の性質から、

\begin{equation}
P(a \leq X < b)=\sum_{a \leq x_{i} < b}P(x \leq X < x+\Delta x)=\sum_{a \leq x_{i} < b}f(x_{i})\Delta x
\label{chopmany5}
\end{equation}

\noindent
が成立する。
式\ref{chopmany5}は\(\Delta x \to 0\)のとき、積分の定義から、

\begin{equation}
P(a \leq X < b)=\int_{a}^{b}f(x)dx
\label{chopmany6}
\end{equation}

\noindent
となる\footnote{
\(\Delta x\to 0\)のとき、\(X\)が特定の値を示す確率も0に近づく。すなわち、
\(P(X=b)=0\)となる。従ってこの場合、\(X\)が連続確率分布に
従うようになると、実は\(P(X < b)=P(X \leq b)\)となる。
}。つまり、確率変数がある範囲の値を取る確率は、確率密度関数の該当面
積、すなわち積分で表されるということである。小節\ref{sec_desc_prob}(p.\pageref{pd_def1})で述べた離散確率分布の
3つの重要な性質を連続確率分布に当てはめると、確率密度関数を\(f(x)\)として、以下のようになる。

\begin{enumerate}
\label{pd_def_cont1}
\item \label{pd_def2_0} 任意の\(x\)について\(f(x)\geq 0\)が成り立つ。
\item \label{pd_def2_1} 確率変数が取りうる全範囲の確率の合計は1となる。すなわち、
\begin{equation}
\int^{+\infty}_{-\infty}f(x)dx=1
\end{equation}
\item \label{pd_def2_2} \(X\)が\(a\)以上、\(b\)未満となる確率\(P(a \leq X < b)\)は、以下の式で与えられる。 
\begin{equation}
P(a \leq X < b)=\int_{a}^{b}f(x)dx
\label{prob_eqn14}
\end{equation}
\end{enumerate}

既に述べたように確率密度関数\(f(x)\)は確率そのものを表しているわけではない。例えば\(f(1)\)というのは\(X=1\)の確率
ではないことに注意しよう。確率密度関数を積分することによって確率が得られる。このような意味で直接確率が得られる
(離散確率変数に対する)確率関数とは異なる性質を持つ。しかしながら、確率密度関数から分布関数を導くことにより、
離散確率変数に対する確率分布も連続確率変数に対する確率分布も同一の枠組みで比較することが可能になる。

式\ref{prob_eqn14}より連続確率変数に対する分布関数\index{ぶんぷかんすう@分布関数}、すなわち\(X\)が\(x\)以下となる確率\(P(X \leq x)\)は次のように表される。

\begin{equation}
F(x)=P(X \leq x)=\int_{-\infty}^{x}f(x)dx
\label{prob_eqn15}
\end{equation}

\noindent
この分布関数\(F(x)\)を用いて式\ref{prob_eqn14}を書き直すと、以下のようになる。

\begin{equation}
P(a \leq X < b)=F(b)-F(a)
\end{equation}

\noindent
注目している区間において、\(F(x)\)が微分可能であれば、

\begin{equation}
\frac{dF(x)}{dx}=\lim_{\Delta x \to 0}\frac{F(x+\Delta x)-F(x)}{\Delta x}=\frac{1}{\Delta x}\int_{x}^{x+\Delta x}f(x)dx
\label{eqn188}
\end{equation}

\noindent
また注目している区間において\(F(x)\)が
% \(x \in R\)
連続であれば、
\(\Delta x \to 0\)の極限において、\(f(x+\Delta x) \simeq f(x)\)だから(コ
ラム\ref{funccont1}参照)\([x, x+\Delta x]\)の区間では\(f(x)\)は定数とみ
なせる。従って式\ref{eqn188}は、

\begin{equation}
\frac{dF(x)}{dx}=\frac{1}{\Delta x}f(x)\Delta x=f(x)
\end{equation}

\noindent
となる。つまり、分布関数を微分したものが確率密度関数となる。

\begin{figure}
\refstepcounter{column}\label{funccont1}
\begin{itembox}[l]{コラム\thecolumn:関数の連続性}
関数\(f(x)\)が\(x=a\)において
以下の条件を満たすとき、\(f(x)\)が\(x=a\)において連続であるという。
\begin{enumerate}
\item \(f(a)\)が有限確定値。
\item \(\lim_{x \to a}f(x)\)が有限確定値。
\item \(f(a)=\lim_{x \to a}f(x)\)。
\end{enumerate}

ちなみに\(f(a)=\lim_{x \to a}f(x)\)を\(\epsilon-\delta\)論法を使って表現すると、どんなに小さい正の数\(\epsilon>0\)を指定しても、
\(|x-a|<\delta\)となる全ての\(x\)について常に\(|f(x)-f(a)|<\epsilon\)を成立させるような\(\delta\)が存在する。
\end{itembox}

\vspace{1em}
\verb+ +
\end{figure}

\vspace{1em}

\refstepcounter{preexer}

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{Figures/distr_func_dice1}
\end{center}
\vspace{-2em}
\caption{サイコロ・サイコロルーレットの分布関数}
\label{distr_func_dice1}
\end{figure}

\noindent
{\bf 例題\thechapter-\thepreexer}:~ サイコロルーレットの目を表す確率変数\(X\)の分布関数\(F(x)\)を求めよう。
確率密度関数は式\ref{eq_dice_roulette10}で与えられているので、これを積分すればよい。
\(x < 0\)の区間では\(\int_{-\infty}^{x}0\cdot dx=0\)。\(0 \leq x \leq 6\)の区間では、
\(\int_{-\infty}^{0}0\cdot dx + \int_{0}^{x}\frac{1}{6}dx=0+\frac{x}{6}=\frac{x}{6}\)。
\(x \geq 6\)の区間では、
\(\int_{-\infty}^{0}0\cdot dx + \int_{0}^{6}\frac{1}{6}dx + \int_{6}^{x}0\cdot dx
=0 + 1 + 0 = 1\)。従って、

\begin{equation}
F(x)=\left\{\begin{array}{ll}
0           & x < 0 \\
\frac{x}{6} & 0 \leq x < 6\\
1           & x \geq 6
\end{array}\right.
\label{eq_dice_roulette_distr11}
\end{equation}

\noindent
サイコロの分布関数(式\ref{eq_dice_distr_func10})およびサイコロルーレットの分布関数(式\ref{eq_dice_roulette_distr11})を
図\ref{distr_func_dice1}に示す。


\vspace{1em}

\stepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~確率変数\(X\)の従う確率密度関数\(f(x)\)が

\begin{equation}
f(x)=
\left\{
\begin{array}{l}
x \ \ \ \ \ \mbox{for} \ \ 0 \leq x \leq \sqrt{2}\\
0 \ \ \ \ \ \mbox{otherwise}
\end{array}\right.
\label{eq_prob_den_func_sample1}
\end{equation}

\noindent
で与えられるとき、\(X\)が0以上1以下になる確率を求めよ。

\subsection{確率密度関数の変数変換}
\label{prob_distr_transf1}

今微分可能な確率密度関数$f(x)$が与えられ、また\(x\)の区間\([a,b]\)では
$x$が$x=g(t)$となる関数$g$によって$t$に対して一意に決まるとする。
この条件では\(g(t)\)は\(x \in [a,b]\)で増加関数あるいは減少関数である。
すなわち増加関数の場合は、対象となる区間で常に\(g'(t) > 0\)、減少関数の
場合は常に\(g'(t) < 0\)である。このとき、$t$を変数とした確率密度関数を求めることを考えよう。
小節\ref{cont_dist1}で
説明した確率密度関数の導出過程を振り返ると、\(X\)が\(a\)以上\(b\)未満と
なる確率は、

\begin{displaymath}
P(a \leq X < b)=\int_{a}^{b}f(x)dx=\lim_{\Delta x\rightarrow 0}\sum_{a \leq x_{i} < b}f(x_{i})\Delta x=\lim_{\Delta x\rightarrow 0}\sum_{t_{i}}f(g(t_{i}))\Delta x
\end{displaymath}

\noindent
ところで$\Delta t>0$に対して$g^{\prime}(t)>0$の場合(\(g(t)\)が増加関数)は$\Delta x=g(t+\Delta t)-g(t)$、$g^{\prime}(t)<0$の場合(\(g(t)\)が減少関数)は、$\Delta x=-(g(t+\Delta t)-g(t))$だから、
これらをまとめて、\(\Delta x=|g(t+\Delta t)-g(t)|\)と表せる。従って、

\begin{eqnarray}
& & \lim_{\Delta x\rightarrow 0}\sum_{t_{i}}f(g(t_{i}))\Delta x=\lim_{\Delta t\rightarrow 0}\sum_{t_{i}}f(g(t_{i}))|g(t+\Delta t)-g(t)|\nonumber\\
& & =\lim_{\Delta t\rightarrow 0}\sum_{t_{i}}f(g(t_{i}))\left|\frac{g(t+\Delta t)-g(t)}{\Delta t}\right|\Delta t\nonumber
\end{eqnarray}

\noindent
となる。\(g(t)\)が増加関数の場合は、\([a, b]\)に対応する区間は\([g^{-1}(a), g^{-1}(b)]\)だから、

\begin{equation}
\lim_{\Delta t\rightarrow 0}\sum_{g^{-1}(a) \leq t_{i} < g^{-1}(b)}f(g(t_{i}))\left|\frac{g(t+\Delta t)-g(t)}{\Delta t}\right|\Delta t\nonumber
=\int_{t=g^{-1}(a)}^{t=g^{-1}(b)}f(g(t))\left|\frac{dg}{dt}\right|dt
\end{equation}


\noindent
となる。\(g(t)\)が減少関数の場合は、\([a, b]\)に対応する区間は\([g^{-1}(b), g^{-1}(a)]\)だから、

\begin{equation}
\lim_{\Delta t\rightarrow 0}\sum_{g^{-1}(b) \leq t_{i} < g^{-1}(a)}f(g(t_{i}))\left|\frac{g(t+\Delta t)-g(t)}{\Delta t}\right|\Delta t\nonumber
=\int_{t=g^{-1}(b)}^{t=g^{-1}(a)}f(g(t))\left|\frac{dg}{dt}\right|dt
\end{equation}

\noindent
となる。

\vspace{1em}

\refstepcounter{theorem}
\noindent
{\bf 定理\thechapter-\thetheorem}:\label{prob_conv_single1}
確率密度関数\(f(x)\)が与えられ、また\(x\)が\(x=g(t)\)となる関数\(g\)によって\(t\)に対して一意に決まるとき、
\(t\)を変数とした確率密度関数は
\(\displaystyle f(g(t))\left|\frac{dg}{dt}\right|\)となる。また、

\begin{equation}
P(a \leq X \leq b) =  P(\min(g^{-1}(a), g^{-1}(b)) \leq T \leq \max(g^{-1}(a), g^{-1}(b)))
= \left|\int_{t=g^{-1}(a)}^{t=g^{-1}(b)}f(g(t))\frac{dg}{dt}dt\right|
\end{equation}

\vspace{1em}

\refstepcounter{preexer}

\noindent
{\bf 例題\thechapter-\thepreexer}:~ 
サイコロルーレット(図\ref{roulette2})から得られる値\(X\)が確率密度関数\(f(x)\)に従うとする(式\ref{eq_dice_roulette10})。
このとき\(X\)を10倍した確率変数\(Y=10X\)の従う確率分布の確率密度関数\(g(y)\)を求めよう。
式を\(X=\frac{1}{10}Y\)と変形すると、\(f(\frac{1}{10}y)=\frac{1}{6}\)、\(\frac{dx}{dy}=\frac{1}{10}\)より
\(f(\frac{1}{10}y)\frac{dx}{dy}=\frac{1}{60}\)。
また\(x \in [0, 6]\)に対応する\(y\)の区間は、\(y \in [0, 60]\)。従って、求める確率密度関数\(g(y)\)は、

\begin{equation}
g(y)=\left\{\begin{array}{ll}
\frac{1}{60} & \mbox{for}\ 0 \leq y \leq 60\\
0            & \mbox{otherwise}
\end{array}
\right.
\end{equation}

\vspace{1em}

\refstepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~ \label{prob_conv_sample190} 確率変数\(X\)の従う確率密度関数が式\ref{eq_prob_den_func_sample1}で与えられ、
確率変数\(Y\)が\(Y=3X^{2}+1\)で決定されるとき、\(Y\)の確率密度関数\(g(y)\)を求めよ。


