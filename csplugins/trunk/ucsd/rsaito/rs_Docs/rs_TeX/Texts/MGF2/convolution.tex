\section{畳み込み積分}
\label{convol12}

確率変数\(X\)と\(Y\)の和\(X+Y\)が従う確率密度関数\(h(z)\)は以下のように求めるこ
とができる。まず\(X \sim f(x), Y \sim g(y)\)とすると、その結合密度関数は、
\(f(x)g(y)\)である。\(a \leq X + Y \leq z\)となる確率は、\(h(z)\)の分布関数を\(H(z)\)とおくと、

\begin{equation}
P(a \leq X + Y \leq z)=H(z)-H(a)
\end{equation}

\noindent
と表すことができる。次に\(a \leq X + Y \leq z\)を満たす\(X\)と\(Y\)の範
囲を考えよう。\(Y\)が\(-\infty\)から\(+\infty\)まで自由に値を変えるとす
ると、\(X\)は\(a-Y \leq X \leq Z - Y\)という制約を受ける。この制約の中で
\(f(x)g(y)\)を積分すれば、\(P(a \leq X + Y \leq z)\)が求まる。すなわち
\(f(x)\)の分布関数を\(F(z)\)とおけば、

\begin{eqnarray}
P(a \leq X + Y \leq z)=H(z)-H(a)=\int_{y=-\infty}^{y=+\infty}\left\{\int_{x=a-y}^{x=z-y}f(x)dx\right\}g(y)dy\nonumber\\
=\int_{y=-\infty}^{y=+\infty}\left\{F(z-y)-F(a-y)\right\}g(y)dy\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \nonumber\\
=\int_{y=-\infty}^{y=+\infty}F(z-y)g(y)dy-\int_{y=-\infty}^{y=+\infty}F(a-y)g(y)dy 
\end{eqnarray}

\noindent
\(z\)を含む項、\(a\)を含む項だけを抜き出すと、

\begin{equation}
H(z)=\int_{y=-\infty}^{y=+\infty}F(z-y)g(y)dy, \ \ \ H(a)=\int_{y=-\infty}^{y=+\infty}F(a-y)g(y)dy
\end{equation}

\noindent
左の式について\(z\)で微分すると、

\begin{equation}
h(z)=\int_{-\infty}^{+\infty}f(z-y)g(y)dy
\label{eqn_convol1}
\end{equation}

\noindent
が求まる。式\ref{eqn_convol1}を\(f\)と\(g\)の{\bf 畳み込み積分(convolution)}\index{たたみこみせきぶん@畳み込み積分}という。

畳み込み積分を用いて\(N(\mu, \sigma^{2})\)に従う2つの確率変数\(X,Y\)の和\(X+Y\)が従う分布を求めよう。\(N(\mu, \sigma^{2})\)の
確率密度関数を\(f(x)\)として、\(X+Y\)の従う結合密度関数は、

\begin{eqnarray}
h(z) & = & \int_{-\infty}^{+\infty}f(z-y)f(y)dy=\int_{-\infty}^{+\infty}\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(z-y-\mu)^{2}}{2\sigma^{2}}}\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(y-\mu)^{2}}{2\sigma^{2}}}dy\nonumber\\
     & = & \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{\frac{1}{2}(z-2\mu)^{2}}{2\sigma^{2}}}\cdot\int_{-\infty}^{+\infty}\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{2(y-\frac{1}{2}z)^{2}}{2\sigma^{2}}}dy\nonumber\\
     & = & \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(z-2\mu)^{2}}{4\sigma^{2}}}\cdot\frac{1}{\sqrt{2}}\int_{-\infty}^{+\infty}\frac{1}{\sqrt{2\pi}\frac{1}{\sqrt{2}}\sigma}e^{-\frac{(y-\frac{1}{2}z)^{2}}{2(\frac{1}{\sqrt{2}}\sigma)^{2}}}dy\nonumber\\
     & = & \frac{1}{\sqrt{2\pi}\sqrt{2}\sigma}e^{-\frac{(z-2\mu)^{2}}{2(\sqrt{2}\sigma)^{2}}}\cdot\int_{-\infty}^{+\infty}\frac{1}{\sqrt{2\pi}\frac{1}{\sqrt{2}}\sigma}e^{-\frac{(y-\frac{1}{2}z)^{2}}{2(\frac{1}{\sqrt{2}}\sigma)^{2}}}dy\nonumber\\
     & = & N(2\mu,2\sigma^{2})\mbox{の確率密度関数}\cdot N(\frac{1}{2}z,\frac{1}{2}\sigma^{2})\mbox{の全域に関する積分}\nonumber\\
     & = & N(2\mu,2\sigma^{2})\mbox{の確率密度関数}\cdot 1 = N(2\mu,2\sigma^{2})\mbox{の確率密度関数}
\end{eqnarray}

\noindent
となり、\(X+Y\)は\(N(2\mu,2\sigma^{2})\)に従うことが示された。

\vspace{1em}

\refstepcounter{exer}

\noindent
{\bf 問題\thechapter-\theexer}:~\label{exer_nzmhard1} 畳み込み積分を用いて、サイコロルーレットを2回回したときに得られる数値の合計値が従う確率密度関数を求めよ。
