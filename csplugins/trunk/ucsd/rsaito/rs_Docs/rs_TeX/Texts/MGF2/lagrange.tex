\section{ラグランジュの未定乗数法}
\label{lagrange_mult}

関数の極値に関して、以下の有用な定理を紹介しよう\cite{lagrange10}。

\vspace{1em}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}:

\begin{eqnarray}
\mbox{最小化} & : &  z=f(x)\\
\mbox{条件~~}   & : & g_{j}(x)=0\ \ \ \ \ (j=1,\cdots,m)
\end{eqnarray}

\noindent
この問題の解の必要条件は、

\begin{equation}
\lambda=(\lambda_{1},\cdots,\lambda_{m})
\end{equation}

\noindent
を導入して、

\begin{equation}
\phi(x,\lambda)=f(x)+\sum_{j=1}^{m}\lambda_{j}g_{j}(x)\label{yamachi_5.5} % (5.5)
\end{equation}

\noindent
として、

\begin{eqnarray}
\frac{\partial\phi}{\partial x_{i}} &=& 0  \ \ \ \ \ (i=1,\cdots,n)\label{yamachi_5.6}\\ % (5.6)
\frac{\partial\phi}{\partial\lambda_{j}} &=& 0\ \ \ \ \ (j=1,\cdots,m)\label{yamachi_5.7}\\ % (5.7)
\end{eqnarray}

\noindent
が成立することである。ここで導入した$\lambda_{j}$を
{\bf ラグランジュの未定乗数(Lagrange multiplier)}\index{らぐらんじゅのみていじょうすう@ラグランジュの未定乗数}という。


\noindent
{\bf 証明\thechapter-\thetheorem}:
$x$は$n$次元であるが、$m$本の制約条件式(独立とする)があるので、値を任意
に設定できる独立変数の数は$n-m$個である。ここで、独立変数を
$x_{m+1},\cdots,x_{n}$とする。解は等号制約条件を満たし、目的関数を極値に
するから、その近傍での微分(そのうち独立なものは$n-m$個)について以下が成
立する。

\begin{eqnarray}
\sum_{i=1}^{m}\frac{\partial g_{i}}{\partial x_{i}}dx_{i}+\sum_{i=m+1}^{n}\frac{\partial g_{j}}{\partial x_{i}}dx_{i} &=& 0\ \ \ \ \ (j=1,\cdots,m)\label{yamachi_5.8} \\ % (5.8) 定数の微分は0
\sum_{i=1}^{m}\frac{\partial f}{\partial x_{i}}dx_{i}+\sum_{i=m+1}^{n}\frac{\partial f}{\partial x_{i}}dx_{i} &=& 0\label{yamachi_5.9} % (5.9)
\end{eqnarray}

\noindent
ここで式\ref{yamachi_5.8}の$m$本の各式に$\lambda_{j}$を乗じて式\ref{yamachi_5.9}に加えると次の式を得る。

\begin{equation}
\sum_{i=1}^{m}\left(\frac{\partial f}{\partial x_{i}}+\sum_{j=1}^{m}\lambda_{j}\frac{\partial g_{i}}{\partial x_{i}}\right)dx_{i}+\sum_{i=m+1}^{n}\left(\frac{\partial f}{\partial x_{i}}+\sum_{j=1}^{m}\lambda_{j}+\frac{\partial g_{j}}{\partial x_{i}}\right)dx_{i}=0\label{yamachi_5.10} % (5.10)
\end{equation}

\noindent
今$\lambda_{j}$を下式を満たすように決めれば、式\ref{yamachi_5.10}の第1項は0となる。

\begin{equation}
\frac{\partial f}{\partial x_{i}}+\sum_{j=1}^{m}\lambda_{j}\frac{\partial g_{j}}{\partial x_{i}}=0\ \ \ \ \ (i=1,\cdots,m)\label{yamachi_5.11} % (5.11)
\end{equation}

\noindent
ところで、$x_{m+1},\cdots,x_{n}$は任意の独立変数であるから、式\ref{yamachi_5.10}の第2項が恒等的に0であるためには下式が成立しなければならない。

\begin{equation}
\frac{\partial f}{\partial x_{i}}+\sum_{j=1}^{m}\lambda_{j}\frac{\partial g_{j}}{\partial x_{i}}=0\ \ \ \ \ (i=m+1,\cdots,n)\label{yamachi_5.12} %  (5.12)
\end{equation}

\noindent
式\ref{yamachi_5.11}と式\ref{yamachi_5.12}は式\ref{yamachi_5.6}を意味している。また式\ref{yamachi_5.7}は制約条件そのものである。よって、解は式\ref{yamachi_5.6}と式\ref{yamachi_5.7}を満たす必要がある。
\begin{flushright}
□
\end{flushright}

なお、式\ref{yamachi_5.6}と式\ref{yamachi_5.7}は関数$\phi(x,\lambda)$を$x$と$\lambda$それぞれに
ついて極値にする条件である。式\ref{yamachi_5.6}によって$\phi$を極値にする$x$を
$\lambda$の関数として求め、式\ref{yamachi_5.7}によってその中で制約条件を満たすように
$\lambda$を決めると考えてもよい。


