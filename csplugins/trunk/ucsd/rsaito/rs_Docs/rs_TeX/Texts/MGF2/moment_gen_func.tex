\section{積率母関数}

\subsection{積率母関数の定義}


\(X\)を確率密度関数\(f(x)\)に従う確率変数とし、\(t\)を実数とするとき、

\begin{equation}
\phi_{X}(t)=E(e^{itX})=\int_{-\infty}^{\infty}e^{itx}f(x)dx
\end{equation}

\noindent
て定義される関数\(\phi\)を確率関数\(f(x)\)の{\bf 特性関数(characteristic function)}\index{とくせいかんすう@特性関数}という。
この特性関数の式はフーリエ逆変換の式(式\ref{eqn_fourier558})と基本的に同じ形をしていることが分かる。
従って小節\ref{fourier_theorem775}の説明を踏まえると、\(f(x)\)と\(\phi_{X}(t)\)は{\bf 1対1対応}である。

\(X\)を確率変数とし、\(t\)を実数とするとき、\(e^{tX}\)の期待値を\(X\)の
{\bf 積率母関数(moment generating function)}\index{せきりつぼかんすう@積率母関数}といい、\(M_{X}(t)\)で表す。すなわち\(X\)が
離散型であれば、\(f(x)\)を確率関数として、

\begin{equation}
M_{X}(t)=E(e^{tX})=\sum_{x}e^{tx}f(x)
\end{equation}

\noindent
となる。但し、\(\sum_{x}\)は確率変数\(X\)が取り得る値全てについての合計を表す。また\(X\)が
連続型で\(-\infty<X<\infty\)とすれば、\(f(x)\)を密度関数として、

\begin{equation}
M_{X}(t)=E(e^{tX})=\int^{\infty}_{-\infty}e^{tx}f(x)dx
\label{eq2}
\end{equation}

\noindent
である。積率母関数と特性関数との間には次の関係が成り立っていることを確かめられたい。

\begin{equation}
\phi_{X}(t)=M_{iX}(t)=M_{X}(it)
\end{equation}

\noindent
従って確率密度関数\(f(x)\)とその積率母関数\(M_{X}(t)\)も{\bf 1対1対応}である
\footnote{
ある関数\(g\)が別の関数\(f\)を使って\(g(x)=f(ix)\)として得られる場合、今度は
\(f(x)=g(-ix)\)とすれば\(g\)から\(f\)が一意に得られる。従ってこの場合、\(f\)と\(g\)は
1対1対応である。
}。
なお、確率密度関数\(f(x)\)に対して特性関数は必ず存在するが、積率母関数は存在するとは限らない
\footnote{例えばコーシー分布と呼ばれる分布には特性関数\(\exp(x_{0}it-\gamma|t|)\)が存在するが(\(|t|\)は
実数の絶対値)、実数関数である積率母関数は存在しない。}。

\(e^{tx}\)をマクローリン展開すれば、

\begin{equation}
e^{tx}=1+\frac{tx}{1!}+\frac{(tx)^{2}}{2!}+\cdots
\end{equation}

\noindent
であるから、これを式\ref{eq2}に代入して、

\begin{eqnarray}
E(e^{tx})=\int^{\infty}_{-\infty}f(x)dx+\int^{\infty}_{-\infty}txf(x)dx+\frac{1}{2}\int^{\infty}_{-\infty}(tx)^{2}f(x)dx+\cdots \nonumber\\
=1+tE(x)+\frac{t^{2}}{2}E(x^{2})+\cdots=\sum_{k=0}^{\infty}\frac{t^{k}}{k!}E(x^{k})\mbox{\hspace{10em}}
\label{eq4}
\end{eqnarray}

\noindent
となる。すなわち各項は原点回りの\(k\)次の積率\(E(x^{k})\)を含んでいる。

式\ref{eq4}に関する\(k\)階の導関数で\(t=0\)とおくとその値は\(E(X^{k})\)すなわち原点回りの\(k\)の
積率に等しくなる。すなわち、

\begin{equation}
\frac{\partial^{k}M_{X}(t)}{\partial t^{k}}\biggl|_{t=0}=E(X^{k})\;\;\;\;\;k=1,2,\cdots
\end{equation}

\noindent
これが\(M_{X}(t)\)が積率母関数と呼ばれる所以である。以下、
\(\partial^{k}M_{X}(t)/\partial t^{k}|_{t=0}\)を単に\(M_{X}^{(k)}(0)\)と表すことにする。
例えば\(k=1\)であれば、

\[
M_{X}'(0)=E(X) 
\]

\noindent
で平均が得られる。また\(k=2\)ならば、

\[M_{X}''(0)=E(X^{2})\]

\noindent
すなわち、原点周りの2次の積率が得られるから、

\[E(X^{2})-{E(X)}^{2}=\sigma^{2}\]

\noindent
によって分散が得られる。

\vspace{1em}

\refstepcounter{preexer}

\noindent
{\bf 例題\thechapter-\thepreexer}:
正規分布\(N(\mu, \sigma^{2})\)の積率母関数を求めてみよう。

\begin{eqnarray}
M_{X}(t)=\int^{\infty}_{\infty}e^{tx}\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2\sigma^{2}}(x-\mu)^{2}}dx \mbox{\hspace{10em}} \nonumber\\
=\int^{\infty}_{\infty}{\rm exp}\left[-\frac{1}{2\sigma^{2}}\underbrace{\{(x-\mu)^{2}-2\sigma^{2}tx\}}_{*}\right]dx \mbox{\hspace{6em}}\nonumber
\end{eqnarray}

ところで\(*\)の部分は\((x-\mu)^{2}-2\sigma^{2}tx=x^{2}-2\mu x + \mu^{2}-2\sigma^{2}tx=x^{2}-2(\mu-\sigma^{2}t)x+\mu^{2}
=\{x-(\mu+\sigma^{2}t)\}^{2}-2\sigma^{2}\mu t - \sigma^{4}t^{2}\)
であるから、

\begin{eqnarray}
M_{X}(t)=\frac{1}{\sqrt{2\pi}\sigma}\int^{\infty}_{-\infty}{\rm exp}\left[-\frac{1}{2\sigma^{2}}\left\{x-(\mu+\sigma^{2}t)\right\}^{2}+\mu t+\frac{\sigma^{2}}{2}t^{2}\right]dx \nonumber \\
={\rm exp}\left(\mu t+\frac{\sigma^{2}}{2}t^{2}\right)\cdot \frac{1}{\sqrt{2\pi}\sigma}\int^{\infty}_{-\infty}{\rm exp}\left[-\frac{1}{2\sigma^{2}}\left\{x-(\mu+\sigma^{2}t)\right\}^{2}\right]dx \nonumber
\end{eqnarray}

\noindent
ここで、\(\frac{1}{\sqrt{2\pi}\sigma}\int^{\infty}_{-\infty}{\rm exp}\left[-\frac{1}{2\sigma^{2}}\left\{x-(\mu+\sigma^{2}t)\right\}^{2}\right]dx\)は平均\(\mu+\sigma^{2}t\)、
分散\(\sigma^{2}\)の正規分布密度関数の積分に他ならないから、1に等しい。それゆえ、

\begin{equation}
M_{X}(t)={\rm exp}\left(\mu t+\frac{\sigma^{2}}{2}t^{2}\right)
\end{equation}

\noindent
である。

\(M_{X}'(t)=(\mu+\sigma^{2}t){\rm exp}(\mu t + \frac{\sigma^{2}}{2}t^{2})\)
であるから、

\begin{equation}
M_{X}'(0)=\mu
\end{equation}

\noindent
となり、また
\(M_{X}''(t)=\sigma^{2}{\rm exp}(\mu t+\frac{\sigma^2}{2}t^{2})+(\mu+\sigma^{2}t)^{2}{\rm exp}(\mu t + \frac{\sigma^{2}}{2}t^{2})\)
から、\(M''(0)=\sigma^{2}+\mu^{2}\)、すなわち、

\begin{equation}
M''(0)-{M'(0)}^{2}=\sigma^{2}
\end{equation}

\noindent
となり、正規分布の平均は\(\mu\)、分散は\(\sigma^{2}\)であることが示された。

\subsection{確率変数の関数の積率母関数}

\(X\)を確率変数、\(t\)を実数とするとき、\(e^{tX}\)の期待値を\(X\)の積率
母関数ということは既に述べた。ここで、\(\varphi(X)\)を\(X\)の連続な関数としたとき、
\(\varphi(X)\)の積率母関数は\(e^{t\varphi(X)}\)の期待値と定義され、\(M_{\varphi(X)}(t)\)で表される。

\(X\)が連続型で\(-\infty<x<\infty\)とすれば、\(f(x)\)を密度関数として、

\begin{equation}
M_{\varphi(X)}(t)=E(e^{t\varphi(X)})=\int^{\infty}_{-\infty}e^{t\varphi(x)}f(x)dx
\label{eq11}
\end{equation}

\noindent
である。

\(e^{t\varphi(x)}\)をマクローリン展開すれば、

\begin{equation}
e^{t\varphi(x)}=1+\frac{t\varphi(x)}{1!}+\frac{(t\varphi(x))^{2}}{2!}+\cdots
\end{equation}

\noindent
であるから、これを式\ref{eq11}に代入して、

\begin{eqnarray}
E(e^{t\varphi(x)})=\int^{\infty}_{-\infty}f(x)dx+\int^{\infty}_{-\infty}t\varphi(x)f(x)dx+\frac{1}{2}\int^{\infty}_{-\infty}\{t\varphi(x)\}^{2}f(x)dx+\cdots \nonumber\\
=1+tE[\varphi(x)]+\frac{t^{2}}{2}E[\{\varphi(x)\}^{2}]+\cdots
%\label{eq4}
\end{eqnarray}

\noindent
であるから、

\begin{equation}
M^{k}(0)=E[\{\varphi(x)\}^{k}] \ \ \ \ \ k=1,2,\cdots
\end{equation}

\noindent
により、\(\varphi(x)\)の原点回りの\(k\)次の積率が計算できる。

\subsection{積率母関数と畳み込み積分}

確率密度関数が畳み込み積分(節\ref{convol12}参照)\index{たたみこみせきぶん@畳み込み積分}で表されるとき、
その積率母関数を求めよう。確率変数\(Z=X+Y\)、\(X \sim f(x)\)、\(Y \sim g(y)\)を考えると、
\(Z\)は式\ref{eqn_convol1}で表される確率密度関数に従うが、その積率母関数は式\ref{eq2}より、

\begin{equation}
M_{Z}(t)=E(e^{tZ})=\int_{-\infty}^{\infty}e^{tz}h(z)dz
=\int_{-\infty}^{\infty}e^{tz}\int_{-\infty}^{\infty}f(z-y)g(y)dydz
=\int_{-\infty}^{\infty}g(y)\underbrace{\int_{-\infty}^{\infty}e^{tz}f(z-y)dz}_{*}dy
\label{eq_mgf_conv15}
\end{equation}

\noindent
ここで*の部分内では\(y\)を定数とみなせるため、\(z=x+y\)の変数変換を行うと、\(\frac{\partial z}{\partial x}=1\)より

\begin{equation}
\int_{-\infty}^{\infty}e^{tz}f(z-y)dz=\int_{-\infty}^{\infty}e^{t(x+y)}f(x)\frac{\partial z}{\partial x}dx
=\int_{-\infty}^{\infty}e^{t(x+y)}f(x)dx
\label{eq_mgf_conv16}
\end{equation}

\noindent
式\ref{eq_mgf_conv16}を式\ref{eq_mgf_conv15}に代入して、

\begin{displaymath}
\int_{-\infty}^{\infty}g(y)
\int_{-\infty}^{\infty}e^{tz}f(z-y)dz
dy=
\int_{-\infty}^{\infty}
\int_{-\infty}^{\infty}e^{t(x+y)}f(x)g(y)dxdy
=
\int_{-\infty}^{\infty}e^{tx}f(x)dx
\int_{-\infty}^{\infty}e^{ty}g(y)dy
=M_{X}(t)+M_{Y}(t)
\end{displaymath}

\noindent
すなわち\(Z=X+Y\)のとき、

\begin{equation}
M_{Z}(t)=M_{X}(t)+M_{Y}(t)
\label{eq_mgf_conv17}
\end{equation}

\noindent
が成立する。つまり、確率変数の和は積率母関数では積として表される。


\subsection{正規分布による二項分布の近似}
\label{bigaus}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}:\(a,b\)および\(p\)を一定とするとき、確率

\begin{equation}
P(a \leq  X \leq b)=\sum_{a \leq x \leq b}\frac{n!}{x!(n-x)!}p^{x}q^{n-x}, \ \ \ \ q=1-p
\end{equation}

\noindent
は\(n\to\infty\)のとき、

\begin{equation}
\int^{(b-np)/\sqrt{npq}}_{(a-np)/\sqrt{npq}}\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}z^{2}}dz
\label{eqn48}
\end{equation}

\noindent
に収束する。

\vspace{1em}

\noindent
{\bf 証明\thechapter-\thetheorem}: 標準化された\(z=(x-np)/\sqrt{npq}\)の積率母関数は、

\begin{eqnarray}
M_{z}(t)=\sum_{x=0}^{n}\frac{n!}{x!(n-x)!}p^{x}q^{n-x}e^{t(x-np)/\sqrt{npq}}\nonumber
=e^{-\frac{np}{\sqrt{npq}}t}\sum_{x=0}^{n}\frac{n!}{x!(n-x)!}(pe^{\frac{t}{\sqrt{npq}}})^{x}q^{n-x}\nonumber\\
=e^{-\frac{np}{\sqrt{npq}}t}(q+pe^{\frac{t}{\sqrt{npq}}})^{n}\mbox{\hspace{23em}}
\end{eqnarray}

\noindent
従って、

\begin{equation}
\log M_{z}(t)=-\frac{np}{\sqrt{npq}}t+n\log(q+pe^{\frac{t}{\sqrt{npq}}})=-\frac{np}{\sqrt{npq}}t+n\log(1+u)
\label{eqn50}
\end{equation}

\noindent
但し\(u=p(-1+e^{t/\sqrt{npq}})\)となる。\(\log(1+u)\)を展開すれば、

\begin{equation}
\log(1+u)=u-\frac{u^{2}}{2}+\frac{u^{3}}{3}-\cdots
\label{eqn51}
\end{equation}

\noindent
となる。また\(u\)は\(e^{t/\sqrt{npq}}\)の展開により、

\begin{eqnarray}
u=p(-1+e^{\frac{t}{\sqrt{npq}}})
=p\left\{
\left(\frac{t}{\sqrt{npq}}\right)+
\frac{1}{2!}\left(\frac{t}{\sqrt{npq}}\right)^{2}+
\frac{1}{3!}\left(\frac{t}{\sqrt{npq}}\right)^{3}+\cdots
\right\}
\label{eqn52}
\end{eqnarray}

\noindent
となる。式\ref{eqn52}を式\ref{eqn51}に代入し、これをさらに式\ref{eqn50}に代入して整理すれば、

\begin{equation}
\log M_{z}(t)=\frac{t^{2}}{2}+\sum_{k=3}^{\infty}c_{k}\left(\frac{t}{\sqrt{npq}}\right)^{k}
\end{equation}

\noindent
となる。但し右辺の第2項は\(\frac{t}{\sqrt{npq}}\)の3次以上の項よりなる多項式で、\(c_{3},c_{4},\cdots\)は\(n\)を
含まない係数である。そこで両辺の極限を取れば\(\lim_{n\to\infty}\log M_{x}(t)=\frac{t^{2}}{2}\)、すなわち

\begin{equation}
\lim_{n\to\infty}M_{z}(t)=e^{\frac{t^{2}}{2}}
\end{equation}

\noindent
となる。これは正規分布\(N(0,1)\)の積率母関数に他ならない。よって、\(z=(x-np)/\sqrt{npq}\)は\(N(0,1)\)に
分布収束する。このことは、\(P(a\leq x \leq b)=P((a-np)/\sqrt{npq}\leq z \leq (b-np)/\sqrt{npq}\)が式\ref{eqn48}
に収束することを意味する。

\begin{flushright}
□
\end{flushright}

