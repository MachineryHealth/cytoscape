\section{テイラー展開}
\label{taylor}

\subsection{平均値の定理}
\label{subsec_mean_val_theorem10}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}: \index{ろるのていり@ロルの定理} \(f(x)\)が区間\([a,b]\)で連続、\((a,b)\)で微分可能であり、
\(f(a)=f(b)=0\)なら、\(f'(c)=0\ \ \ (a < c < b)\)となる\(c\)が少なくとも
1つ存在する。これを{\bf ロルの定理}(Rolle's theorem)という。

\noindent
{\bf 証明\thechapter-\thetheorem}: \(f(x)\)が定数なら、\(f'(x)=0\)となり、定理は明らかである。それ以外に
関しては、閉区間\([a,b]\)で\(f(x)\)には最大値\(M\)と最小値\(m\)が存在する。
\(M\neq f(a)\)なら、最大値を与える点を\(x=c\)とすると、\(M=f(c)\)。十分
小さい\(h\)に対し\(f(c+h)-f(c)\leq 0\)だから、

\begin{eqnarray}
\frac{f(c+h)-f(c)}{h}\leq 0 \ \ \ \ \ \ (h > 0)\nonumber\\
\frac{f(c+h)-f(c)}{h}\geq 0 \ \ \ \ \ \ (h < 0)\nonumber
\end{eqnarray}

\noindent
\(f(x)\)は微分可能だから、\(h\to 0\)の極限を取れば両者は\(f'(c)=0\)を与えるが、
\(f'(c)\leq 0\)かつ\(f'(c)\geq 0\)でなければならないから、\(f'(c)=0\)。
また\(M=f(a)\)のとき、\((a,b)\)に最小値\(m\)を与える\(x=c'\)が存在するから、
上と同様にして、\(f'(c)\geq 0, f'(c) \leq 0\)でなければならず、\(f'(c')=0\)となる
\(c'\)が\((a,b)\)内に存在する。

\begin{flushright}
□
\end{flushright}

\vspace{1em}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}: \index{へいきんちのていり@平均値の定理} \(f(x)\)が区間\([a,b]\)で連続で区間\((a,b)\)で微分可能ならば、

\begin{equation}
f(b)-f(a)=f'(c)(b-a)
\label{eqn_av10}
\end{equation}

\noindent
となる\(c\ \ (a < c < b)\)が少なくとも1つ存在する。これを{\bf 平均値の定理}という。

\noindent
{\bf 証明\thechapter-\thetheorem}:

\begin{displaymath}
F(x)=f(b)-f(x)-\frac{f(b)-f(a)}{b-a}(b-x)
\end{displaymath}

\noindent
を考えれば、\(F(x)\)は\([a,b]\)で連続、\((a,b)\)で微分可能である。
\(F(a)=F(b)\)だから、\(F(x)\)のロルの定義が適用できて、\(F'(c)=0\)となる\(c\)が
少なくとも区間\((a,b)\)に1つは存在する。

\begin{displaymath}
F'(x)=-f'(x)+\frac{f(b)-f(a)}{b-a}
\end{displaymath}

\noindent
より、\(F'(c)=0\)とおいて、

\begin{displaymath}
f'(c)=\frac{f(b)-f(a)}{b-a}
\end{displaymath}

\begin{flushright}
□
\end{flushright}

\((a,b)\)内の点\(c\)は\(c=a+\theta(b-a)\ \ (0 < \theta < 1)\)と表すこともでき、
式\ref{eqn_av10}は、

\begin{equation}
f(b)=f(a)+f'(a+\theta(b-a))(b-a)
\end{equation}

\noindent
と書くことができる。

\vspace{1em}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}:~ \(f(x)\)、\(g(x)\)は\([a,b]\)で連続で、\((a,b)\)で微分可能で、
\(g^{\prime}(x)\neq 0\)ならば、

\begin{equation}
\frac{f(b)-f(a)}{g(b)-g(a)}=\frac{f'(c)}{g'(c)}
\label{eq_cauchy_mv_theorem1001}
\end{equation}

\noindent
となる\(c\)が少なくとも1つ存在する(\(a<c<b\))。これをコーシー(Cauchy)の平均値の定理という。

\noindent
{\bf 証明\thechapter-\thetheorem}:~
\begin{displaymath}
\frac{f(b)-f(a)}{g(b)-g(a)}=k
\end{displaymath}

\noindent
とおけば、\(f(b)-f(a)=k(g(b)-g(a))=0\)。ここで

\begin{displaymath}
F(x)=f(b)-f(x)-k(g(b)-g(x))
\end{displaymath}

\noindent
を考えると、\(F(a)=F(b)\)。\(F'(x)=-f'(x)+kg'(x)\)で微分可能だから、Rolleの定理の条件を満たしている。
Rolleの定理から、\(F'(c)=-f'(c)+kg'(c)=0\)となる\(c\)が\((a,b)\)内に存在する。従って、
\(k=\frac{f'(c)}{g'(c)}\)より、式\ref{eq_cauchy_mv_theorem1001}を得る。

\begin{flushright}
□
\end{flushright}


\subsection{テイラーの定理}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}: \(f(x),f'(x),\cdots,f^{(n-1)}(x)\)は\([a,b]\)で連続で\((a,b)\)で\(f^{(n)}(x)\)が存在すれば、

\begin{eqnarray}
f(b)=f(a)+\frac{f'(a)}{1!}(b-a)+\frac{f''(a)}{2!}(b-a)^{2}+\nonumber\\
\cdots +\frac{f^{(n-1)}(a)}{(n-1)!}(b-a)^{n-1}+\frac{f^{(n)}(c)}{n!}(b-a)^{n}\nonumber\\
(a<c<b)
\end{eqnarray}

\noindent
となるような\(c\)が存在する。これをテイラーの定理(Taylor's theorem)と呼
び、上式の右辺を左辺の{\bf テイラー展開}\index{ていらーてんかい@テイラー展開}(Taylor expansion)という。

\vspace{1em}

\noindent
{\bf 証明\thechapter-\thetheorem}:

\begin{eqnarray}
f(b)=f(a)+\frac{f'(a)}{1!}(b-a)+\frac{f''(a)}{2!}(b-a)^{2}+\nonumber\\
\cdots +\frac{f^{(n-1)}(a)}{(n-1)!}(b-a)^{n-1}+\frac{k}{n!}(b-a)^{n}
\label{taylor_p1}
\end{eqnarray}

\noindent
とおく。\(k\)以外の変数が固定されていても、\(k\)の値を調整すれば、式\ref{taylor_p1}を
成立させることができる。右辺の\(a\)を\(x\)に置き換え、\(f(b)\)から引くと、

\begin{eqnarray}
F(x)=f(b)-f(x)-\frac{f'(x)}{1!}(b-x)-\frac{f''(x)}{2!}(b-x)^{2}-\nonumber\\
\cdots -\frac{f^{(n-1)}(x)}{(n-1)!}(b-x)^{n-1}+\frac{k}{n!}(b-x)^{n}
\end{eqnarray}

\noindent
\(F(a)=0, F(b)=0\)であり、Rolleの定理から\(F'(c)=0, a<c<b\)となる\(c\)が存在する。

\begin{equation}
F'(c)=-\frac{f^{(n)}(c)}{(n-1)!}(b-c)^{n-1}+\frac{k}{(n-1)!}(b-c)^{n-1}=0
\end{equation}

\noindent
より\(k=f^{(n)}(c)\)を得る。

\begin{flushright}
□
\end{flushright}

区間\([a,b]\)は任意だから、\(a=0\)、\(b=x\)とおけば次のマクローリン展開\index{まくろーりんてんかい@マクローリン展開}
(Maclaurin expansion)と呼ばれる展開式が得られる。

\begin{eqnarray}
f(x) & = & f(0)+\frac{f'(0)}{1!}x+\frac{f''(0)}{2!}x^{2}+\cdots\nonumber\\
     &   & +\frac{f^{n-1}(0)}{(n-1)!}x^{n-1}+\frac{f^{n}(\theta x)}{n!}x^{n}\ \ \ \ \ \ \ \ (0 < \theta < 1)
\end{eqnarray}


\section{ロピタルの定理}

\(f(a)=0\)、\(g(a)=0\)のとき、\(\frac{f(x)}{g(x)}\)は\(x=a\)で\(\frac{0}{0}\)の不定形になるという。
しかし\(x\to a\)のとき、\(\lim_{x\to a}\frac{f(x)}{g(x)}\)は存在する場合がある。これを不定形の極限値という
\cite{DiffInteg10}。
こうした不定形の極限値を求めるのに有効な以下の{\bf ロピタルの定理}\index{ろぴたるのていり@ロピタルの定理}を紹介しよう。

\vspace{1em}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}:~ \(f(x)\)、\(g(x)\)は\(a\)を除いた\(a\)の近くで連続、かつ微分可能で
\(g'(x)\neq 0\)であるとする。\(g(a)=f(a)=0\)であって、\(\lim_{x\to a}\frac{f'(x)}{g'(x)}\)が存在すれば、
\(\lim_{x\to a}\frac{f(x)}{g(x)}\)も存在し、

\begin{equation}
\lim_{x\to a}\frac{f'(x)}{g'(x)}=\lim_{x\to a}\frac{f(x)}{g(x)}
\label{eq_lhopital105}
\end{equation}

\noindent
が成立する。

\noindent
{\bf 証明\thechapter-\thetheorem}:~
\(a<x\)なる\(x\)をとり、\((a,x)\)でコーシーの平均値の定理(小節\ref{subsec_mean_val_theorem10}(p.\pageref{subsec_mean_val_theorem10}))を適用すると、

\begin{displaymath}
\frac{f(x)-f(a)}{g(x)-g(a)}=\frac{f'(c)}{g'(c)}\hspace{5em} (a<c<x)
\end{displaymath}

\noindent
仮定より、\(g(a)=f(a)=0\)だから、\(\frac{f(x)}{g(x)}=\frac{f'(c)}{g'(c)}\)。
\(x\to a\)のとき、\(c\to a\)だから、式\ref{eq_lhopital105}が得られる。

\begin{flushright}
□
\end{flushright}

\vspace{1em}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}:~ \(x\to \infty\)で\(f(x)\to 0\)、\(g(x)\to 0\)
であって\(\lim_{x\to \infty}\frac{f'(x)}{g'(x)}\)が存在すれば、
\(\lim_{x\to \infty}\frac{f(x)}{g(x)}\)も存在して式\ref{eq_lhopital105}
が成立する。

\noindent
{\bf 証明\thechapter-\thetheorem}:~
\(F(x)=f(\frac{1}{x})\)、\(G(x)=g(\frac{1}{x})\)とおけば、
\(x\to +0\)で\(F(x)\to 0\)、\(G(x)\to 0\)となるから、

\begin{displaymath}
\lim_{x\to +0}\frac{F(x)}{G(x)}
=\lim_{x\to +0}\frac{F'(x)}{G'(x)}
=\lim_{x\to +0}\frac{-\frac{1}{x^{2}}f'(\frac{1}{x})}{-\frac{1}{x^{2}}g'(\frac{1}{x})}
=\lim_{x\to +0}\frac{f'(\frac{1}{x})}{g'(\frac{1}{x})}
=\lim_{x\to \infty}\frac{f'(x)}{g'(x)}
\end{displaymath}

\noindent
ここで
\(\lim_{x\to +0}\frac{F(x)}{G(x)}
=\lim_{x\to \infty}\frac{f(x)}{g(x)}\)
であるから、式\ref{eq_lhopital105}を得る。\(x\to -\infty\)の場合も同様である。

\begin{flushright}
□
\end{flushright}

\vspace{1em}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}:~ \(f(x)\)、\(g(x)\)は\(a\)を除いた\(a\)の近くで連続、かつ微分可能で
\(g'(x)\neq 0\)であるとする。\(x\to a\)のとき、\(f(x)\to\infty\)かつ\(g(x)\to\infty\)であって、
\(\lim_{x\to a}\frac{f'(x)}{g'(x)}\)が存在すれば、
\(\lim_{x\to a}\frac{f(x)}{g(x)}\)も存在し、式\ref{eq_lhopital105}が成立する。

\noindent
{\bf 証明\thechapter-\thetheorem}:~
% \(x\to a\)のとき、\(f(x)\to\infty\)かつ\(g(x)\to\infty\)なら、
% \(F(x)=\frac{1}{f(x)}\)、\(G(x)=\frac{1}{g(x)}\)とおくと、\(x\to a\)のとき、
% \(F(x)\to 0\)かつ\(G(x)\to 0\)。
% \(\lim_{x\to a}\frac{f'(x)}{g'(x)}\)が存在するという条件を$\epsilon-\delta$論法を使って書き直すと、如何に小さい正の数$\epsilon>0$対しても、
%
% \begin{displaymath}
% \left|\frac{f^{\prime}(x)}{g^{\prime}(x)}-L\right|<\epsilon\ \ \ \ \ {\rm for}\ \ x>m
% \end{displaymath}
%
% \noindent
% を満たすような(\(\epsilon\)に呼応した)\(m\)と(\(\epsilon\)の値に関係ない)有限確定値$L$が存在するということになる。コーシーの平均値の定理を区間$[m,x]$に適用すると、
%
% \begin{displaymath}
% \left|\frac{f(x)-f(m)}{g(x)-g(m)}-L\right|<\epsilon\ \ \ \ \ {\rm for}\ \ x>m
% \end{displaymath}
%
% \noindent
% である。$f(x)$は無限大に発散するので、十分大きな$x$に対し、$f(x)>f(m)$である。従って、
%
% \begin{displaymath}
% \frac{f(x)}{g(x)}=\frac{f(x)-f(m)}{g(x)-g(m)}\cdot\frac{f(x)}{f(x)-f(m)}\cdot\frac{g(x)-g(m)}{g(x)}
% \end{displaymath}
%
% \noindent
% さらに、
%
% \begin{eqnarray}
% \left|\frac{f(x)}{g(x)}-\frac{f(x)-f(m)}{g(x)-g(m)}\right|
% & =    & \left|\frac{f(x)-f(m)}{g(x)-g(m)}\cdot\frac{f(x)}{f(x)-f(m)}\cdot\frac{g(x)-g(m)}{g(x)}-\frac{f(x)-f(m)}{g(x)-g(m)}\right|\nonumber\\
% & \leq & \left|\frac{f(x)-f(m)}{g(x)-g(m)}\right|\left|\frac{f(x)}{f(x)-f(m)}\cdot\frac{g(x)-g(m)}{g(x)}-1\right|\nonumber\\
% & <    & (|L|+\epsilon)\left|\frac{f(x)}{f(x)-f(m)}\cdot\frac{g(x)-g(m)}{g(x)}-1\right|\nonumber
% \end{eqnarray}
% 
% \noindent
% 十分大きい$x$に対し、この値は$\epsilon$未満であるので、
%
% \begin{displaymath}
% \left|\frac{f(x)}{g(x)}-L\right|<2\epsilon
% \end{displaymath}
%
% \noindent
% となる。すなわち式\ref{eq_lhopital105}が成立する。
%
与えられた条件を$\epsilon-\delta$論法を使って表現すると
如何に小さい正の数$\epsilon_{1}>0$対しても、
$0<|x-a|<\delta_{1}$を満たす(すなわち、$a-\delta_{1}<x<a$または$a<x<a+\delta_{1}$を満たす)
全ての$x$について

\begin{equation}
\left|\frac{f^{\prime}(x)}{g^{\prime}(x)}-L\right|<\epsilon_{1}
\label{eq_lhopital203}
\end{equation}

\noindent
を成立させるような($\epsilon_{1}$に呼応した)$\delta_{1}$と($\epsilon_{1}$の値に関係ない)有限確定値の$L$が
存在するということになる。
$a-\delta_{1}<x<a$となる全ての$x$について、コーシーの平均値の定理より、$a-\delta_{1}<c<x<a$および

\begin{equation}
\frac{f(x)-f(a-\delta_{1})}{g(x)-g(a-\delta_{1})}=\frac{f^{\prime}(c)}{g^{\prime}(c)}
\label{eq_lhopital204}
\end{equation}

\noindent
を満たす$c$が存在する。一方、$c$は$a-\delta_{1}<c<a$を満たしているから、式\ref{eq_lhopital203}より
$\left|\frac{f^{\prime}(c)}{g^{\prime}(c)}-L\right|<\epsilon_{1}$。
ゆえに式\ref{eq_lhopital204}より、$a-\delta_{1}<x<a$となる全ての$x$について、

\begin{equation}
\left|\frac{f(x)-f(a-\delta_{1})}{g(x)-g(a-\delta_{1})}-L\right|<\epsilon_{1}
\label{eq_lhopital205}
\end{equation}

\noindent
が成立する。また、$\displaystyle \frac{f(x)-f(a-\delta_{1})}{g(x)-g(a-\delta_{1})}$の分子と分母の両方を$g(x)$で割ると、

\begin{displaymath}
\frac{f(x)-f(a-\delta_{1})}{g(x)-g(a-\delta_{1})}=\displaystyle \frac{\frac{f(x)}{g(x)}-\frac{f(a-\delta_{1})}{g(x)}}{1-\frac{g(a-\delta_{1})}{g(x)}}
\end{displaymath}

\noindent
となるが、これを$\displaystyle \frac{f(x)}{g(x)}$について解くと、

\begin{eqnarray}
\frac{f(x)}{g(x)} & = & \frac{f(x)-f(a-\delta_{1})}{g(x)-g(a-\delta_{1})}-\frac{f(x)-f(a-\delta_{1})}{g(x)-g(a-\delta_{1})}\cdot\frac{g(a-\delta_{1})}{g(x)}+\frac{f(a-\delta_{1})}{g(x)}\nonumber\\
& = & \frac{f(x)-f(a-\delta_{1})}{g(x)-g(a-\delta_{1})}-\displaystyle \frac{f^{\prime}(c)}{g^{\prime}(c)}\cdot\frac{g(a-\delta_{1})}{g(x)}+\displaystyle \frac{f(a-\delta_{1})}{g(x)}\nonumber
\end{eqnarray}

\noindent
従って、

\begin{displaymath}
\frac{f(x)}{g(x)}-\frac{f(x)-f(a-\delta_{1})}{g(x)-g(a-\delta_{1})}=-\displaystyle \frac{f^{\prime}(c)}{g^{\prime}(c)}\cdot\frac{g(a-\delta_{1})}{g(x)}+\frac{f(a-\delta_{1})}{g(x)}
\end{displaymath}

\noindent
$x\rightarrow a$のとき、$ g(x)\rightarrow\infty$より、両辺は0に近づく。これを再び$\epsilon-\delta$論法で表すと、
如何に小さい正の数$\epsilon_{2}>0$対しても、$0<|x-a|<\delta_{2}\leq\delta_{1}$を満たす
全ての$x$について

\begin{equation}
\left|\frac{f(x)}{g(x)}-\frac{f(x)-f(a-\delta_{1})}{g(x)-g(a-\delta_{1})}\right|<\epsilon_{2}
\label{eq_lhopital210}
\end{equation}

\noindent
を成立させるような($\epsilon_{2}$に呼応した)$\delta_{2}$が存在する。
式\ref{eq_lhopital205}と式\ref{eq_lhopital210}より、

\begin{equation}
\left|\frac{f(x)}{g(x)}-L\right|<\epsilon_{1}+\epsilon_{2}
\end{equation}

\noindent
が成立する\footnote{
$a_{1}<x_{1}<b_{1}$と$a_{2}<x_{2}<b_{2}$が与えられたとき、$x_{1}-a_{1}>0, x_{1}-b_{1}<0, x_{2}-a_{2}>0, x_{2}-b_{2}<0$と変形すれば、
$x_{1}-a_{1}>0>x_{2}-b_{2}$より$x_{1}-x_{2}>a_{1}-b_{2}$、$x_{2}-a_{2}>0>x_{1}-b_{1}$より$x_{1}-x_{2}<b_{1}-a_{2}$から
$a_{1}-b_{2}<x_{1}-x_{2}<b_{1}-a_{2}$。$|x_{0}|<a_{0}$は$-a_{0}<x_{0}<a_{0}$と書き換えられることにも注意。
}。
$\epsilon_{1}+\epsilon_{2}>0$は正の数の範囲であればいくらでも小さくすることができるため、結局式\ref{eq_lhopital105}が成立する。





\begin{flushright}
□
\end{flushright}

\vspace{1em}

\refstepcounter{preexer}

\noindent
{\bf 例題\thechapter-\thepreexer}:~ \(\lim_{x\to 0}\frac{\sin x}{x}\)を求めよう。

\begin{displaymath}
\lim_{x\to 0}\frac{(\sin x)'}{(x)'}=\lim_{x\to 0}\frac{\cos x}{1}=1
\end{displaymath}

\noindent
従って、

\begin{equation}
\lim_{x\to 0}\frac{\sin x}{x}=\lim_{x\to 0}\frac{(\sin x)'}{(x)'}=1
\end{equation}

\vspace{1em}

\refstepcounter{exer}
\label{exer_0log0}
\noindent
{\bf 問題\thechapter-\theexer}:~ 以下の式が成立することを示せ。

\begin{equation}
\lim_{x\to 0}x\log_{a} x=0
\label{eq_0log0}
\end{equation}

