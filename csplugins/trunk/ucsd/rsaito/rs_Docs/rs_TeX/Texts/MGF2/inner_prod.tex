\section{内積}
\label{sec_inner_prod10}

\subsection{内積の定義}
\label{sec_inner_prod_def10}

任意のベクトル\(a,b\)に対し、実数\(\left<a,b\right>\)が対応し、\(\left<a,b\right>\)が以下の条件を全て
満たすとき、\(\left<a,b\right>\)を\(a\)と\(b\)の{\bf 内積}\index{ないせき@内積}という。

\begin{enumerate}
\label{inner_prod_def10}
\item \(\left<a,b\right>=\left<b,a\right>\) \label{ip_cond1}
\item \(\left<\lambda a,b\right>=\lambda\left<a,b\right>\) \label{ip_cond2} \hspace{1em} (\(\lambda\)は実数)
\item \(\left<a+b,c\right>=\left<a,c\right>+\left<b,c\right>\) \label{ip_cond3} \hspace{1em} (\(c\)はベクトル)
\item 常に\(\left<a,a\right> \geq 0\)。但し等号が成り立つのは、\(a=o\)のときに限る(必要十分条件)。\label{ip_cond4}
\end{enumerate}

任意のベクトル\(v\)に対し、

\begin{equation}
\|v\|=\sqrt{\left<v,v\right>}
\end{equation}

\noindent
を\(v\)の長さ、または{\bf ノルム}\index{のるむ@ノルム}という。さらにベクトル\(u\)が

\begin{equation}
\left<u,u\right>=1
\label{eq_unit_vector100}
\end{equation}

\noindent
を満たすとき、\(u\)を単位ベクトルという。

さて、ベクトル\(a,b\)に対して内積となる実数\(\left<a,b\right>\)は実際に
はどのように計算すればよいだろうか。実は本小節の冒頭で述べた内積の4つの
条件を満たす内積の定義は様々なものが考えられる。以下、2つのベクトル
\(a=(a_{1},a_{2},\cdots,a_{n})^{t},\ b=(b_{1},b_{2},\cdots,b_{n})^{t}\)
に対して式\ref{eq_inner_prod_std10}で定義される内積を標準内積と呼ぶ。

\begin{equation}
\left<a,b\right>=\sum_{i=1}^{n}a_{i}b_{i}
\label{eq_inner_prod_std10}
\end{equation}

\noindent
するとベクトル\(v=(v_{1},v_{2},\cdots,v_{n})^{t}\)の長さは

\begin{equation}
\|v\|=\sqrt{\left<v,v\right>}=\sqrt{v_{1}^2+v_{2}^{2}+\cdots+v_{n}^{2}}\nonumber\\
\end{equation}

\noindent
となる。
標準内積は内積の4つの条件を全て満たすことを確かめられたい。また式\ref{eq_inner_prod_std10}は以下のように
書きなおすこともできる(問題\ref{chap_linear_alge}-\ref{inner_prod_cos102}参照)。

\begin{equation}
\left<a,b\right>=\|a\|\ \|b\|\cos \theta
\label{eq_inner_prod_std11}
\end{equation}

\noindent
但し\(\theta\)はベクトル\(a\)と\(b\)の
なす角である。


\(\left<a,b\right>=0\)のとき、\(a\)と\(b\)は{\bf 直交}するという。標準内積を表す式\ref{eq_inner_prod_std10}に当てはめて考えると、
\(o\)でない2つのベクトルが直交するとき、
\(\theta=\frac{\pi}{2}\)となり、2つのベクトルは直角を成すことが分かる。
\(o\)でないベクトル\(a_{1},a_{2},\cdots,a_{n}\)はどの
2つも直交するとき、直交系と呼ばれる。さらに単位ベクトルからなる直交系、すなわち、

\begin{displaymath}
\left<u_{i},u_{j}\right>=\delta_{ij}
\end{displaymath}

\noindent
を満たすベクトル\(u_{1},u_{2},\cdots,u_{n}\)を{\bf 正規直交系}\index{せいきちょっこうけい@正規直交系}と呼ぶ。
ここで\(\delta_{ij}\)は

\begin{displaymath}
\delta_{ij}=\left\{
\begin{array}{cc}
1 & (i=j)\\
0 & (i\neq j)\\
\end{array}\right.
\end{displaymath}

\noindent
と定義され、クロネッカー(Kronecker)のデルタと呼ばれる。


\vspace{1em}

\refstepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~ 2つのベクトル\(a=(\sqrt{3},1)^{t},b=(2,2\sqrt{3})^{t}\)について
標準内積および2つのベクトルが成す角度を求めよ。

\refstepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~ \label{inner_prod_cos102} 2つのベクトル
\(a=(a_{1},a_{2},\cdots,a_{n})^{t},\ b=(b_{1},b_{2},\cdots,b_{n})^{t}\)
の内積が式\ref{eq_inner_prod_std10}、すなわち標準内積で定義されるとき、
余弦定理(小節\ref{Law_of_cosines_II}参照)
を使って式\ref{eq_inner_prod_std11}を導出せよ。


\subsection{単位ベクトルへの分解}
\label{unit_vector_dec}

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{Figures/vector_norm0}
\end{center}
\vspace{-2em}
\caption{ベクトルの単位ベクトルへの分解}
\label{vector_norm0}
\end{figure}

図\ref{vector_norm0}に示すように、
互いに直交する2つの単位ベクトル\(u_{1},u_{2}\)およびベクトル\(x\)を考える。
\(x\)は\(u_{1},u_{2}\)の一次結合で表される。すなわち、

\begin{equation}
x=a_{1}u_{1}+a_{2}u_{2}
\label{eq_inner_prod_ossha1}
\end{equation}

\noindent
となる
実数\(a_{1},a_{2}\)が存在する。
\(\left<x,u_{1}\right>\)はベクトル\(x\)を\(u_{1}\)の軸で考えたときの位置に相当し、
\(\left<x,u_{1}\right>u_{1}\)は原点からその位置までのベクトルである。実際、\(\left<x,u_{1}\right>u_{1}\)
から\(x\)の先端へ向かうベクトル\(x-\left<x,u_{1}\right>u_{1}\)と\(\left<x,u_{1}\right>u_{1}\)
との内積は

\begin{eqnarray}
\left<x-\left<x,u_{1}\right>u_{1},\ \left<x,u_{1}\right>u_{1}\right> & = & \left<x,\ \left<x,u_{1}\right>u_{1}\right>-\left<\left<x,u_{1}\right>u_{1},\ \left<x,u_{1}\right>u_{1}\right>\ \ \ \mbox{(内積の\ref{ip_cond3}番目の条件)}\nonumber\\
& = &\left<x,u_{1}\right>^{2}-\left<x,u_{1}\right>^{2}\left<u_{1},u_{1}\right>\ \ \ \mbox{(内積の\ref{ip_cond2}番目の条件)}\nonumber\\
& = & 0\ \ \ \mbox{(式\ref{eq_unit_vector100})}\nonumber
\end{eqnarray}

\noindent
であるから、\(x-\left<x,u_{1}\right>u_{1}\)と\(\left<x,u_{1}\right>u_{1}\)は直交する。
同様にして、\(x-\left<x,u_{2}\right>u_{2}\)と\(\left<x,u_{2}\right>u_{2}\)も直交する。
式\ref{eq_inner_prod_ossha1}の両辺に\(u_{1}\)を内積として掛けると、

\begin{displaymath}
\left<x, u_{1}\right>=a_{1}\left<u_{1},u_{1}\right> + a_{2}\left<u_{2},u_{1}\right>=a_{1}
\end{displaymath}

\noindent
となる。同様にして、\(a_{2}=\left<x,u_{2}\right>\)が求まる。つまり、

\begin{equation}
x=\left<x, u_{1}\right>u_{1}+\left<x, u_{2}\right>u_{2}
\end{equation}

\noindent
となる。

これをもう少し一般化して考えよう。今ベクトル\(x\)が\(n\)個の互いに
直交する単位ベクトル
\(u_{1},u_{2},\cdots,u_{n}\)の一次結合、すなわち

\begin{equation}
x=\sum_{i=1}^{n}a_{i}u_{i}
\label{eq_e198}
\end{equation}

\noindent
と表わすことができるとする。このとき、単位ベクトル\(u_{i}\)を1つの軸にし
たとき、その軸における\(x\)の座標\(a_{i}\)は\(\left<x,u_{i}\right>\)であ
り、\(u_{i}\)方向のベクトルの成分は、\(\left<x,u_{i}\right>u_{i}\)となる。
すなわち式\ref{eq_e198}は、

\begin{equation}
x=\sum_{i=1}^{n}\left<x,u_{i}\right>u_{i}
\label{eq_e205}
\end{equation}

\noindent
と表される。

\vspace{1em}

\refstepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~ ベクトル\(x=(11,5)^{t}\)を2つの互いに直交する
単位ベクトル\(u_{1}=(\frac{\sqrt{2}}{2},\frac{\sqrt{2}}{2})^{t}, u_{2}=(-\frac{\sqrt{2}}{2},\frac{\sqrt{2}}{2})^{t}\)の一次結合で表せ。


\subsection{グラム・シュミットの直交化法}

\begin{figure}
\begin{center}
\includegraphics[scale=0.5]{Figures/vector_norm2}
\end{center}
\vspace{-2em}
\caption{2次元の場合のベクトル直交化}
\label{vector_norm1}
\begin{small}
\begin{quotation}
ベクトル\(x_{1}\)と\(x_{2}\)で張られる部分空間(すなわち、\(u_{1}\)と\(u_{2}\)の正規直交系で張られる部分空間)
を灰色で示してある。この場合、部分空間は面である。図では部分空間があたかも有限の大きさのように見えるが、
本来部分空間は無限の大きさであり、図では面の一部を分かりやすく切り取ったものである。また面は原点を通り、
\(x_{1},x_{2},u_{1},u_{2}\)の全てのベクトルがこの面に含まれる。
\end{quotation}
\end{small}
\end{figure}

図\ref{vector_norm1}に示すように、線形独立なベクトル\(x_{1},x_{2}\)を考える。
\(x_{1}=v_{1}\)とし、\(u_{1}=\frac{v_{1}}{\|v_{1}\|}\)とすると、\(u_{1}\)は
\(x_{1}\)と同じ向きの単位ベクトルとなる。
\(v_{2}=x_{2}-\left<x_{2},u_{1}\right>u_{1}\)とすると、小節\ref{unit_vector_dec}で述べたように、
\(v_{2}\)と\(x_{1}\)や\(u_{1}\)は直交する。従って\(u_{2}=\frac{v_{2}}{\|v_{2}\|}\)とすれば、
\(u_{1}\)と\(u_{2}\)は\(x_{1}\)と\(x_{2}\)が張る部分空間の正規直交基底となる。これを一般化した
定理を以下に紹介しよう。

\vspace{1em}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}: 線形独立なベクトル\(x_{1},x_{2},\cdots,x_{n}\)に対し、
\(u_{1},u_{2},\cdots,u_{n}\)を順次以下の手順で定めれば、
\(u_{1},u_{2},\cdots,u_{n}\)は正規直交系である。

\begin{center}
\begin{tabular}{ll}
\(v_{1}=x_{1}\) & \(u_{1}=\displaystyle \frac{v_{1}}{||v_{1}||}\)\\
\vspace{-0.75em}\\
\(v_{2}=x_{2}-\left<x_{2},u_{1}\right>u_{1}\) & \(u_{2}=\displaystyle \frac{v_{2}}{||v_{2}||}\)\\
\vspace{-0.75em}\\
\(v_{3}=x_{3}-\left<x_{3},u_{1}\right>u_{1}-\left<x_{3},u_{2}\right>u_{2}\) &
\(u_{3}=\displaystyle \frac{v_{3}}{||v_{3}||}\)\\
\(\vdots\) & \(\vdots\)\\
\(v_{n}=x_{n}-\displaystyle \sum_{k=1}^{n-1}\left<x_{n},u_{k}\right>u_{k}\) &
\(u_{n}=\displaystyle \frac{v_{n}}{||v_{n}||}\)
\end{tabular}
\end{center}

\noindent
これをグラム‐シュミット(Gram-Schmidt)の直交化法という。

\noindent
{\bf 証明\thechapter-\thetheorem}:
\(u_{1}=\displaystyle \frac{v_{1}}{||v_{1}||}\)、\(v_{2}=x_{2}-\left<x_{2},u_{1}\right>u_{1}\)とすると、
\(x_{1}\)、\(x_{2}\)が線形独立であるから、\(v_{2}\neq o\)。さらに、

\begin{eqnarray}
\left<v_{2}, u_{1}\right> & = & \left<x_{2} - \left<x_{2},u_{1}\right>u_{1},u_{1}\right> = \left<u_{1}, x_{2}\right> - \left<x_{2}, u_{1}\right>\left<u_{1}, u_{1}\right>\nonumber\\
                 & = & \left<x_{2}, u_{1}\right> - \left<x_{2}, u_{1}\right> = 0\nonumber
\end{eqnarray}

\noindent
であるから、\(v_{2}\)と\(u_{2}\)は直交する。従って、\(u_{2}=\displaystyle \frac{v_{2}}{||v_{2}||}\)とおけば、\(u_{1}\)、\(u_{2}\)は
正規直交系になる。同様なことを繰り返せば、\(v_{i}\neq o\)で\(v_{i}\)は\(u_{1},u_{2},\cdots, u_{i-1}\)の全てと直交するので、
\(u_{1},u_{2},\cdots,u_{i-1},\displaystyle u_{i}=\frac{v_{1}}{||v_{i}||}\)が正規直交系をなすことが分かる。従って、正規直交系
\(u_{1},u_{2},\cdots,u_{i}\)が得られる。

\begin{flushright}
□
\end{flushright}

\vspace{1em}

\refstepcounter{preexer}

\noindent
{\bf 例題\thechapter-\thepreexer}: 3次元ユークリッド空間\(R^{3}\)において、3つのベクトル
\(a_{1}=(1,1,0)^{t}\)、
\(a_{2}=(1,0,1)^{t}\)、
\(a_{3}=(1,1,-1)^{t}\)からグラム-シュミットの直交化法により正規直交基底を作ろう。

\begin{eqnarray}
u_{1}&=&\displaystyle \frac{x_{1}}{\left\|x_{1}\right\|}=\frac{1}{\sqrt{2}}\left(\begin{array}{l}
1\\
1\\
0
\end{array}\right)\nonumber\\
v_{2}&=&x_{2}-\displaystyle \left\langle x_{2},u_{1}\right\rangle u_{1}=\left(\begin{array}{l}
1\\
0\\
1
\end{array}\right)-\frac{1}{\sqrt{2}}\cdot\frac{1}{\sqrt{2}}\left(\begin{array}{l}
1\\
1\\
0
\end{array}\right)=\frac{1}{2}\left(\begin{array}{l}
1\\
-1\\
2
\end{array}\right)\nonumber\\
u_{2}&=&\displaystyle \frac{v_{2}}{\left\|v_{2}\right\|}=\frac{1}{\sqrt{6}}\left(\begin{array}{l}
1\\
-1\\
2
\end{array}\right)\nonumber\\
v_{3}&=&x_{3}-\left\langle x_{3},u_{1}\right\rangle u_{1}-\left\langle x_{3},u_{2}\right\rangle u_{2}
=\displaystyle \left(\begin{array}{l}
1\\
1\\
-1
\end{array}\right)-\sqrt{2}\frac{1}{\sqrt{2}}\left(\begin{array}{l}
1\\
1\\
0
\end{array}\right)+\frac{2}{\sqrt{6}}\frac{1}{\sqrt{6}}\left(\begin{array}{l}
1\\
-1\\
2
\end{array}\right)=\frac{1}{3}\left(\begin{array}{l}
1\\
-1\\
-1
\end{array}\right)\nonumber\\
u_{3}&=&\displaystyle \frac{b_{3}}{\left\|b_{3}\right\|}=\frac{1}{\sqrt{3}}\left(\begin{array}{l}
1\\
-1\\
-1
\end{array}\right)\nonumber
\end{eqnarray}

\noindent
従って、求める正規直交系は、
$\{u_{1},u_{2},u_{3}\}=\left\{\displaystyle \frac{1}{\sqrt{2}}\left(\begin{array}{l}
1\\
1\\
0
\end{array}\right),\frac{1}{\sqrt{6}}\left(\begin{array}{l}
1\\
-1\\
2
\end{array}\right),\frac{1}{\sqrt{3}}\left(\begin{array}{l}
1\\
-1\\
-1
\end{array}\right)\right\}$


\vspace{1em}

\refstepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~ \label{gramsch_exer1} \(x_{1}=(2,0,1)^{t}\), \(x_{2}=(-1,1,0)^{t}\), \(x_{3}=(0,1,-1)^{t}\)
の3つのベクトルからグラム‐シュミットの直交化法により正規直交系\(\{u_{1},u_{2},u_{3}\}\)を作れ。


\subsection{行列式と超平行面体の超体積との関係}
\label{subsec_det_volume10}

図\ref{vector_norm1}の$v_{2}$に着目しよう。$v_{2}$は$x_{2}$から「$x_{2}$の$u_{1}$方向に平行な
成分」を引いたベクトル、すなわち平行四辺形の面積を「底辺の長さ×高さ」と
して$u_{1}$の絶対値を底辺の長さとすると、$v_{2}$の長さは高さに相当する。
故に、$x_{1}$と$x_{2}$で構成される平行四辺形の面積(底辺の長さ×高さ)は、
$v_{1}=x_{1}$と$v_{2}$で構成される長方形の面積と等しい。

同様の議論を繰り返していくと、
\((x_{1}\ x_{2}\ \cdots\ x_{n})\)
で構成される平行$2n$面体の体積は、
\((v_{1}\ v_{2}\ \cdots\ v_{n})\)
で構成される超直方体の体積と等しくなることが分かる。超直方体の体積\(\||V|\|\)は、

\begin{equation}
\||V|\|=\prod_{k=1}^{n}||v_{k}||
\end{equation}

\noindent
になる。

さて、
$(x_{1}\ x_{2}\ \cdots\ x_{n})$
の行列式をグラム‐シュミットの方法と絡めながら求めよう。
式\ref{eq_det19}と式\ref{eq_det28}に注意すれば、

\begin{eqnarray}
&& |x_{1}\ x_{2}\ \cdots\ x_{n}|\nonumber\\
&& =\|x_{1}\|\left|\frac{x_{1}}{\|x_{1}\|}\ \ x_{2}\ \cdots\ x_{n}\right|\nonumber\\
&& =\|x_{1}\|\ |u_{1}\ x_{2}\ \cdots\ x_{n}|\nonumber\\
&& =\|x_{1}\|\ |u_{1}\ \ x_{2}-\left<x_{2}, u_{1}\right>u_{1}\ \cdots\ x_{n}|\nonumber\\
&& =\|x_{1}\|\ \|x_{2}-\left<x_{2}, u_{1}\right>u_{1}\|\left|u_{1}\ \ \frac{x_{2}-\left<x_{2}, u_{1}\right>u_{1}}{\|x_{2}-\left<x_{2},u_{1}\right>u_{1}\|}\ \cdots \ x_{n}\right|\nonumber\\
&& =\|x_{1}\|\ \left|\right|x_{2}-\left<x_{2}, u_{1}\right>u_{1}\|\ |u_{1}\ u_{2}\ \cdots\ x_{n}|\nonumber\\
&& \vdots\nonumber\\
&& =\|x_{1}\|\ \left|\right|x_{2}-\left<x_{2},u_{1}\right>\|\cdots\|x_{n}-\sum_{k=1}^{n-1}\left<x_{n},u_{k}\right>u_{k}\|\ |u_{1}\ u_{2}\ \cdots\ u_{n}|\nonumber\\
&& =|u_{1}\ u_{2}\ \cdots\ u_{n}|\prod_{k=1}^{n}\|v_{k}\|=|u_{1}\ u_{2}\ \cdots\ u_{n}|\ \||V|\|
\end{eqnarray}

\noindent
を得る。% 但しここでは行列\(X\)の行列式を\(|X|\)と表している。
正規直交ベクトルで構成された行列
$U=(u_{1}\ u_{2}\ \cdots\ u_{n})$
は直交行列
$U^{t}U=E$
を成し、$|U|=\pm 1$
である。よって
\(\displaystyle \|\ |x_{1}\ x_{2}\ \cdots\ x_{n}|\ \|=\||V|\|\)
を得る。すなわち、
$(x_{1}\ x_{2}\ \cdots\ x_{n})$
の行列式の絶対値は、これが成す平行$2n$面体の体積と等しい。

\vspace{1em}

\refstepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~ 2つのベクトル\(a=(a_{1},a_{2})^{t}\)と\(b=(b_{1},b_{2})^{t}\)が形成する平行四辺形の面積を求めよ。

