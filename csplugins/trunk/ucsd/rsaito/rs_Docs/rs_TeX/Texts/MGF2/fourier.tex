\section{複素系フーリエ級数展開}

\label{fourier}
\label{fourier_coeff}

小節\ref{sec_inner_prod_def10}(p.\pageref{inner_prod_def10})で内積を定義したが、実は内積はベクトルだけでなく、
関数に対しても定義することができる。例えば連続かつ\([a,b]\)で有限確定値を持つ
関数\(f(t),g(t)\)に対して、

\begin{equation}
\left<f(t),g(t)\right>=\int_{a}^{b}f(t)g(t)dt
\label{inner_func_basic50}
\end{equation}

\noindent
を定義すると、これは\(\left<f(t),g(t)\right>\)は小節\ref{sec_inner_prod_def10}で与えた内積の定
義を満たしていることが確かめられる。さらに
周期\(T\)を持つ関数\(f(t)=f(t-T),\ g(t)=g(t-T)\)に対しては

\begin{equation}
\left<f(t),g(t)\right>=\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(t)\overline{g(t)}dt
\label{inner_fourier_basic50}
\end{equation}

\noindent
を考えると、この場合の\(\left<f(t),g(t)\right>\)も
内積の定義を満たしていることが知られているのである。ここで\(\overline{x}\)は\(x\)の複素
共役である。本節では、式\ref{inner_fourier_basic50}で定義される内積を元に
複素系フーリエ級数展開と呼ばれる式を導出しよう。

まず、以下の関数\(\psi_{n}(t)=\psi_{n}(t-T)\)を考える。

\begin{equation}
\psi_{n}(t)=e^{inw_{0}t}=\cos nw_{0}t+i\sin nw_{0}t
\end{equation}

\noindent
ここで\(n\)は整数、すなわち\(n=0,\pm 1,\pm 2,\cdots\)であり、\(\displaystyle w_{0}=\frac{2\pi}{T}\)とする。
\(\sin t\)、\(\cos t\)がともに周期が\(2\pi\)であること、
そして\(\sin \frac{2\pi}{T}t\)、\(\cos \frac{2\pi}{T}t\)とするとともに周期が\(T\)になることに注意すると、
\(\psi_{n}(t)\)は周期が\(T\)、すなわち\(\psi_{n}(t)=\psi_{n}(t-T)\)となることが分かる\footnote{
この場合周期を最小の値で表すと\(\frac{T}{n}\)となるが、\(n\)が整数であれば、\(\psi_{n}(t)=\psi_{n}(t-T)\)が成立することに変わりはない。
周期を最小の値で表したものを基本周期という。
}。

ここで式\ref{inner_fourier_basic50}で定義される内積を\(\psi_{n}(t),\psi_{m}(t)\)に対して計算すると、

\begin{eqnarray}
\left<\psi_{n}(t), \psi_{m}(t) \right> & = & \frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\psi_{n}(t)\overline{\psi_{m}(t)}dt=\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\left\{\cos nw_{0}t+i\sin nw_{0}t\right\}\left\{\cos mw_{0}t-i\sin mw_{0}t\right\}dt\nonumber\\
                            & = & \frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\cos nw_{0}t\cos mw_{0}tdt-\frac{i}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\cos nw_{0}t\sin mw_{0}tdt\nonumber\\
                            &   & +\displaystyle \frac{i}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\sin nw_{0}t\cos mw_{0}tdt+\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\sin nw_{0}t\sin mw_{0}t
\label{eqn_fourier128}
\end{eqnarray}


一般に$c$を定数として、$\cos cx$をちょうどその周期\(\alpha(\cos cx=\cos c(x-\alpha)=\cos c(x+\alpha))\)の範囲の区間$[a,a+\alpha]$について積分すると、$c>0$なら

\begin{displaymath}
\int_{a}^{a+\alpha}\cos cxdx=\left[\frac{1}{c}\sin cx\right]_{a}^{a+\alpha}=\left[\frac{1}{c}\cos\left\{cx-\frac{\pi}{2}\right\}\right]_{a}^{a+\alpha}
\end{displaymath}

\noindent
となり、$\cos\left\{ca-\frac{\pi}{2}\right\}=\cos\left\{c(a+\alpha)-\frac{\pi}{2}\right\}$より$0$となる。
$c=0$なら、$\displaystyle \int_{a}^{a+\alpha}\cos cdx=\alpha$である。従って、式\ref{eqn_fourier128}の最右辺の第1項は$n\neq m$なら、

\begin{equation}
\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\cos nw_{0}t\cos mw_{0}tdt=\frac{1}{2T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\left\{\cos(n+m)w_{0}t+\cos(n-m)w_{0}t\right\}dt=0
\end{equation}

\noindent
となり、$n=m$なら、

\begin{equation}
\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\cos nw_{0}t\cos mw_{0}tdt=\frac{1}{2T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\cos(n-m)w_{0}tdt=\frac{1}{2}
\end{equation}

\noindent
となる。残りの項についても同様の計算をすると結局

\begin{eqnarray}
\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\cos nw_{0}t\cos mw_{0}tdt
=\left\{\begin{array}{l}
\frac{1}{2};\ \ \ n=m\\
0;\ \ \ n\neq m
\end{array}\right.\\
\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\sin nw_{0}t\sin mw_{0}tdt
=\left\{\begin{array}{l}
\frac{1}{2};\ \ \ n=m\\
0;\ \ \ n\neq m
\end{array}\right.\\
\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\cos nw_{0}t\sin mw_{0}tdt
=\left\{\begin{array}{l}
\frac{1}{2};\ \ \ n=m\\
0;\ \ \ n\neq m
\end{array}\right.
\end{eqnarray}


\noindent
が得られ、これを式\ref{eqn_fourier128}に代入すると、

\begin{equation}
\left<\psi_{n}(t),\psi_{m}(t)\right>=\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}\psi_{n}(t)\overline{\psi_{m}(t)}dt=\left\{\begin{array}{l}
1;\ \ \ n=m\\
0;\ \ \ n\neq m
\end{array}\right.
\end{equation}

\noindent
となり、関数\(\cdots, \psi_{-2}(t),\psi_{-1}(t),\psi_{0}(t),\psi_{1}(t),\psi_{2}(t)\cdots\)は正規直交系を形成していることが分かる。

周期波\(f(t)=f(t-T)\)と\(\psi_{n}(t)=e^{inw_{0}t}\)の内積\(c_{n}\)は、

\begin{eqnarray}
c_{n} & = & \frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(t)\overline{\psi_{n}(t)}dt
=\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(t)\{\overline{\cos nw_{0}t+i\sin nw_{0}t}\}dt\nonumber\\
      & = &\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(t)\{\cos nw_{0}t-i\sin nw_{0}t\}dt
=\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(t)e^{-inw_{0}t}dt
\label{eqn_fourier_coeff1}
\end{eqnarray}

\noindent
で表される。ここで複素数\(c_{n}\)を{\bf フーリエ係数(Fourier coefficient)}\index{ふーりえけいすう@フーリエ係数}と呼ぶ
\footnote{
\(T\)を基本周期の何倍に設定するかによって\(c_{n}\)の値も変わってくることに注意。
}。
\(c_{n}\)と\(c_{-n}\)は複素共役の関係にあることに注意しよう。
\(c_{n}\)は関数\(f(x)\)の成分\(\psi_{n}(t)\)の大きさを表している。
従って\(f(t)\)が\(\psi_{n}(t)\ (n=0,\pm 1,\pm 2,\cdots)\)が張る正規直交系の空間\footnote{正確には部分空間。}に含まれていれば、
式\ref{eq_e205}より

\begin{equation}
f(t)=\sum_{n=-\infty}^{+\infty}c_{n}\psi_{n}(t)
=\sum_{n=-\infty}^{+\infty}c_{n}e^{inw_{0}t}
\label{eqn_fourier130}
\end{equation}

\noindent
となる。ここで

\begin{eqnarray}
\sum_{n=-\infty}^{\infty}c_{n}e^{inw_{0}t} & = & \sum_{n=-\infty}^{-1}(c_{n}\cos nw_{0}t+ic_{n}\sin nw_{0}t)+c_{0}+\sum_{n=1}^{\infty}(c_{n}\cos nw_{0}t+ic_{n}\sin nw_{0}t)\nonumber\\
                                           & = & c_{0}+\displaystyle \sum_{n=1}^{\infty}\left\{(c_{n}+c_{-n})\cos nw_{0}t+i(c_{n}-c_{-n})\sin nw_{0}t)\right\}\nonumber\\
                                           & = & \sum_{n=0}^{\infty}K_{n}\cos(nw_{0}t-\theta_{n})
\label{eqn_fourier131}
\end{eqnarray}

\noindent
とおくと、\(K_{n}\cos(nw_{0}t-\theta_{n})=K_{n}\cos\theta_{n}\cos nw_{0}t+K_{n}\sin\theta_{n}\sin nw_{0}t\)より、

\begin{eqnarray}
c_{n}+c_{-n} & = & K_{n}\cos\theta_{n}\label{eqn_fourier151}\\
i(c_{n}-c_{-n})& = & K_{n}\sin\theta_{n}\label{eqn_fourier152}
\end{eqnarray}

\noindent
となる\footnote{正確には\(c_{0}\)だけ\(c_{0}=K_{0}\cos\theta_{0}\)となる。
式\ref{eq_fourier750}を適用すると、\(\theta_{0}=0\)となり、式\ref{eq_fourier749}の下式が成立する。
}。
式\ref{eqn_fourier151}と式\ref{eqn_fourier152}の平方和を計算すると、\(\sin^{2}\theta_{n}+\cos^{2}\theta_{n}=1\)に注意すれば、

\begin{equation}
K_{n}^{2}\cos^{2}\theta_{n}+K_{n}^{2}\sin^{2}\theta_{n}=K_{n}^{2}=(c_{n}+c_{-n})^{2}-(c_{n}-c_{-n})^{2}
=2c_{n}\cdot2c_{-n}=4||c_{n}||^{2}
\label{eq_fourier_K10}
\end{equation}

\noindent
となる。式\ref{eqn_fourier152}を式\ref{eqn_fourier151}で割ると、\(\frac{\sin\theta}{\cos\theta}=\tan\theta\)に注意すれば、

\begin{equation}
\tan\theta=\displaystyle \frac{i(c_{n}-c_{-n})}{c_{n}+c_{-n}}=\frac{\mbox{Im}\ c_{n}}{\mbox{Re}\ c_{n}}
\label{eq_fourier_tan10}
\end{equation}

% \noindent
% より、
%
% \begin{displaymath}
% \theta=-\tan^{-1}\frac{\mbox{Im}\ c_{n}}{\mbox{Re}\ c_{n}}
% \end{displaymath}

\noindent
となる。ここで\(\mbox{Re}\ c_{n}\)は\(c_{n}\)の実数部、\(\mbox{Im}\ c_{n}\)は\(c_{n}\)の虚数部を表す。

以上、式
\ref{eqn_fourier_coeff1},\ref{eqn_fourier130},\ref{eqn_fourier131},\ref{eq_fourier_K10},\ref{eq_fourier_tan10}を以下の定理にまとめる。

\vspace{1em}

\refstepcounter{theorem}

\noindent
{\bf 定理\thechapter-\thetheorem}:~\label{fourier_coeff_basic96} 周期が\(T\)の関数\(f(T)\)の複素系フーリエ級数展開は、\(w_{0}=\frac{2\pi}{T}\)として、

\begin{equation}
f(t)
=\sum_{n=0}^{\infty}K_{n}\cos(nw_{0}t-\theta_{n})
=\sum_{n=-\infty}^{+\infty}c_{n}e^{inw_{0}t}
\label{eqn_fourier160}
\end{equation}

\noindent
で与えられる。ここでフーリエ係数\(c_{n}\)は

\begin{equation}
c_{n}=\frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(t)e^{-inw_{0}t}dt
\label{eqn_fourier_coeff1_2}
\end{equation}

\noindent
であり、\(K_{n}\)と\(\theta_{n}\)は、

\begin{eqnarray}
K_{n}& = & \left\{\begin{array}{ll}
2\ ||c_{n}||; & n=1,2,\cdots\\
c_{0};      & n=0\\
\end{array}\right.\label{eq_fourier749}\\
\theta_{n}& = & -\tan^{-1}\frac{\mbox{Im}\ c_{n}}{\mbox{Re}\ c_{n}}
\label{eq_fourier750}
\end{eqnarray}

\noindent
で与えられる。

\vspace{1em}

さて、定理\ref{chap_fourier}-\ref{fourier_coeff_basic96}を導出する上で
\(f(t)\)が\(\psi_{n}(t)\ (n=0,\pm 1,\pm 2,\cdots)\)が張る正規直交系の空間\footnote{正確には部分空間。}に含まれている、という
重要な仮定を置いた。これは言い換えれば周期波が三角関数の級数で表すことができることを意味している。これを{\bf フーリエの定理}
と呼ぶ。この仮定が正しければ、周期波\(f(t)\)から式\ref{eqn_fourier_coeff1_2}によって得られるフーリエ係数\(c_{n}\)を
式\ref{eqn_fourier160}に基づいて
\(e^{inw_{0}}\)を掛けて全て足し合わせればもとの
\(f(t)\)に戻るが、これについては小節\ref{fourier_theorem775}で再び触れよう\label{pg_fourier_theorem119}。

\vspace{1em}

\refstepcounter{preexer}

\noindent
{\bf 例題\thechapter-\thepreexer}:~ 
$f(t)=5+2\cos t+3\cos 2t+\cos 3t$を複素系フーリエ級数展開してみよう。まず、
$T=2\pi, w_{0}=1$である。

\begin{eqnarray}
c_{0} & = & \frac{1}{2\pi}\int_{-\pi}^{\pi}(5+2\cos t+3\cos 2t+\cos 3t)(\cos 0-i\sin 0)dt\nonumber\\
      & = & \frac{1}{2\pi}\int_{-\pi}^{\pi}(5+2\cos t+3\cos 2t+\cos 3t)dt=5\nonumber\\
c_{1} & = & \frac{1}{2\pi}\int_{-\pi}^{\pi}(5+2\cos t+3\cos 2t+\cos 3t)(\cos t-i\sin t)dt\nonumber\\
      & = & \frac{1}{2\pi}\int_{-\pi}^{\pi}(5\cos t+2\cos t\cos t+3\cos 2t\cos t+\cos 3t\cos t\nonumber\\
      &   & -5i\sin t-2i\cos t\sin t-3i\cos 2t\sin t-i\cos 3t\sin t)dt=\frac{1}{2}\nonumber\\
c_{-1}& = & \frac{1}{2\pi}\int_{-\pi}^{\pi}(5+2\cos t+3\cos 2t+\cos 3t)(\cos(-t)-i\sin(-t))dt=\frac{1}{2}\nonumber\\
c_{2} & = & \frac{3}{2}, \ \ \ c_{-2}=\frac{3}{2},\ \ \ c_{3}=\frac{1}{2}\ \ \  c_{-3}=\frac{1}{2}\nonumber
\end{eqnarray}

\noindent
なお、\(K_{0}=5, K_{1}=2, K_{2}=3, K_{3}=1\)であり、また
\(\mbox{Im}\ c_{i}=0 (i=-2,-1,0,1,2)\)だから、$\theta_{-2}=\theta_{-1}=\theta_{0}=\theta_{1}=\theta_{2}=0$

\vspace{1em}

\refstepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~ \label{exer_fourier1}
\(T=2\pi\)として、$f(t)=4\displaystyle \sin(3t-\frac{\pi}{4})$の
フーリエ係数\(c_{n}\)を求め、それをもとにこの式の複素系フーリエ級数展開を示せ。

\begin{figure}
\begin{center}
\includegraphics[scale=0.75]{Figures/pulse3}
\end{center}
% \vspace{-2em}
\caption{周期的なパルスの例}
\label{pulse3}
\end{figure}

\vspace{1em}

\refstepcounter{preexer}

\noindent
{\bf 例題\thechapter-\thepreexer}:~ 
周期\(T\)の関数\(f_{T}(t)\)が図\ref{pulse3}に示すように、

\begin{displaymath}
f_{T}(t) = \left\{
\begin{array}{ll}
0                  & -\frac{T}{2} \leq t < \tau\\
\frac{1}{2\tau}    &  -\tau \leq t < \tau\\
0                  & \tau \leq t < \frac{T}{2}\\
\end{array}\right.\\
\end{displaymath}

\noindent
で与えられるとき、フーリエ係数\(c_{n}\)や\(K_{n}\)、\(\theta_{n}\)を求めよう。

\begin{eqnarray}
c_{n} & = & \frac{1}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f_{T}(t)\left\{\cos nw_{0}t-i\sin nw_{0}t\right\}dt
        =  \frac{1}{2\tau T}\int_{-\tau}^{\tau}\left\{\cos nw_{0}t-i\sin nw_{0}t\right\}dt\nonumber\\
      & = & \frac{1}{2nw_{0}\tau T}\left[\sin nw_{0}t\right]_{-\tau}^{\tau}+\frac{i}{2nw_{0}\tau T}\left[\cos nw_{0}t\right]_{-\tau}^{\tau}
        = \frac{1}{nw_{0}\tau T}\sin nw_{0}\tau\nonumber\\
      & = & \frac{1}{2\pi n\tau}\sin\frac{2\pi n}{T}\tau
\end{eqnarray}

\begin{eqnarray}
K_{n} & = & \left\{\begin{array}{ll} 
\frac{1}{\pi n\tau}\sin\frac{2\pi n}{T}\tau & n=1,2,3,\cdots\\
\frac{\tau}{T}                         & n=0
\end{array}\right.\\
\theta_{n} & = & 0
\end{eqnarray}

\vspace{1em}

\refstepcounter{exer}
\noindent
{\bf 問題\thechapter-\theexer}:~ \label{exer_fourier3}
周期\(T\)の関数\(f_{T}(t)\)が、

\begin{displaymath}
f_{T}(t) = \left\{
\begin{array}{ll}
0                                    & -\frac{T}{2} \leq t < \tau\\
\frac{1}{\tau}(1+\frac{1}{\tau}t)    &  -\tau \leq t < 0\\
\frac{1}{\tau}(1-\frac{1}{\tau}t)    &      0 \leq t < \tau\\
0                                    & \tau \leq t < \frac{T}{2}\\
\end{array}\right.\\
\end{displaymath}

\noindent
で与えられるとき、フーリエ係数\(c_{n}\)や\(K_{n}\)、\(\theta_{n}\)を求めよ。

% \begin{displaymath}
% c_{n}=\frac{1}{2\pi}\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}}\cos nt-i\sin ntdt=\frac{1}{2\pi n}\left[\sin nt\right]_{-\frac{\pi}{2}}^{\frac{\pi}{2}}-\frac{i}{2\pi n}\left[-\cos nt\right]_{-\frac{\pi}{2}}^{\frac{\pi}{2}}
% =\displaystyle \frac{1}{\pi n}\sin\frac{\pi n}{2}
% \end{displaymath}

% \begin{displaymath}
% K_{n}=\left\{\begin{array}{ll}
% \frac{2}{\pi n}\sin\frac{\pi n}{2} & n > 0\\
% \frac{1}{2} & n = 0
% \end{array}\right.\ \ \ \ \ \ \ \ \ \ \theta_{n}=0
% \end{displaymath}



