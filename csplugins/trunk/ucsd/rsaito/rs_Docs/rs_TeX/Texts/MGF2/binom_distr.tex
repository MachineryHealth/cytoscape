\section{二項分布}
\label{binom}

サイコロの目について他の確率現象を考えてみよう。サイコロを3回振ったとき
に5の目が2回出る確率はどれくらいだろうか。サイコロを1回目に振ったと
き、2回目に振ったとき、そして3回目に振ったときの目をそれぞ
れ\(X_{1},X_{2},X_{3}\)で表すと、
サイコロを振る試行は毎回独立と考えれらるので(つまり1回目の結果が2回目に
影響することはない)、

\begin{equation}
P(X_{1}\land X_{2}\land X_{3})=P(X_{1})P(X_{2})P(X_{3})
\label{eqn_ind105}
\end{equation}

\noindent
となる。これを元に以下のステップで3回中2回5が出る
確率を考えることができる。

\begin{enumerate}
\item 5の目が出る確率は、\(P(X_{i}=5)=\frac{1}{6}\ (1 \leq i \leq 3)\)である。
\item 5以外の目が出る確率は、\(P(X_{i}\neq 5)=\frac{5}{6}\ (1 \leq i \leq 3)\)である。
\item サイコロの目が2回5になる組み合
わせは、\(X_{1}=5,X_{2}=5,X_{3}\neq 5\)または\(X_{1}=5,X_{2}\neq
5,X_{3}=5\)または\(X_{1}\neq 5,X_{2}=5,X_{3}=5\)の3通りである。
\item いずれの場合も5が2回、5以外が1回なので、各確率
は式\ref{eqn_ind105}より\((\frac{1}{6})^{2}\frac{5}{6}\)である。
\item さらに各事象は排反なので、結
局5の目が2回出る確率は\(3\times(\frac{1}{6})^{2}\frac{5}{6}\)となる。
\end{enumerate}

これを一般に拡張して考えよう。今事象\(a\)が起こる確率が\(p\)の試行を\(n\)回繰り返すことを
考えよう。\(i\)回目\(1\leq i \leq n\)の試行結果を\(X_{i}\)とすると、各試行が
独立であるとすれば、

\begin{equation}
P(X_{1} \land P_{2} \land \cdots \land P_{n})=
P(X_{1})P(X_{2})\cdots P(X_{n})
\end{equation}

\noindent
である。

\begin{enumerate}
\item 各試行において、事象\(a\)が起こる確率は\(P(X=a)=p\)である。
\item 各試行において、事象\(a\)が起こらない確率は\(P(X\neq a)=1-p\)である。
\item \(n\)回の試行の中で事象\(a\)が\(x\)回起きるときの\(X_{a:1}=a,X_{a:2}=a,\cdots,X_{a:x}=a\)の組合せの個数を\(_{n}C_{x}\)と表す
\footnote{\(_{n}C_{x}\)を\({n \choose x}\)と記述している書籍も多数ある。}。
\item いずれの場合も\(a\)が\(x\)回、\(a\)以外が\(n-x\)回なので、各確率は
\(p^{x}(1-p)^{n-x}\)である。
\item さらに各事象は排反なので、結局事象\(a\)が\(x\)回起こる確率は
\(p^{x}(1-p)^{n-x}\ _{n}C_{x}\)である。
\end{enumerate}

次に\(n\)個の対象のなかから\(x\)個の対象を選ぶ組み合わせ
の\(_{n}C_{x}\)がいくつになるかを考えよう。最初に\(n\)個の中からの最初
の1個の選び方はもちろん\(n\)通りである。最初の選択肢のそれぞれについて、
残りの\(n-1\)個からの次の2個目の選び方は\(n-1\)通りであるため、1個目
と2個目の組み合わせの数は\(n(n-1)\)通りとなる。さらに1個目と2個目の選択
肢のそれぞれについて、残りの中から\(n-2)\)通りの選び方があるため、1個
目、2個目、3個目の選び方は\(n(n-1)(n-2)\)通りとなる。この考え方を進める
と、\(1,2,3,\cdots x\)個目の選び方は全部で\(n(n-1)(n-2)\cdots
(n-x+1)\)通りとなる。

今\(n\)個の対象に\(1,2,\cdots,n\)と番号を振る。すると例え
ば\(n=4\)で\(x=3\)のとき、選び方は、
\((1,2,3)\), 
\((1,2,4)\), 
\((1,3,2)\), 
\((1,3,4)\), 
\((1,4,2)\), 
\((1,4,3)\), 
\((2,1,3)\), 
\((2,1,4)\), 
\((2,3,1)\), 
\((2,3,4)\), 
\((2,4,1)\), 
\((2,4,3)\), 
\((3,1,2)\), 
\((3,1,4)\), 
\((3,2,1)\), 
\((3,2,4)\), 
\((3,4,1)\), 
\((3,4,2)\), 
\((4,1,2)\), 
\((4,1,3)\), 
\((4,2,1)\), 
\((4,2,3)\), 
\((4,3,1)\), 
\((4,3,2)\)
の\(4 \times 3 \times 2=24\)通りとなる。ところがよく見てみると、実は\(1,2,3\)と\(1,3,2\)が別の選び方として
数えられている。\(1,2,3\)を含む組み合わせは\(3 \times 2 \times 1=6\)通りある。
これは全ての(互いに異なる)組み合わせについて成立するため、組み合わせで考えた
場合、結局\(\frac{4\times 3\times 2}{3\times 2\times 1}=4\)通りである
ことが分かる。これを一般化すると、\(1,2,3,\cdots x\)には全部で\(x(x-1)\cdots 2\cdot1
=x!\)の並び方があるため、以下が成立する。

\begin{equation}
_{n}C_{x}=\frac{n(n-1)(n-2)\cdots (n-x+1)}{x!}
=\frac{n!}{x!(n-x)!}
\end{equation}

\noindent
以上により、事象\(a\)が起こる確率が\(p\)の試行を\(n\)回繰り返したとき、
\(a\)が\(x\)回観測されるときの確率分布\(B(n, p)\)の関数\(P(x)\)は、

\begin{equation}
P(x)=p^{x}(1-p)^{n-x}\ _{n}C_{x}=p^{x}(1-p)^{n-x}\frac{n!}{x!(n-x)!}
\label{eq_binom}
\end{equation}

\noindent
となる。


\begin{figure}
\begin{center}
\includegraphics[scale=0.72]{Figures/binom_hist1}
\end{center}
% \vspace{-2em}
\caption{サイコロを\(n\)回振ったときに5の目が出る回数が従う分布}
\label{binom_hist1}
\begin{small}
\begin{quotation}
(a)\(n=10\)、 (b) \(n=30\)、 (c) \(n=50\)のときの二項分布\(B(n,p)\)を示した。
\end{quotation}
\end{small}
\end{figure}

図\ref{binom_hist1}にこの分布の例を3つ示す。\(n\)が大きくなるにつれ、分布が
全体的になめらかかつ左右対称に近付いてゆくことが分かる。

平均\(\mu\)は以下のように計算される。

\begin{eqnarray}
\mu & = & \sigma\sum_{x=0}^{n}x\, _{n}C_{x}p^{x}(1-p)^{n-x}=\sum_{x=1}^{n}x\cdot\frac{n!}{x!(n-x)!}p^{x}(1-p)^{n-x}\nonumber\\
    & = & np \sum_{x=1}\frac{(n-1)!}{(x-1)!(n-1-(x-1))!}p^{x-1}(1-p)^{n-1-(x-1)}\nonumber\\
    & = & np \sum_{y=0}^{n-1}\frac{(n-1)!}{y!(n-1-y)!}p^{y}(1-p)^{n-1-y}=np\sum_{y=0}^{n-1}\, _{n-1}C_{y}p^{y}(1-p)^{n-1-y}\nonumber\\
    & = & np(p+1-p)^{n-1}=np
\end{eqnarray}

また分散\(\sigma^{2}\)は以下のように計算される。

\begin{eqnarray}
\sigma^{2} & = & E(X^{2})-\{E(X)\}^{2}=E\{X(X-1)+X)-\mu^{2}\nonumber\\
           & = & E\{X(X-1)\}+_{n}\mu-\mu^{2}
\label{eqn_binom36}
\end{eqnarray}

\noindent
ここで、

\begin{eqnarray}
E\{X(X-1)\} & = & \sum_{x=0}x(x-1)\, _{n}C_{x}p^{x}(1-p)^{n-x}\nonumber\\
            & = & \displaystyle \sum_{x=2}^{n}x(x-1)\cdot\frac{n!}{x!(n-x)!}p^{x}(1-p)^{n-x}\nonumber\\
            & = & n(n-1)p^{2}\displaystyle \sum_{x=2}^{n}\frac{(n-2)!}{(x-2)!(n-2-(x-2))!}p^{x-2}(1-p)^{n-2-(x-2)}\nonumber\\
            & = & n(n-1)p^{2}\displaystyle \sum_{y=0}^{n-2}\frac{(n-2)!}{y!(n-2-y)!}p^{y}(1-p)^{n-2-y}\nonumber\\
            & = & n(n-1)p^{2}\displaystyle \sum_{y=0}^{n-2}\, _{n-2}C_{y}p^{y}(1-p)^{n-2-y}=n(n-1)p^{2}(p+(1-p))^{n-2}\nonumber\\
            & = & n(n-1)p^{2}\nonumber
\end{eqnarray}

\noindent
であるから、これを式\ref{eqn_binom36}に代入して、

\begin{equation}
\sigma^{2}=n(n-1)p^{2}+np-n^{2}p^{2}=np-np^{2}=np(1-p)
\end{equation}

\noindent
となる。

