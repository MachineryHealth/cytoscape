\documentclass{jarticle}

\usepackage[dvips]{graphicx}
\usepackage{wrapfig}
\usepackage{ascmac}
\usepackage{makeidx}

\setlength{\oddsidemargin}{0.5cm}
\setlength{\evensidemargin}{0.5cm}
\setlength{\textwidth}{423pt}
\setlength{\topmargin}{0pt}

\newcounter{preexer}[section]
\setcounter{preexer}{1}

\newcounter{exer}[section]
\setcounter{exer}{1}

\title{{\normalsize 考える習慣を身に着ける}\\
数理統計学入門\footnote{To my wife and Dr. Nozomu Yachie.}\\
\vspace{3em}
\includegraphics{dada1}\\
\vspace{6em}
}
\author{慶應義塾大学先端生命科学研究所・環境情報学部\\
専任講師 斎藤輪太郎}

\makeindex

\begin{document}
\maketitle

\thispagestyle{empty}

\newpage

\section*{序文}

統計学は自然科学、社会科学、人文科学などあらゆる分野に応用できる可能性を
秘めた学問分野であり、これを習得することには大変大きな意義がある。

最近は統計処理用言語Rなど統計処理ソフトがかなり充実し、原理をそれほど知
らなくても複雑な処理を手軽に行えるようになってきた。それとともに、どの統
計ソフトを使うと何ができるを幅広く知っていることが重要との考え方が徐々に
支配的になりつつある。

確かに重要なのは自然科学や社会科学の中で解決したい問題
そのものであって、統計はその手段にしか過ぎない、という考え方もある。

しかしながら、統計の数理的な側面を深く勉強すれば、データの見方が変わって
くるし、独自の統計処理を設計できるようになるだろう。そこに待っているのは
データの中に潜む新たな発見かも知れない。

また純粋な興味として、乱雑に見える様々な現象の多くが実は統計学で扱われる
正規分布という分布に従う、というだけでも驚くべき事ではないだろうか。いっ
たいどうしてそのようなことが起こるのだろうか。

本書では統計の原理を数学を用いてとことんまで追求することを目指した。統計
学の素晴らしさ、面白さを少しでも感じて頂ければ幸いである。

\vspace{2em}

\begin{flushright}
2010年3月19日~~~鶴岡タウンキャンパスにて\\
著者
\end{flushright}

\newpage

\tableofcontents

\newpage

\section{確率分布}

\subsection{離散確率分布}
\setcounter{exer}{1}
\setcounter{preexer}{1}
\label{sec_desc_prob}


変数\(X\)が様々な値を取り、またどのような値を取るかが確率的に決まる時、
\(X\)を確率変数\index{かくりつへんすう@確率変数}と呼ぶ。例えばサイコロを振ったときに出た目を\(X\)とすると、\(X\)
は確率的に決まるため、確率変数である。\(X\)がある値\(x\)を取る確率を\(P(X=x)\)
と表す。
例えばXをサイコロを振ったときに出る目とすれば、サイコロの目が2になる確率
は\(P(X=2)=1/6\)と表される。誤解を招く恐れがないときは、\(P(x)\)と省略する。

\begin{figure}
\begin{center}
\includegraphics[scale=0.5]{dice_plot1}
\end{center}
% x <- sapply(0:10, dbinom, size=10, prob=1.0/6)
% names(x) <- 0:10
% barplot(x)
\vspace{-2em}
\caption{サイコロを例にした確率分布の例}
\label{dice_plot1}
\begin{small}
\begin{quotation}
(a) サイコロの各目が出る確率 (b) サイコロを3回振ったときの目の合計とその確率。合計が9以上11以下の確率に
該当する棒の色を濃く示した。
\end{quotation}
\end{small}
\end{figure}

\(X\)が取り得る値\(x_{1},x_{2},x_{3},\cdots\)を横軸に、その値を取る確率\(p_{1},p_{2},p_{3}\cdots\)を
縦軸にしたヒストグラムを描くと、変数\(X\)の特性が分かる。例えば横軸にサイコロの目、縦軸にその目が出る確率をヒストグラムで表すと
図\ref{dice_plot1}(a)のようになるし、またサイコロを3回振ったときの目の合計を横軸、その確率を縦軸にすると、
図\ref{dice_plot1}(b)のようになる。このように変数\(X\)の確率的な分布を表したものを確率分布\index{かくりつぶんぷ@確率分布}と呼ぶ。

図\ref{dice_plot1}の場合、ヒストグラムの各棒の幅を1とすれば、各棒の面積が確率変数が取り得る各値の確率となり、
さらに以下の2つの重要な性質が得られる。

\begin{enumerate}
\label{pd_def1}
\item \label{pd_def1_1} 棒の面積の合計が1となる
\item \label{pd_def1_2} Xが\(a\)以上、\(b\)未満となる確率\(P(a \leq X < b)\)は、以下の式で与えられる。 %\footnote{\(P(X=x_{i})\)を\(P(x_{i})\)と略した。}。
\begin{equation}
P(a \leq X < b)=\sum_{a \leq x_{i} < b}P(X=x_{i})
\end{equation}
\end{enumerate}

\noindent
逆に必要条件として、確率分布は\(P(X=x_{i})\geq 0\)かつ上記2つの性質を満たすもの、と約束する。こうすることによって様々な確率分布に対して
その特性の計算方法を統一できる。サイコロを3回振る例で、目の合計が9以上11以下になる
確率は\(P(9)+P(10)+P(11)\)、すなわち図\ref{dice_plot1}の色の濃い棒の面積の和で表されることが分かる。

上記の例では確率分布をヒストグラムで表したが、確率変数Xが値\(x\)を取る確
率\(P(x)\)を数式で表現できれば最も客観的である。これを
考えると、図\ref{dice_plot1}(a)の
分布は\(P(x)=\frac{1}{6}\)と表されるし、図\ref{dice_plot1}(b)の分布は
\(P(x)=\sum_{i=0}^{\lfloor \frac{1}{6}x-2 \rfloor} 
\frac{3(x-6i-1)(x-6i-2)}{i!(3-i)!}(-1)^{i}\)である\footnote{より一般的に
はサイコロの目の数を\(q\)(一般的なサイコロは\(q=6\))、振る回数を\(n\)と
して、\begin{equation} P(x)=\sum_{i=0}^{\lfloor \frac{x - n}{q} \rfloor} 
\frac{(x-qi-1)!}{(n-1)!(x-qi-n)!}\cdot 
\frac{n!}{i!(n-i)!}(-1)^{i}\nonumber\end{equation}}。但し、\(\lfloor 
\alpha \rfloor\)は\(\alpha\)以下の最大の整数を表す(小数以下を切捨てた整
数)。このように確率変数\(X\)が各値\(x\)を取る確率を関数で表したものを確
率関数と呼ぶ。

確率分布と度数分布の間には密接な関係がある。\(N\)回の試行で\(X=x_{i}\)となる現象が\(n_{i}\)回起こったとする。
このとき、\(N\)が大きくなるにつれて、\(n_{i}/{N}\)は\(P(X=x_{i})\)に近づいてゆく。

\vspace{1em}

\noindent
{\bf 問題\thesection-\theexer}:各年に特定の都市Aで大地震が起きる確率は\(\frac{1}{60}\)であるとする。
今年の始めから数えて\(x\)年の間に1回も地震が起ない確率を\(P(x)\)としたとき、\(P(x)\)の確率関数を求めよ。


\subsection{連続確率分布}
\setcounter{exer}{1}
\setcounter{preexer}{1}
\label{cont_dist1}

\begin{figure}
\begin{center}
\includegraphics[scale=0.8]{roulette2}
\end{center}
\vspace{-1em}
\caption{サイコロルーレット}
\label{roulette2}
\end{figure}

サイコロの例では確率変数\(X\)は離散値、すなわち1,2,3,4,5,6と整数値を取り、2.5など間の数を取ることはなかったし、
1から6という範囲の中で取り得る値は6個と有限であった。確かに現実で起こる確率的と思われる現象の中には、気象を例に取れば
ある地域における年間の台風発生数、落雷数など離散的な数で表されるものもある。しかし、降水量や平均気温など
取り得る値が実数で無限にある確率変数も存在する。これを連続量と呼ぶが、連続量に対しては確率分布や確率関数を
どのように考えればよいだろうか。図\ref{roulette2}の"サイコロルーレット"を例にとって説明しよう。この装置は
円盤と自由に動く針で構成されている。円盤には0から5までの数が刻んである。針を力強く弾くと、針は何回転も
した後、摩擦で停止する。停止したときに針が指し示す実数を\(X\)とすれば、針は0と1の間などどこにでも停止しうるため、
\(X\)は連続値となる。確率変数が離散値を取るときと同じような論法で\(X\)が例えば3を取る確率を論じることはできない。
針が寸分の狂いもなくちょうど3のところで停止することはあり得ないからである(確率は0)。

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{dice_plot_c_flat}
\end{center}
\vspace{-2em}
\caption{連続分布の離散分布への変換}
\label{dice_plot_c_flat}
\begin{small}
\begin{quotation}
サイコロルーレットから得られる値\(X\)を離散確率分布に近似したもの。
\(P(3\leq X < 5)\)となる面積を濃い色で表してある。
(a) 区間の幅を1にした場合。(b) 区間の幅をさらに縮めて0.5にした場合。
\end{quotation}
\end{small}
\end{figure}

そこで連続値を離散値に直すことを考えてみよう。例えば、サイコロルーレット
の針が差す数値が0以上1未満になる確率、1以上2未満になる確率、...というよ
うに連続値を各範囲に小分けにして離散値として扱ってはどうだろうか。すると図\ref{dice_plot_c_flat}(a)に示すように、
\(X\)の取り得る範囲は6つの領域に分かれ、各範囲内に\(X\)が収まる確率は全て\(\frac{1}{6}\)となる。
またこの確率関数は、p.\pageref{pd_def1}で述べた確率分布の2つの性質を満たす。すなわち、

\begin{eqnarray}
P(a \leq X < b)= \sum_{a \leq i < b}P(i \leq X < i + 1)
\end{eqnarray}

\noindent
なので\ref{pd_def1_2}番目の性質は満たされている。但し、\(a,b,i\)は全て整数で、\(0 \leq a < 6, 0 < b \leq 6\)である。また、

\begin{eqnarray}
P(0 \leq X < 6)= \sum_{0 \leq i < 6}P(i \leq X < i + 1)=1
\end{eqnarray}

\noindent
より、\ref{pd_def1_1}の性質も満たす。\(X\)が3以上5未満になる確率は濃い色の棒の面積の
合計で表されることも確認されたい。


区画をさらに細かくして、0以上0.5未満、0.5以上1未満、\(\cdots\)とすれば、図\ref{dice_plot_c_flat}(b)
のような分布が出来上がる。区間が小さくなれば、\(X\)がその区画に入る確率は当然小さくなってゆく。
このとき注意しなければならないのは、区間の幅\(\Delta x=0.5\)となっているため、
\(X=x\)の地点における棒の高さ=その地点の確率としてしまうと、棒の面積は棒の高さ\(\times 0.5\)により、実際の確率の
半分になってしまう。そこで\((X\mbox{が入る区画の確率}/\Delta x)\)という補正をかける必要がある。

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{dice_plot2}
\end{center}
\vspace{-2em}
\caption{サイコロルーレットを3回まわしたときの合計値の離散確率分布による近似}
\label{dice_plot2}
\begin{small}
\begin{quotation}
合計値が9以上12未満になる確率に相当する面積を濃い色で表示した。
(a)区間を1刻みにして近似した分布。(b)区間を0.5刻みにして近似した分布。
\end{quotation}
\end{small}
\end{figure}

これをサイコロルーレットを3回回したときの合計値の分布で考えてみよう。区画幅を1にしたときは
図\ref{dice_plot2}(a)のような分布になり、区間幅を0.5とより細かくしたときは、図\ref{dice_plot2}(b)のようによりスムーズな曲線に近づく。
区間幅\(\Delta x\)を極限まで小さくしていったときに、幅が限りなく0に近い棒の高さが一定値に収束するならば、それこそが
連続確率分布となる。

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{dice_plot_limit2}
\end{center}
\vspace{-2em}
\caption{サイコロルーレットの合計値の連続分布}
\label{dice_plot_limit2}
\begin{small}
\begin{quotation}
(a) サイコロルーレットを1回回したときに出る値の連続確率分布。値が3以上5未満に
なる確率を濃い部分の面積で表した。(b)サイコロルーレットを3回回したときに得られる
値の合計値の連続確率分布。合計値が9以上12未満になる確率を濃い面積で表してある。
\end{quotation}
\end{small}
\end{figure}

例えば図\ref{dice_plot_c_flat}の分布は図\ref{dice_plot_limit2}(a)の分布に収束するし、
図\ref{dice_plot2}の分布は、図\ref{dice_plot_limit2}(b)の分布に収束する
\footnote{
一様分布\(U(0,1)\)から得られる確率変数\(X\)を\(n\)回足した合計値が従う
連続分布は
\(
f(x)=\frac{1}{2(n-1)!}\sum_{k=0}^{n}(-1)^k\frac{n!}{k!(n-k)!}(x-k)^{n-1}{\rm sgn}(x-k)
\)で表される\cite{Hall,Irwin}。
}。

さてこれらの分布を幅が限りなく0に近い棒の集合と考えるならば、離散確率分布のところで述べた\ref{pd_def1_2}番目の性質から、

\begin{equation}
P(a \leq X < b)=\sum_{a \leq x_{i} < b}P(X=x_{i})=\sum_{a \leq x_{i} < b}f(x_{i})\Delta x
\label{chopmany5}
\end{equation}

\noindent
式\ref{chopmany5}は\(\Delta x \to 0\)のとき、積分の定義から、

\begin{equation}
P(a \leq X < b)=\int_{a}^{b}f(x)dx
\label{chopmany6}
\end{equation}

\noindent
となる。つまり、確率変数がある範囲の値を取る確率は、確率密度関数の該当面
積、すなわち積分で表されるということである。節\ref{sec_desc_prob}で述べた離散確率分布の
2つの重要な性質を連続確率分布に当てはめると、確率密度関数を\(f(x)\)として、以下のようになる。

\begin{enumerate}
\item \label{pd_def2_1} 確率変数が取りうる全範囲の確率の合計は1となる。すなわち、
\begin{equation}
\int^{+\infty}_{-\infty}f(x)dx=1
\end{equation}
\item \label{pd_def2_2} Xが\(a\)以上、\(b\)未満となる確率\(P(a \leq X < b)\)は、以下の式で与えられる。 
\begin{equation}
P(a \leq X < b)=\int_{a}^{b}f(x)dx
\end{equation}
\end{enumerate}

\vspace{1em}

\noindent
{\bf 問題\thesection-\theexer}:~確率変数\(X\)の従う確率密度関数\(f(x)\)が

\begin{equation}
f(x)=
\left\{
\begin{array}{l}
x \ \ \ \ \ \mbox{for} \ \ 0 \leq x \leq \sqrt{2}\\
0 \ \ \ \ \ \mbox{otherwise}
\end{array}\right.
\end{equation}

\noindent
で与えられるとき、\(X\)が0以上1以下になる確率を求めよ。


\section{平均と分散}
\setcounter{exer}{1}
\setcounter{preexer}{1}

\(n\)個の値の羅列\(x_{1},x_{2},\cdots,x_{n}\)の平均\(\mu\)は、

\begin{equation}
\mu=\frac{1}{n}(x_{1}+x_{2}+\cdots+x_{n})=\frac{1}{n}\sum_{i=1}^{n}x_{i}
\end{equation}

\noindent
であり、また分散\(\sigma^{2}\)は、

\begin{equation}
\sigma^{2}=\frac{1}{n}\sum_{i=1}^{n}(x_{i}-\mu)^{2}
\end{equation}

\noindent
と定義される。次に値が重複している場合を考慮に入れ、
\(x_{1},x_{2},\cdots,x_{i}\)の値を持つ対象が\(それぞれN_{1},N_{2},\cdots,N_{n}\)個観測されたとする。但し、
\(\sum_{i=1}^{n}N_{i}=N\)とする。これらの対象が持つ値の平均\(\mu\)は、\(P_{i}=\frac{N_{i}}{N}\)として、

\begin{equation}
\mu=\frac{1}{N}\sum_{i=1}^{n}x_{i}N_{i}=\sum_{i=1}^{n}x_{i}\frac{N_{i}}{N}=\sum_{i=1}^{n}x_{i}P_{i}
\label{avn}
\end{equation}

\noindent
である。但し、\(\sum_{i=1}^{n}P_{i}=1\)である。一方分散は、

\begin{equation}
\sigma^{2}=\frac{1}{N}\sum_{i=1}^{n}(x_{i}-\mu)^{2}N_{i}=\sum_{i=1}^{n}(x_{i}-\mu)^{2}\frac{N_{i}}{N}=\sum_{i=1}^{n}(x_{i}-\mu)^{2}P_{i}
\end{equation}

\noindent
となる。

これら平均、分散の定義を確率関数にまで拡張することを考えよう。
Xが取り得る値\(x_{1},x_{2},x_{3},\cdots\)とその確率
\(P(X=x_{1}),P(X=x_{2}),P(X=x_{3}),\cdots\)の積の総和をXの期待値\index{きたいち@期待値}と呼び、\(E(X)\)で表す。

\begin{equation}
E(X)=\sum_{i} x_{i}P(X=x_{i})
\end{equation}

\noindent
これは式\ref{avn}の\(P_{i}\)を\(P(X=x_{i})\)に置き換えたものである。
例えば先に出たサイコロの例では、期待値は3.5となる。以上は\(X\)が離散値の場合だが、連続値の場合は、
\(X\)の取りうる範囲を\(\Delta x\)の大きさに分割すると、

\begin{equation}
E(X)=\sum_{i} x_{i}f(x_{i})\Delta x
\label{eq250}
\end{equation}

\noindent
となる。\(\Delta x \to 0\)を取れば式\ref{eq250}は、

\begin{equation}
E(X)=\int_{-\infty}^{+\infty}xf(x)dx
\end{equation}

\noindent
に収束する。\(E(X)\)を\(X\)の平均とも呼ぶ。特に\(X\)が密度関数\(f(x)\)に従うとき、\(E(X)\)を
\(f(x)\)の平均という。

分散\(\sigma^{2}\)は\(E((X-E(X))^{2})\)で定義され、離散確率の場合は平均を\(E(X)=\mu\)としたとき、、

\begin{equation}
\sigma^{2}=E((X-E(X))^{2})=\sum_{i} (x_{i}-\mu)^{2}P(X=x_{i})
\end{equation}

\noindent
で表される。

\vspace{1em}

\noindent
{\bf 問題\thesection-\theexer}:~連続確率について、分散を表す式を導け。

\stepcounter{exer}

\noindent
{\bf 問題\thesection-\theexer}:~確率変数\(X_{1},X_{2},\cdots,X_{n}\)について、以下の数式が成立することを示せ。

\begin{equation}
E(X_{1}+X_{2}+\cdots+X_{n})=E(X_{1})+E(X_{2})+\cdots+E(X_{n})
\label{eqn_E_sum1}
\end{equation}

\stepcounter{exer}

\noindent
{\bf 問題\thesection-\theexer}:~以下の数式が成立することを示せ。

\begin{equation}
\sigma^{2}=E((X-E(X))^{2})=E(X^{2})-\left\{E(X)\right\}^{2}=E(X^{2})-\mu^{2}
\label{eqn305}
\end{equation}



\section{標本分布}
\setcounter{exer}{0}
\setcounter{preexer}{1}
\label{sample_distr1}

ある確率変数\(X\)の性質を調べたいときに、\(X\)がどのような値を取るかを次々に見ていく方法がある。
例えば\(X\)を日本人20歳男子の身長だとしよう。確実に分布を得るためには、日本人20歳男子全ての身長を
測る方法があるだろう。しかしながらこれは時間・費用・労力の面から効率の良い方法とは言えないし、
多くの場合現実的ではないだろう。そこで多くの場合、無作為に標本を取り、その標本の性質から全体の性質を
推測することが行われる。標本のことから母数のことがどれほどのことがどれほどの精度で分かるだろうか?

\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{height_sample1}
\end{center}
\vspace{-2em}
\caption{身長の平均の例}
\label{height_sample1}
\end{figure}

まずは母数の身長の平均値\(\mu\)とその標本\(i\)の標本中の平均\(\bar{x_{i}}\)との関係を調べよう。例えば
\(n\)人分の標本を採れば、その標本に対して標本平均\(\bar{x}\)と標本分散\(s^{2}\)を計算できる。
この\(\bar{x}\)や\(s^{2}\)はどのような性質を持っているだろうか。
まずは\(\bar{x}\)の方から見てみよう。\(\bar{x}\)の性質を調べるためには、\(\bar{x}\)自体の分布、すなわち
図\ref{height_sample1}に示すように、\(n\)人の標本(この例では\(n=7\))を採るという操作を繰り返し行ったとき、\(\bar{x}\)がどのような分布に従うかを調べるのがよい。
ある標本について\(n\)人分の身長を\(X_{1},X_{2},\cdots,X_{n}\)(但し\(X_{i}\)は確率変数とみなす)とすれば、その標本平均\(\bar{X}\)は、

\begin{equation}
\bar{X}=\frac{X_{1}+X_{2}+\cdots+X_{n}}{n}
\end{equation}

\noindent
である。ここで\(\bar{X}\)もまた確率変数である。標本平均\(\bar{X}\)の平均\(E(\bar{X})\)は\(E(X_{i})=\mu\)の関係に注意しつつ、式\ref{eqn_E_sum1}の関係を使うと、

\begin{eqnarray}
E(\bar{X})=E\left(\frac{X_{1}+X_{2}+\cdots+X_{n}}{n}\right)=\frac{1}{n}\left(E(X_{1})+E(X_{2})+\cdots+E(X_{n})\right)=\frac{1}{n}(n\mu)=\mu
% \nonumber\\
\end{eqnarray}

\noindent
となり、標本平均\(\bar{X}\)の分布の平均\(E(\bar{X})\)は母集団の分布の平均\(E(X)\)に一致することが示された。

標本平均の分散\(\sigma^{2}_{\bar{x}}\)は、

\begin{eqnarray}
\sigma^{2}_{\bar{x}}=E((\bar{X}-\mu)^{2})=E\left\{\left(\frac{1}{n}(X_{1}+X_{2}+\cdots+X_{n})-\mu\right)^{2}\right\}\nonumber\\
=\frac{1}{n^{2}}E\left\{\left((X_{1}-\mu)+(X_{2}-\mu)+\cdots+(X_{n}-\mu)\right)^{2}\right\}\nonumber\\
=\frac{1}{n^{2}}\left\{\sum_{i}E\{(X_{i}-\mu)^{2}\}\right\}+\frac{1}{n^{2}}\left\{\sum_{i\not=j}E\{(X_{i}-\mu)(X_{j}-\mu)\}\right\}
\label{eqn328}
\end{eqnarray}

\noindent
式\ref{eqn328}の第2項は、

\begin{eqnarray}
E\{(X_{i}-\mu)(X_{j}-\mu)\}=\sum_{x_{i}}\sum_{x_{j}}(x_{i}-\mu)(x_{j}-\mu)P(X=x_{i})P(X=x_{j})\nonumber\\
=\sum_{x_{i}}(x_{i}-\mu)P(X=x_{i})\sum_{x_{j}}(x_{j}-\mu)P(X=x_{j})=E(X-\mu)\cdot E(X-\mu)=0
\end{eqnarray}

\noindent
また\(E{(x_{i}-\mu)^{2}}=\sigma^{2}\)より、式\ref{eqn328}は

\begin{equation}
\sigma^{2}_{\bar{x}}=E((\bar{X}-\mu)^{2})=\frac{\sigma^{2}}{n}
\label{eqn329}
\end{equation}

\noindent
となる。

\vspace{1em}

\refstepcounter{exer}
\label{exerx2}
\noindent
{\bf 問題\thesection-\theexer}:~式\ref{eqn329}の導出過程を参考に、\(E(\bar{X}^{2})\)を\(n,\mu,\sigma\)を用いて表せ。

\refstepcounter{exer}
\label{exerx3}
\noindent
{\bf 問題\thesection-\theexer}:~問題\ref{sample_distr1}-\ref{exerx2}の結果および式\ref{eqn305}を活用して、\(\frac{1}{n}\sum_{i=1}^{n}(x_{i}-\bar{x})^{2}\)の
平均\(E\{\frac{1}{n}\sum_{i=1}^{n}(X_{i}-\bar{X})^{2}\}\)を\(n,\mu,\sigma\)を用いて表せ。

\refstepcounter{exer}
\noindent
{\bf 問題\thesection-\theexer}:~問題\ref{sample_distr1}-\ref{exerx2}の結
果および式\ref{eqn305}を活用して、標本分散\(s^{2}\)の平均
\(E(s^{2})=E\{\frac{1}{n-1}\sum_{i=1}^{n}(X_{i}-\bar{X})^{2}\}\)を
\(n,\mu,\sigma\)を用いて表せ。

% \begin{equation}

% \end{equation}



\section{正規分布}
\setcounter{exer}{0}
\setcounter{preexer}{1}
\label{gaus_distr1}

\(N(\mu,\sigma^{2})\)に従う正規分布\(f(x)\)は

\begin{equation}
f(x)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^{2}}{2\sigma^{2}}}
\label{gaussian}
\end{equation}

\noindent
で表される。

数式の中に何故円周率の\(\pi\)が出てくるのか、不思議に思う読者のために、直感的な
説明を以下に与えよう。式\ref{gaussian}を簡略化した

\begin{equation}
f(x)=e^{-x^{2}}
\end{equation}

\noindent
で与えられる関数を考え、その積分

\begin{equation}
I=\int^{+\infty}_{0}f(x)dx=\int^{+\infty}_{0}e^{-x^{2}}dx
\label{integ10}
\end{equation}

\noindent
を定義し、また\(y=xu\)を考える。
式\ref{integ10}の\(x\)を\(y\)に変えても式全体の値は変わらないからこれを自乗して
\footnote{\(y=xu\)の制約の中でも、\(u\)の値を調整すれば、\(x,y\)は正のあらゆる組み合わせの値を取り得ることに注意。
式の中に3つの変数全て(\(x,y,u \))が登場すると、これらの3つの変数の取り得る値の組み合わせは限定される。}、

\begin{equation}
I^{2}=\left(\int^{+\infty}_{0}e^{-x^{2}}dx\right)^{2}
=\left(\int^{+\infty}_{0}e^{-x^{2}}dx\right)\left(\int^{+\infty}_{0}e^{-y^{2}}dy\right)=\int^{+\infty}_{0}\int^{+\infty}_{0}e^{-(x^{2}+y^{2})}dydx
\label{integ11}
\end{equation}

\noindent
ここで\(\frac{dy}{du}=x\)すなわち\(dy=xdu\)より、

\begin{eqnarray}
I^{2}=\int^{+\infty}_{0}\int^{+\infty}_{0}e^{-(x^{2}+y^{2})}dydx=\int^{+\infty}_{0}\left(\int^{+\infty}_{0}e^{-(1+u^{2})x^{2}}xdu\right)dx\nonumber\\
=\int^{+\infty}_{0}\int^{+\infty}_{0}e^{-(1+u^{2})x^{2}}xdxdu=\int^{+\infty}_{0}\left[-\frac{1}{2(1+u^{2})}\cdot e^{-(1+u^{2})x^{2}}\right]^{+\infty}_{0}du\nonumber\\
=\int^{+\infty}_{0}\frac{du}{2(1+u^{2})}=\frac{\pi}{4} % =\frac{1}{2}\left[{\rm tan}^{-1} u\right]^{+\infty}_{0}
\label{eqn367}
\end{eqnarray}

\vspace{1em}

\refstepcounter{exer}
\label{exer56}
\noindent
{\bf 問題\thesection-\theexer}:~
三角関数の関係式\(\frac{\sin\theta}{\cos\theta}=\tan\theta,\ 
\sin^{2}+\cos^{2}=1,\frac{d\tan\theta}{d\theta}=\frac{1}{\cos^{2}\theta}\)を駆使して、式\ref{eqn367}の最後の部分
\(\int^{+\infty}_{0}\frac{du}{2(1+u^{2})}=\frac{\pi}{4}\)が成立すること
を示せ。



\section{多変量の確率関数}
\setcounter{exer}{1}
\setcounter{preexer}{1}

確率関数は多変量に対しても拡張できる。まずは2変量で考えてみよう。確率密度関数を\(f(x,y)\)とすれば、節\ref{cont_dist1}で述べた確率密度関数の
性質を以下のように拡張できる。

\begin{enumerate}
\item 確率変数が取りうる全範囲の確率の合計は1となる。すなわち、
\begin{equation}
\int^{+\infty}_{-\infty}\int^{+\infty}_{-\infty}f(x,y)dxdy=1
\end{equation}
\item \(X,Y\)が範囲\(D\)の値に収まる確率は以下の式で与えられる。
\begin{equation}
P((X,Y) \in D)=\int\int_{D}f(x,y)dxdy
\label{d3_1}
\end{equation}
\end{enumerate}


\begin{figure}
\begin{center}
\includegraphics[scale=0.6]{prob3D1}
\end{center}
\vspace{-2em}
\caption{3次元空間上の連続分布}
\label{prob3D1}
\end{figure}

図形的に表せば図\ref{prob3D1}のように、\(X,Y\)が領域\(D\)に入る確率は領域\(D\)と\(f(x,y)\)の部分で囲まれた空間の体積で表される。
すなわち、

\begin{equation}
P((x_{i} \leq X < x_{i}+\Delta x) \land (y_{j} \leq Y < y_{j}+\Delta y))\approx f(x_{i},y_{j})\Delta x \Delta y
\label{eqn297}
\end{equation}

\noindent
領域\(D\)に\(\Delta x, \Delta y\)の長方形を敷き詰め、\(i\)番目の長方形の隅の座標を\(x_{i},y_{j} \in D\)として
合計すると、\(\sum_{(x_{i},y_{j}) \in D}f(x_{i},y_{j})\Delta x \Delta y\)であり、\(\Delta x, \Delta y \to 0\)のとき、式\ref{d3_1}に収束する。

確率密度関数\(X \sim f(x),Y \sim g(y)\)について、

\begin{eqnarray}
P(x\leq X \leq x + \Delta x) \approx f(x)\Delta x\nonumber\\
P(y\leq Y \leq y + \Delta y) \approx g(y)\Delta y
\end{eqnarray}

\noindent
が成立するが、\(X\)と\(Y\)が独立な場合、

\begin{equation}
P((x\leq X \leq x + \Delta x) \land (y\leq Y \leq y + \Delta y))=f(x)\Delta x \cdot g(y)\Delta y=f(x)g(y)\Delta x \Delta y
\end{equation}

\noindent
となり、式\ref{eqn297}で\(f(x,y)=f(x)g(y)\)としたものに一致する。すなわち、\(f(x)g(y)\)は\(X,Y\)が従う結合密度関数である。

確率変数\(X\)と\(Y\)の和\(X+Y\)が従う分布\(h(z)\)は以下のように求めるこ
とができる。まず\(X \sim f(x), Y \sim g(y)\)とすると、その結合密度関数は、
\(f(x)g(y)\)である。\(a \leq X + Y \leq z\)となる確率は、

\begin{equation}
H(z)=\int_{-\infty}^{z}h(w)dw
\end{equation}

\noindent
とおくと、

\begin{equation}
P(a \leq X + Y \leq z)=H(z)-H(a)
\end{equation}

\noindent
と表すことができる。次に\(a \leq X + Y \leq z\)を満たす\(X\)と\(Y\)の範囲を考えよう。
\(Y\)が\(-\infty\)から\(+\infty\)まで自由に値を変えるとすると、\(X\)は\(a-Y \leq X \leq Z - Y\)という制約を受ける。
この制約の中で\(f(x)g(y)\)を積分すれば、\(P(a \leq X + Y \leq z)\)が求まる。すなわち\(F(z)=\int_{-\infty}^{z}f(x)dx\)とおけば、

\begin{eqnarray}
P(a \leq X + Y \leq z)=H(z)-H(a)=\int_{y=-\infty}^{y=+\infty}\left\{\int_{x=a-y}^{x=z-y}f(x)dx\right\}g(y)dy\nonumber\\
=\int_{y=-\infty}^{y=+\infty}\left\{F(z-y)-F(a-y)\right\}g(y)dy\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \nonumber\\
=\int_{y=-\infty}^{y=+\infty}F(z-y)g(y)dy-\int_{y=-\infty}^{y=+\infty}F(a-y)g(y)dy 
\end{eqnarray}

\noindent
\(z\)を含む項、\(a\)を含む項だけを抜き出すと、

\begin{equation}
H(z)=\int_{y=-\infty}^{y=+\infty}F(z-y)g(y)dy, \ \ \ H(a)=\int_{y=-\infty}^{y=+\infty}F(a-y)g(y)dy
\end{equation}

\noindent
左の式について\(z\)で微分すると、

\begin{equation}
h(z)=\int_{-\infty}^{+\infty}f(z-y)g(y)dy
\label{eqn_convol1}
\end{equation}

\noindent
が求まる。式\ref{eqn_convol1}を\(f\)と\(g\)の{\bf 畳み込み積分(convolution)}\index{たたみこみせきぶん@畳み込み積分}という。

畳み込み積分を用いて\(N(\mu, \sigma^{2})\)に従う2つの確率変数\(X,Y\)の和\(X+Y\)が従う分布を求めよう。\(N(\mu, \sigma^{2})\)の
確率密度関数を\(f(x)\)として、\(X+Y\)の従う結合密度関数は、

\begin{eqnarray}
h(z)=\int_{-\infty}^{+\infty}f(z-y)f(y)dy=\int_{-\infty}^{+\infty}\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(z-y-\mu)^{2}}{2\sigma^{2}}}
                                                                  \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(y-\mu)^{2}}{2\sigma^{2}}}dy
\mbox{\hspace{12em}}\nonumber\\
=
\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{\frac{1}{2}(z-2\mu)^{2}}{2\sigma^{2}}}
\cdot\int_{-\infty}^{+\infty}\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{2(y-\frac{1}{2}z)^{2}}{2\sigma^{2}}}dy=
\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(z-2\mu)^{2}}{4\sigma^{2}}}
\cdot\frac{1}{\sqrt{2}}\int_{-\infty}^{+\infty}\frac{1}{\sqrt{2\pi}\frac{1}{\sqrt{2}}\sigma}e^{-\frac{(y-\frac{1}{2}z)^{2}}{2(\frac{1}{\sqrt{2}}\sigma)^{2}}}dy\nonumber\\
=\frac{1}{\sqrt{2\pi}\sqrt{2}\sigma}e^{-\frac{(z-2\mu)^{2}}{2(\sqrt{2}\sigma)^{2}}}
\cdot\int_{-\infty}^{+\infty}\frac{1}{\sqrt{2\pi}\frac{1}{\sqrt{2}}\sigma}e^{-\frac{(y-\frac{1}{2}z)^{2}}{2(\frac{1}{\sqrt{2}}\sigma)^{2}}}dy
\mbox{\hspace{20em}}\nonumber\\
\nonumber\\
=N(2\mu,2\sigma^{2})\mbox{の確率密度関数}\cdot N(\frac{1}{2}z,\frac{1}{2}\sigma^{2})\mbox{の全域に関する積分}
=N(2\mu,2\sigma^{2})\mbox{の確率密度関数}\cdot 1\nonumber\\
=N(2\mu,2\sigma^{2})\mbox{の確率密度関数}
\end{eqnarray}

\noindent
となり、\(X+Y\)は\(N(2\mu,2\sigma^{2})\)に従うことが示された。

\vspace{1em}

\noindent
{\bf 問題\thesection-\theexer}:~畳み込み積分を用いて、サイコロルーレットを2回回したときに得られる数値の合計値が従う確率密度関数を求めよ。



\section{テイラー展開}

\(f(x),f'(x),\cdots,f^{(n-1)}(x)\)は\([a,b]\)で連続で\((a,b)\)で\(f^{(n)}(x)\)が存在すれば、

\begin{eqnarray}
f(b)=f(a)+\frac{f'(a)}{1!}(b-a)+\frac{f''(a)}{2!}(b-a)^{2}+\nonumber\\
\cdots +\frac{f^{(n-1)}(a)}{(n-1)!}(b-a)^{n-1}+\frac{f^{(n)}(c)}{n!}(b-a)^{n}\nonumber\\
(a<c<b)
\end{eqnarray}

\noindent
となるような\(c\)が存在する。

\vspace{1em}

\noindent
{\bf 証明：}

\begin{eqnarray}
f(b)=f(a)+\frac{f'(a)}{1!}(b-a)+\frac{f''(a)}{2!}(b-a)^{2}+\nonumber\\
\cdots +\frac{f^{(n-1)}(a)}{(n-1)!}(b-a)^{n-1}+\frac{k}{n!}(b-a)^{n}
\label{taylor_p1}
\end{eqnarray}

\noindent
とおく。\(k\)以外の変数が固定されていても、\(k\)の値を調整すれば、式\ref{taylor_p1}を
成立させることができる。右辺の\(a\)を\(x\)に置き換え、\(f(b)\)から引くと、

\begin{eqnarray}
F(x)=f(b)-f(x)-\frac{f'(x)}{1!}(b-x)-\frac{f''(x)}{2!}(b-x)^{2}-\nonumber\\
\cdots -\frac{f^{(n-1)}(x)}{(n-1)!}(b-x)^{n-1}+\frac{k}{n!}(b-x)^{n}
\end{eqnarray}

\noindent
\(F(a)=0, F(b)=0\)であり、Rolleの定理から\(F'(c), a<c<b\)となる\(c\)が存在する。

\begin{equation}
F'(c)=-\frac{f^{(n)}(c)}{(n-1)!}(b-c)^{n-1}+\frac{k}{(n-1)!}(b-x)^{n-1}=0
\end{equation}

\noindent
より\(k=f^{(n)}(c)\)を得る。

\vspace{-1em}

\begin{flushright}
□
\end{flushright}

\section{積率母関数}

\subsection{積率母関数の定義}
\setcounter{preexer}{1}

\(x\)を確率変数とし、\(t\)を実数とするとき、\(e^{tx}\)の期待値を\(x\)の
積率母関数(moment generating function)といい、\(M_{x}(t)\)で表す。すなわち\(x\)が
離散型であれば、\(f(x)\)を確率関数として、

\begin{equation}
M_{x}(t)=E(e^{tx})=\sum_{x}e^{tx}f(x)
\end{equation}

\noindent
となる。但し、\(\sigma_{x}\)は\(x\)の可能な値全てについての合計を表す。また\(x\)が
連続型で\(-\infty<x<\infty\)とすれば、\(f(x)\)を密度関数として、

\begin{equation}
M_{x}(t)=E(e^{tx})=\int^{\infty}_{-\infty}e^{tx}f(x)dx
\label{eq2}
\end{equation}

\noindent
である。

\(e^{tx}\)をマクローリン展開すれば、

\begin{equation}
e^{tx}=1+\frac{tx}{1!}+\frac{(tx)^{2}}{2!}+\cdots
\end{equation}

\noindent
であるから、これを式\ref{eq2}に代入して、

\begin{eqnarray}
E(e^{tx})=\int^{\infty}_{-\infty}f(x)dx+\int^{\infty}_{-\infty}txf(x)dx+\frac{1}{2}\int^{\infty}_{-\infty}(tx)^{2}f(x)dx+\cdots \nonumber\\
=1+tE(x)+\frac{t^{2}}{2}E(x^{2})+\cdots=\sum_{k=0}^{\infty}\frac{t^{k}}{k!}E(x^{k})\mbox{\hspace{10em}}
\label{eq4}
\end{eqnarray}

\noindent
となる。すなわち各項は原点回りの\(k\)次の積率\(E(x^{k})\)を含んでいる。

式\ref{eq4}に関する\(k\)階の導関数で\(t=0\)とおくとその値は\(E(x^{k})\)すなわち原点回りの\(k\)の
積率に等しくなる。すなわち、

\begin{equation}
\frac{\partial^{k}M_{x}(t)}{\partial t^{k}}\biggl|_{t=0}=E(x^{k})\;\;\;\;\;k=1,2,\cdots
\end{equation}

\noindent
これが\(M_{x}(t)\)が積率母関数と呼ばれる所以である。以下、
\(\partial^{k}M_{x}(t)/\partial t^{k}|_{t=0}\)を単に\(M_{x}^{(k)}(0)\)と表すことにする。
例えば\(k=1\)であれば、

\[
M_{x}'(0)=E(x) 
\]

\noindent
で平均が得られる。また\(k=2\)ならば、

\[M_{x}''(0)=E(x^{2})\]

\noindent
すなわち、原点周りの2次の積率が得られるから、

\[E(x^{2})-{E(x)}^{2}=\sigma^{2}\]

\noindent
によって分散が得られる。

\vspace{2em}

\noindent
{\bf 例題\thesection-\thepreexer}:
正規分布\(N(\mu, \sigma^{2})\)の積率母関数を求めてみよう。

\begin{eqnarray}
M_{x}(t)=\int^{\infty}_{\infty}e^{tx}\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2\sigma^{2}}(x-\mu)^{2}}dx \mbox{\hspace{10em}} \nonumber\\
=\int^{\infty}_{\infty}{\rm exp}\left[-\frac{1}{2\sigma^{2}}\{(x-\mu)^{2}-2\sigma^{2}tx\}\right]dx \mbox{\hspace{6em}}\nonumber
\end{eqnarray}

ところで\{\(\cdots\)\}の中は\((x-\mu)^{2}-2\sigma^{2}tx=x^{2}-2\mu x + \mu^{2}-2\sigma^{2}tx=x^{2}-2(\mu-\sigma^{2}t)x+\mu^{2}
=\{x-(\mu+\sigma^{2}t)\}^{2}-2\sigma^{2}\mu t - \sigma^{4}t^{2}\)
であるから、

\begin{eqnarray}
M_{x}(t)=\frac{1}{\sqrt{2\pi}\sigma}\int^{\infty}_{-\infty}{\rm exp}\left[-\frac{1}{2\sigma^{2}}\left\{x-(\mu+\sigma^{2}t)\right\}^{2}+\mu t+\frac{\sigma^{2}}{2}t^{2}\right]dx \nonumber \\
={\rm exp}\left(\mu t+\frac{\sigma^{2}}{2}t^{2}\right)\cdot \frac{1}{\sqrt{2\pi}\sigma}\int^{\infty}_{-\infty}{\rm exp}\left[-\frac{1}{2\sigma^{2}}\left\{x-(\mu+\sigma^{2}t)\right\}^{2}\right]dx \nonumber
\end{eqnarray}

\noindent
ここで、\(\frac{1}{\sqrt{2\pi}\sigma}\int^{\infty}_{-\infty}{\rm exp}\left[-\frac{1}{2\sigma^{2}}\left\{x-(\mu+\sigma^{2}t)\right\}^{2}\right]dx\)は平均\(\mu+\sigma^{2}t\)、
分散\(\sigma^{2}\)の正規分布密度関数の積分に他ならないから、1に等しい。それゆえ、

\begin{equation}
M_{x}(t)={\rm exp}\left(\mu t+\frac{\sigma^{2}}{2}t^{2}\right)
\end{equation}

\noindent
である。

\(M_{x}'(t)=(\mu+\sigma^{2}t){\rm exp}(\mu t + \frac{\sigma^{2}}{2}t^{2})\)
であるから、

\begin{equation}
M_{x}'(0)=\mu
\end{equation}

\noindent
となり、また
\(M_{x}''(t)=\sigma^{2}{\rm exp}(\mu t+\frac{\sigma^2}{2}t^{2})+(\mu+\sigma^{2}t)^{2}{\rm exp}(\mu t + \frac{\sigma^{2}}{2}t^{2})\)
から、\(M''(0)=\sigma^{2}+\mu^{2}\)、すなわち、

\begin{equation}
M''(0)-{M'(0)}^{2}=\sigma^{2}
\end{equation}

\noindent
となり、正規分布の平均は\(\mu\)、分散は\(\sigma^{2}\)であることが示された。

\subsection{確率変数の関数の積率母関数}

\(x\)を確率変数、\(t\)を実数とするとき、\(e^{tx}\)の期待値を\(x\)の積率
母関数ということは既に述べた。ここで、\(\varphi(x)\)を\(x\)の連続な関数としたとき、
\(\varphi(x)\)の積率母関数は\(e^{t\varphi(x)}\)の期待値と定義され、\(M_{\varphi(x)}(t)\)で表される。

\(x\)が連続型で\(-\infty<x<\infty\)とすれば、\(f(x)\)を密度関数として、

\begin{equation}
M_{\varphi(x)}(t)=E(e^{t\varphi(x)})=\int^{\infty}_{-\infty}e^{t\varphi(x)}f(x)dx
\label{eq11}
\end{equation}

\noindent
である。

\(e^{t\varphi(x)}\)をマクローリン展開すれば、

\begin{equation}
e^{t\varphi(x)}=1+\frac{t\varphi(x)}{1!}+\frac{(t\varphi(x))^{2}}{2!}+\cdots
\end{equation}

\noindent
であるから、これを式\ref{eq11}に代入して、

\begin{eqnarray}
E(e^{t\varphi(x)})=\int^{\infty}_{-\infty}f(x)dx+\int^{\infty}_{-\infty}t\varphi(x)f(x)dx+\frac{1}{2}\int^{\infty}_{-\infty}\{t\varphi(x)\}^{2}f(x)dx+\cdots \nonumber\\
=1+tE[\varphi(x)]+\frac{t^{2}}{2}E[\{\varphi(x)\}^{2}]+\cdots
%\label{eq4}
\end{eqnarray}

\noindent
であるから、

\begin{equation}
M^{k}(0)=E[\{\varphi(x)\}^{k}] \ \ \ \ \ k=1,2,\cdots
\end{equation}

\noindent
により、\(\varphi(x)\)の原点回りの\(k\)次の積率が計算できる。


\section{中心極限定理}
\label{clt}

\setcounter{exer}{0}
\setcounter{preexer}{1}


\(x_{1},\cdots,x_{n}\)を密度関数\(f(x)\)からの大きさ\(n\)の無作為標本とし、\(x\)の平均を\(\mu\)、分散を\(\sigma^{2}\)とする。またのこの標本の
標本平均を\(\bar{x}\)、標本平均を標準化した変数を\(z_{*}\)とする。すなわち、

\begin{equation}
z_{*}=\frac{\bar{x}-\mu}{\sigma/\sqrt{n}}=z\sqrt{n}
\end{equation}

\noindent
このとき、\(z_{*}\)の積率母関数は、

% \begin{eqnarray}
% M_{y_{n}}(t)=M_{\frac{\bar{x}-\mu}{\sigma/\sqrt{n}}}(t)
% =\int^{\infty}_{-\infty}{\rm exp}\left(\frac{\bar{x}-\mu}{\sigma/\sqrt{n}}t\right)f(\bar{x})d\bar{x}\mbox{\hspace{7em}}\nonumber\\
% =\int^{\infty}_{-\infty}\cdots\int^{\infty}_{-\infty}{\rm exp}\left(t\sum_{i=1}^{n}\frac{x_{i}-\mu}{\sigma/\sqrt{n}}\right)f(x_{1})\cdots f(x_{n})dx_{1}\cdots dx_{n}\nonumber\\
% =\left\{\int^{\infty}_{-\infty}{\rm exp}\left(\frac{x-\mu}{\sigma/\sqrt{n}}t\right)f(x)dx\right\}^{n}
% =\left\{M_{\frac{x-\mu}{\sigma}}\left(\frac{t}{\sqrt{n}}\right)\right\}^{n}
% \end{eqnarray}

% \lefteqn{M_{z}(t)=\int^{\infty}_{-\infty}\cdots\int^{\infty}_{-\infty}e^{tz}f(x_{1})\cdots f(x_{n})dx_{1}\cdots dx_{n}}

\vspace{2em}

\lefteqn{
\mbox{\hspace{1em}} M_{z}(t)=\int^{\infty}_{-\infty}\cdots\int^{\infty}_{-\infty}e^{tz_{*}}f(x_{1})\cdots f(x_{n})dx_{1}\cdots dx_{n}
}\lefteqn{
\mbox{\hspace{3em}} =\int^{\infty}_{-\infty}\cdots\int^{\infty}_{-\infty}{\rm exp}\left(\frac{\bar{x}-\mu}{\sigma/\sqrt{n}}t\right)f(x_{1})\cdots f(x_{n})dx_{1}\cdots dx_{n}
}\lefteqn{
\mbox{\hspace{3em}} =\int^{\infty}_{-\infty}\cdots\int^{\infty}_{-\infty}{\rm exp}\left(t\sum_{i=1}^{n}\frac{x_{i}-\mu}{\sigma/\sqrt{n}}\right)f(x_{1})\cdots f(x_{n})dx_{1}\cdots dx_{n}
}\lefteqn{
\mbox{\hspace{3em}} =\left\{\int^{\infty}_{-\infty}{\rm exp}\left(\frac{x-\mu}{\sigma/\sqrt{n}}t\right)f(x)dx\right\}^{n}=\left\{M_{z}\left(\frac{t}{\sqrt{n}}\right)\right\}^{n}
                    =\left\{\int^{\infty}_{\infty}{\rm exp}\left(\frac{t}{\sqrt{n}}z\right)f(z)dz \right\}^{n}
}

\vspace{2em}

\noindent
ここで、

\begin{equation}
{\rm exp}\left(\frac{t}{\sqrt{n}}z\right)=1+\frac{tz}{\sqrt{n}}+\frac{1}{2}\left(\frac{tz}{\sqrt{n}}\right)^{2}+\frac{1}{6}\left(\frac{tz}{\sqrt{n}}\right)^{3}+\cdots
\end{equation}

\noindent
となるから、

\begin{eqnarray}
\left\{M_{z}\left(\frac{t}{\sqrt{n}}\right)\right\}^{n}=\left[\int^{\infty}_{-\infty}\left\{1+\frac{tz}{\sqrt{n}}+\frac{1}{2}\left(\frac{tz}{\sqrt{n}}\right)^{2}+\frac{1}{6}\left(\frac{tz}{\sqrt{n}}\right)^{3}+\cdots \right\}f(z)dz \right]^{n}\nonumber\\
=\left[\int^{\infty}_{-\infty}f(z)dz+\int^{\infty}_{\infty}\frac{t}{\sqrt{n}}zf(z)dz+\int^{\infty}_{-\infty}\frac{t^{2}}{2n}z^{2}f(z)dz+\int^{\infty}_{-\infty}\frac{t^{3}}{6n^{3/2}}z^{3}f(z)dz+\cdots \right]^{n}
\label{eqn25}
\end{eqnarray}

\noindent
となる。ここで、\(\int^{\infty}_{-\infty}f(z)dz=1\)(確率密度関数の定義、全確率の合計は1)、\(\int^{\infty}_{-\infty}zf(z)dz=0\)(\(z\)の平均は0)、
\(\int^{\infty}_{-\infty}z^{2}f(z)dz=1\)(\(z\)の分散)より、式\ref{eqn25}は、

\begin{equation}
M_{z*}(t)=\left[1+0+\frac{t^{2}}{2n}+(n^{-3/2}\mbox{の項})+(n^{-2}\mbox{の項})+\cdots\right]^{n}
\end{equation}

\noindent
かくして、両辺の\(n \to \infty\)における極限を取れば

\begin{equation}
\lim_{n \to \infty}M_{z_{*}}(t)=e^{\frac{t^{2}}{2}}
\label{eq496}
\end{equation}

\noindent
となり、標準正規分布の積率母関数と一致する。

\vspace{1em}

\refstepcounter{exer}\label{exer_eq496}
\noindent
{\bf 問題\thesection-\theexer}:~式\ref{eq496}が成り立つことを示せ。



\section{二項分布と正規分布}
\label{bigaus}

\(a,b\)および\(p\)を一定とするとき、確率

\begin{equation}
P(a \leq  x \leq b)=\sum_{a \leq x \leq b}\frac{n!}{x!(n-x)!}p^{x}q^{n-x}, \ \ \ \ q=1-p
\end{equation}

\noindent
は\(n\to\infty\)のとき、

\begin{equation}
\int^{(b-np)/\sqrt{npq}}_{(a-np)/\sqrt{npq}}\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}z^{2}}dz
\label{eqn48}
\end{equation}

\noindent
に収束する。

\vspace{1em}

\noindent
{\bf 証明：}

標準化された\(z=(x-np)/\sqrt{npq}\)の積率母関数は、

\begin{eqnarray}
M_{z}(t)=\sum_{x=0}^{n}\frac{n!}{x!(n-x)!}p^{x}q^{n-x}e^{t(x-np)/\sqrt{npq}}\nonumber
=e^{-\frac{np}{\sqrt{npq}}t}\sum_{x=0}^{n}\frac{n!}{x!(n-x)!}(pe^{\frac{t}{\sqrt{npq}}})^{x}q^{n-x}\nonumber\\
=e^{-\frac{np}{\sqrt{npq}}t}(q+pe^{\frac{t}{\sqrt{npq}}})^{n}\mbox{\hspace{23em}}
\end{eqnarray}

\noindent
従って、

\begin{equation}
\log M_{z}(t)=-\frac{np}{\sqrt{npq}}t+n\log(q+pe^{\frac{t}{\sqrt{npq}}})=-\frac{np}{\sqrt{npq}}t+n\log(1+u)
\label{eqn50}
\end{equation}

\noindent
但し\(u=p(-1+e^{t/\sqrt{npq}})\)となる。\(\log(1+u)\)を展開すれば、

\begin{equation}
\log(1+u)=u-\frac{u^{2}}{2}+\frac{u^{3}}{3}-\cdots
\label{eqn51}
\end{equation}

\noindent
となる。また\(u\)は\(e^{t/\sqrt{npq}}\)の展開により、

\begin{eqnarray}
u=p(-1+e^{\frac{t}{\sqrt{npq}}})
=p\left\{
\left(\frac{t}{\sqrt{npq}}\right)+
\frac{1}{2!}\left(\frac{t}{\sqrt{npq}}\right)^{2}+
\frac{1}{3!}\left(\frac{t}{\sqrt{npq}}\right)^{3}+\cdots
\right\}
\label{eqn52}
\end{eqnarray}

\noindent
となる。式\ref{eqn52}を式\ref{eqn51}に代入し、これをさらに式\ref{eqn50}に代入して整理すれば、

\begin{equation}
\log M_{z}(t)=\frac{t^{2}}{2}+\sum_{k=3}^{\infty}c_{k}\left(\frac{t}{\sqrt{npq}}\right)^{k}
\end{equation}

\noindent
となる。但し右辺の第2項は\(\frac{t}{\sqrt{npq}}\)の3次以上の項よりなる多項式で、\(c_{3},c_{4},\cdots\)は\(n\)を
含まない係数である。そこで両辺の極限を取れば\(\lim_{n\to\infty}\log M_{x}(t)=\frac{t^{2}}{2}\)、すなわち

\begin{equation}
\lim_{n\to\infty}M_{z}(t)=e^{\frac{t^{2}}{2}}
\end{equation}

\noindent
となる。これは正規分布\(N(0,1)\)の積率母関数に他ならない。よって、\(z=(x-np)/\sqrt{npq}\)は\(N(0,1)\)に
分布収束する。このことは、\(P(a\leq x \leq b)=P((a-np)/\sqrt{npq}\leq z \leq (b-np)/\sqrt{npq}\)が式\ref{eqn48}
に収束することを意味する。

\begin{flushright}
□
\end{flushright}

\newpage

\section*{略解}

\noindent
{\bf \ref{sample_distr1}-\ref{exerx2}}:~
\(E(\bar{X}^{2})=\frac{\sigma^{2}}{n}+\mu^{2}\)

\vspace{1em}

\noindent
{\bf \ref{sample_distr1}-\ref{exerx3}}:~
\ref{sample_distr1}-\ref{exerx2}の結果および\(E(X^{2})=\sigma^{2}+\mu^{2}\)を利用して、
\begin{eqnarray}
E\{\frac{1}{n}\sum_{i=1}^{n}(X_{i}-\bar{X})^{2}\}=\frac{1}{n}\sum E\left\{X_{i}^{2}-2X_{i}\bar{X}+\bar{X}^{2}\right\}
=\frac{1}{n}\sum E(X_{i}^{2})-\frac{2}{n}E(\sum X_{i}\bar{X})+\frac{1}{n}E(\sum\bar{X}^{2})\nonumber\\
=\frac{1}{n}n(\mu^{2}+\sigma^{2})-\frac{2}{n}E(n\bar{X}\bar{X})+\frac{1}{n}E(n\bar{X}^{2})
=\mu^{2}+\sigma^{2}-E(\bar{X}^{2})==\mu^{2}+\sigma^{2}-\frac{\sigma^{2}}{n}-\mu^{2}=\left(1-\frac{1}{n}\right)\sigma^{2}\ \ \nonumber 
\end{eqnarray}

\vspace{1em}


\noindent
{\bf \ref{gaus_distr1}-\ref{exer56}}:~\(y=\tan x\)として、\(\frac{dy}{dx}=\frac{1}{\cos^{2}x}\)。従って、
\(\frac{dx}{dy}=\frac{d\tan^{-1}y}{dy}=\cos^{2}x=\frac{1}{\tan^{2}x+1}=\frac{1}{y^{2}+1}\)。

\vspace{1em}

\noindent
{\bf \ref{clt}-\ref{exer_eq496}}:~
十分大きな\(n\)に対し、\(\frac{1}{n}<\frac{1}{n}+h(n)<\frac{p}{n}\)
なら、
\((1+\frac{1}{n})^{n}<(1+\frac{1}{n}+h(n))^{n}<(1+\frac{p}{n})^{n}\)
より、\(n\to\infty\)をとって、\(e < \lim_{n\to\infty}(1+\frac{1}{n}+h(n))^{n}<e^{p}\)。さらに\(n\to\infty\)
のとき、\(p\)がいくらでも1に近づけるなら、\(\lim_{n\to\infty}(1+\frac{1}{n}+h(n))^{n}=e\)。


\newpage

\begin{thebibliography}{99}
\bibitem{BI}
冨田勝(監修)
斎藤輪太郎(著)
「バイオインフォマティクスの基礎
〜ゲノム解析プログラミングを中心に〜」
サイエンス社(2005/07)
\bibitem{Hall} Hall, P(1927) "The Distribution of Means for Samples of Size N 
Drawn from a Population in which the Variate Takes Values Between 0 and 
1, All Such Values Being Equally Probable". Biometrika, Vol. 19, No. 3/4., 
pp. 240-245. 
\bibitem{Irwin} 
Irwin JO (1927) "On the Frequency Distribution of the Means of 
Samples from a Population Having any Law of Frequency with Finite 
Moments, with Special Reference to Pearson's Type II". Biometrika, Vol. 
19, No. 3/4., pp. 225-239. 
\end{thebibliography}

\newpage

\printindex

\end{document}
