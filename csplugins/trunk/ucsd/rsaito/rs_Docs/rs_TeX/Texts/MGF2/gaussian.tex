\section{正規分布}
\label{gaus_distr1}

節\ref{binom}で説明した二項分布において、
\(n\)が大きくなると、\(P(x)\)はどのような分布になっていく
のだろうか。これを以下で説明しよう。まず\(x\)を以下の式で\(z\)に正規化する。

\begin{equation}
z = \frac{(x - np)}{\sqrt{np(1-p)}} 
\label{zeq2}
\end{equation}

\noindent
このとき\(z\)が従う確率分布の確率関数を\(g(z)\)とし、\(g(z)\)を求めよう。
もう少し詳しく言うと(後述するように)、\(n\to \infty\)のとき、\(g(z)\)が
どのような確率密度関数になるかを考えるのである。\(x\)は\(0,1,2,\cdots\)
と離散的な値をとるので、\(x\)の変化量\(\Delta x\)の最小値は1である。この
とき、\(z\)の変化量\(\Delta z\)は常に

\begin{equation}
\Delta z = \frac{1}{\sqrt{np(1-p)}}
\label{zeq3}
\end{equation}

\noindent
となる。式\ref{zeq2}を式\ref{zeq3}で割って変形すると、

\begin{equation}
x=np+\frac{z}{\Delta z}
\label{zeq4}
\end{equation}

\noindent 
が得られる。式\ref{eq_binom}の\(x\)に\(x+1\)を代入すると、

\begin{equation}
P(x+1) = \ _{n}C_{x+1}\cdot p^{x+1}(1-p)^{n-x-1} 
\label{zeq5}
\end{equation}

\noindent
ここで、

\begin{displaymath}
_{n}C_{x} = \frac{n!}{x!(n-x)!}
\end{displaymath}

\noindent
を使って式\ref{zeq5}を式\ref{eq_binom}で割り、式\ref{zeq6}を代入すると、

\begin{equation}
\frac{P(x+1)}{P(x)}=\frac{(n-x)p}{(x+1)(1-p)}
\label{zeq6}
\end{equation}


\noindent
となる。さて、小節\ref{cont_dist1}での説明と同じ論法で、
\(n\to \infty\)、すなわち(式\ref{zeq3}より)\(\Delta z \to 0\)となる極限において
\(g(z)\)がどのような確率密度関数になるかを考えよう。まず式\ref{eqn_bar10}、\ref{eqn_bar_po11}
より\(P(x)=g(z)\Delta z\)、すなわち

% さてここで\(P(x)\)と\(g(z)\)の関係を考えよう。\(z\)と
% \(x\)は式\ref{zeq2}のような関係で結ばれている。さて一般的に離散的な値
% を取る確率変数\(X\)が確率密度関数\(P_{d}\)に従うとき、\(X=x\)である確率
% は\(P_{d}(x)\Delta x\)で求められる。但し、\(\Delta x\)は確率変数\(X\)
% が取り得る値の中で\(>x\)を満たす最小のものと\(x\)との差である\footnote{\(x 
% \leq X < x + \Delta x\)において、\(P_{d}(X)\)は一定と考える。}。従って
% \(g(z)\)が確率密度関数であるためには、\(g(z)\Delta z\)が確率\(P(x)\Delta 
% x=P(x)\)を表さなければならない。すなわち、

\begin{equation}
g(z)=\frac{1}{\Delta z}P(x)
\label{zeq7}
\end{equation}

\noindent
および

\begin{equation}
g(z+\Delta z)=\frac{1}{\Delta z}P(x+1)
\label{zeq8}
\end{equation}

\noindent
が成立する。式\ref{zeq8}を式\ref{zeq7}で割り、式\ref{zeq6}を代入すると、

\begin{equation}
\frac{g(z+\Delta z)}{g(z)}=\frac{P(x+1)}{P(x)}=\frac{(n-x)p}{(x+1)(1-p)}
\label{zeq9}
\end{equation}

\noindent
式\ref{zeq9}に\ref{zeq4}を代入して\(x\)を消去すると、

\begin{equation}
\frac{g(z+\Delta z)}{g(z)}=\frac{(n-np-z/\Delta z)p}{(np+z/\Delta z + 1)(1-p)}
=\frac{np(1-p)-pz/\Delta z}{np(1-p)+(1-p)(z/\Delta z + 1)}
\end{equation}

\noindent
式\ref{zeq3}より\(np(1-p)=\frac{1}{\Delta z^{2}}\)なので、これを上の式に代入して、

\begin{equation}
\frac{g(z+\Delta z)}{g(z)}=\frac{\frac{1}{\Delta z^{2}}-p\frac{z}{\Delta z}}
{\frac{1}{\Delta z^{2}}+(1-p)(\frac{z}{\Delta z} + 1)}
=\frac{1-pz\Delta z}{1+(1-p)\{z\Delta z + \Delta z^{2}\}}
\label{zeqn1}
\end{equation}

\noindent
となる。式\ref{zeqn1}を使うと、

\begin{eqnarray}
& & \frac{g(z+\Delta z)-g(z)}{\Delta z}=
\left(\frac{g(z+\Delta z)}{g(z)}-1\right)\frac{g(z)}{\Delta z}\nonumber\\
& & =\frac{1-pz\Delta z-1-(1-p)(z\Delta z+\Delta z^{2})}
{1+(1-p)(z\Delta z+\Delta z^{2})}\frac{g(z)}{\Delta z}\nonumber\\
& & =\frac{-z\Delta z-(1-p)\Delta z^{2}}{1+(1-p)(z\Delta z+\Delta z^{2})}
\frac{g(z)}{\Delta z}
=\frac{-z-(1-p)\Delta z}{1+(1-p)(z\Delta z+\Delta z^{2})}g(z)
\label{eq10}
\end{eqnarray}

\noindent
が得られる。式\ref{zeq3}より\(n \to \infty\)のとき、\(\Delta z \to 0\)となる。
このとき、式\ref{eq10}の極限は

\begin{equation}
\frac{dg(z)}{dz}=-zg(z)
\label{eq_diff_z1}
\end{equation}

\noindent
となる。これを解くと、

\begin{displaymath}
g(z)=Ce^{-\frac{1}{2}z^{2}}
\end{displaymath}

\noindent
が得られる。但し\(C\)は定数である。以下、この\(C\)を定めよう。
\(g(z)\)は確率密度関数でありまた偶関数\footnote{\(f(x)=f(-x)\)が常に成立する関数を偶関数と呼ぶ。これに対し、\(f(x)=-f(x)\)が常に成立する関数を奇関数と呼ぶ。}なので、

\begin{equation}
\int^{+\infty}_{-\infty}g(z)dz=\int^{+\infty}_{-\infty}Ce^{-\frac{1}{2}z^{2}}dz=
2\sqrt{2}C\int^{\infty}_{0}e^{-z^{2}}dz=1
\label{integ10}
\end{equation}

\noindent
が成立する。式\ref{integ10}の\(z\)を\(y\)に変えても式全体の値は変わらないから、

\begin{equation}
\left(\int^{+\infty}_{0}e^{-z^{2}}dz\right)^{2}
=\left(\int^{+\infty}_{0}e^{-z^{2}}dz\right)\left(\int^{+\infty}_{0}e^{-y^{2}}dy\right)=\int^{+\infty}_{0}\int^{+\infty}_{0}e^{-(z^{2}+y^{2})}dydz
\label{integ11}
\end{equation}

\noindent
ここで\(y=zu\)とおくと
\footnote{\(y=zu\)の制約の中でも、\(u\)の値を調整すれば、\(z,y\)は正のあらゆる組み合わせの値を取り得ることに注意。
式の中に3つの変数全て(\(z,y,u \))が登場すると、これらの3つの変数の取り得る値の組み合わせは限定される。}、
\(\frac{dy}{du}=z\)すなわち\(dy=zdu\)より、

\begin{eqnarray}
& & \int^{+\infty}_{0}\int^{+\infty}_{0}e^{-(z^{2}+y^{2})}dydz=\int^{+\infty}_{0}\left(\int^{+\infty}_{0}e^{-(1+u^{2})z^{2}}zdu\right)dz\nonumber\\
& & =\int^{+\infty}_{0}\int^{+\infty}_{0}e^{-(1+u^{2})z^{2}}zdzdu=\int^{+\infty}_{0}\left[-\frac{1}{2(1+u^{2})}\cdot e^{-(1+u^{2})z^{2}}\right]^{+\infty}_{0}du\nonumber\\
& & =\int^{+\infty}_{0}\frac{du}{2(1+u^{2})}=\frac{\pi}{4} % =\frac{1}{2}\left[{\rm tan}^{-1} u\right]^{+\infty}_{0}
\label{eqn367}
\end{eqnarray}

\noindent
となり、\(C=\frac{1}{\sqrt{2\pi}}\)が導かれる。結局\(z\)の確率密度関数は、

\begin{equation}
g(z)=\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}z^{2}}
\end{equation}

\noindent
になることが導かれた。この確率密度関数に従う分布を標準正規分布と呼ぶ。

さて節\ref{binom}で述べたように、\(np=\mu=\mbox{平均}\)、\(np(1-p)=\sigma^{2}=\mbox{分散}\)であるから、
これを式\ref{zeq2}に代入すると、

\begin{equation}
z=\frac{x-\mu}{\sigma}
\end{equation}

\noindent
従って、\(x\)の確率密度関数\(f(x)\)は定理\ref{chap_prob_distr}-\ref{prob_conv_single1}の変数変換を用いて

\begin{displaymath}
f(x)=g(\frac{x-\mu}{\sigma})\cdot\frac{dz}{dx}=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^{2}}{2\sigma^{2}}}
\end{displaymath}

\noindent
結局平均\(\mu\)、分散\(\sigma^{2}\)に従う正規分布\(N(\mu,\sigma^{2})\)の確率密度関数\(f(x)\)は

\begin{equation}
f(x)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^{2}}{2\sigma^{2}}}
\label{gaussian}
\end{equation}

\noindent
となる。


\vspace{1em}

\refstepcounter{exer}
\label{exer56}
\noindent
{\bf 問題\thechapter-\theexer}:~
三角関数の関係式\(\frac{\sin\theta}{\cos\theta}=\tan\theta,\ 
\sin^{2}\theta+\cos^{2}\theta=1,\frac{d\tan\theta}{d\theta}=\frac{1}{\cos^{2}\theta}\)を駆使して、式\ref{eqn367}の最後の部分
\(\int^{+\infty}_{0}\frac{du}{2(1+u^{2})}=\frac{\pi}{4}\)が成立すること
を示せ。
