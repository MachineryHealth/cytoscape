\chapter{シグナル配列の統計解析}
\label{entropy1}

\begin{abstract} 

DNAやRNA上には転写開始を指示する配列、翻訳開始を指示する配列、ゲノムの組
み換えを指示する配列など様々なシグナル配列が存在します。またタンパク質配
列（アミノ酸配列）にも細胞内局在シグナル配列など多種多様なシグナルが存在
します。そこで我々が知りたいのは、生体内で使われるシグナル配列はどのよう
な配列パターンを持っているかということと、そのシグナル配列の機能は何か、
ということです。

本章では主に前者の問題に焦点を当てて、シグナル配列の存在を検出する方法を
情報理論および統計解析のアプローチから考えてゆきます。

\end{abstract}

\section{シグナル配列}

ゲノムにはどのような情報が書いてあるのでしょうか？一番最初に思い浮かぶの
は、遺伝子情報でしょう。遺伝子情報は合成されるRNAやタンパク質の情報が書
いてある部分です。生命現象の多くがRNAやタンパク質によって成り立っている
ことを考えると、この領域は極めて重要であると言えます。

しかしながら、ゲノムの全領域が遺伝子をコードしているわけではありません。特に
真核生物では、遺伝子をコードしている部分はほんの数パーセントと言われてい
ます。つまりゲノムには遺伝子になる部分とならない部分があるのです。では生
体内では遺伝子をコードしている部分はどのように見分けられているのでしょう
か？

実はゲノムには遺伝子情報だけでなく、遺伝子の発現を調整するための情報も書
かれているのです。図\ref{gene_exp_mecha1_1}を見て下さい。DNA上にコードさ
れている遺伝子を含む領域はまず、mRNAという分子に写し取られます。これを転
写と呼びます。次に、mRNAの情報をもとにタンパク質が合成されます。これを翻
訳と呼びます。

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/gene_exp_mecha1_1.eps}
\caption{遺伝子の発現}
\label{gene_exp_mecha1_1}
\end{figure}

注意すべき点は、DNAの中で転写される領域は一部であり、またmRNAの中でも翻
訳されるのは一部である、ということです。すると生体の中では、DNAの中で
mRNAになる領域と、mRNAの中で翻訳される領域が見分けられていることになりま
す。

図\ref{gene_exp_mecha1_2}のように転写が開始されるときは、転写因子と呼ば
れるタンパク質がDNAの転写開始領域の近くに結合します。ある転写因子が結合
する部位の塩基配列には一定の傾向があります。例えば、大腸菌の転写開始部位
から10塩基上流にはTATAATという配列が頻繁に観測されます\cite{ent_TATA}。
また翻訳を開始するときは、リボソームと呼ばれる細胞内小器官が開始コドン付
近に結合します。バクテリアの場合、リボソームが結合する部位には
Shine-Dalgarno(SD)配列と呼ばれるA,G(プリン）に富んだ配列が観測されます
\cite{ent_label_SD}。図\ref{SD_bacteria1}に示すように、リボソーム中の16S 
rRNAの3'末端がShine-Dalgarno配列と対合するのです\cite{Osada1}。従って、SD配列は16S 
rRNAの3'末端の配列と相補的になっています。

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/gene_exp_mecha1_2.eps}
\caption{遺伝子の境界領域のシグナル配列}
\label{gene_exp_mecha1_2}
\end{figure}

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/SD_bacteria1.eps}
\caption{原核細胞における翻訳開始}
\label{SD_bacteria1}
\begin{quotation}
リボソーム中の16S rRNAの3'末端がmRNAの開始コドン上流のSD配列と対合して翻
訳が始まる。従って、16S rRNAの3'末端の配列とSD配列は相補的になっている。
\end{quotation}
\end{figure}

このようにゲノム上には転写の開始位置を示したり、翻訳開始部位を示したりと
何か生化学反応を指定するような配列パターンが数多く存在します。これを{\bf シグ
ナル配列}\footnote{シグナル配列とともによく使われる用語として「コンセン
サス配列」がある。これは複数の配列間で保存されている配列パターンである。}と呼ぶこ
とにしましょう。生物が使用するシグナル配列には様々なものがあります。例え
ばmRNA前駆体のエクソン・イントロン境界の切断部位を指定するシグナル配列は
ほとんどGT-AGという配列です。このようにほぼ一定のパターンを持つシグナル
配列もありますが、中には曖昧なシグナルもあります。例えば表
\ref{around_start_sample1}は大腸菌のいくつかの遺伝子の開始コドン周辺の塩
基配列を列挙したものです。開始コドン上流にはSD配列が存在するはずですが、
一見して共通のパターンは見当たりません。

\begin{table}
\includegraphics[scale=0.4]{Figures_EPS/around_start_sample1.eps}
\caption{大腸菌開始コドン周辺の塩基配列の例}
\label{around_start_sample1}
\end{table}

そこで、各塩基ACGTの割合がどのようになっているかを大腸菌の約4000個の遺伝
子について調べたのが表\ref{ecoli_prof}です。大腸菌の場合開始コドンの多
くはAUGなので、開始コドンの位置(+0〜+2)の塩基はA、T、Gに偏っているのが分
かります。そして上流の塩基を見ると、-11〜-8にかけて塩基がA,G(プリン）に偏っ
ているのが観測されます。これがSD配列です。このように単に配列を並べただけ
では観測が難しかった傾向が、各位置ごとの塩基の分布を計算することにより浮
き彫りになったのが分かると思います。

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/ecoli_prof.eps}
\caption{大腸菌開始コドン周辺の塩基の分布}
\label{ecoli_prof}
\begin{quotation}
表の上段に開始コドンの最初の文字からの距離を示した。開始コドンの位置を灰色にし、
開始コドンの上流は負の値にした。
\end{quotation}
\end{figure}

\section{エントロピー計算によるシグナル配列の保存性の定量}
\label{sig_entropy}

表\ref{ecoli_prof}の上流の配列を見ると、例えば-16の位置もAが33\%もあり、
偏っているように見えます。-16の位置と、-11〜-8の位置の塩基の偏りはどちら
が強いのでしょうか？それを議論するためには、偏りの程度を定量化する指標が必要にな
ってきます。その指標の１つとして考えられるのが、{\bf エントロピー}です\cite{info_theor1}。
エントロピー\(H\)は以下のように定義されます。

\begin{displaymath}
H=-\sum_{i=\rm{a,c,g,t}} P_{i}\log_{2} P_{i}
\end{displaymath}

ここで\(P_{i}\)はある位置における塩基\(i\)の頻度を表し、\(\sum_{i={\rm a,c,g,t}}P_{i}=1,0 \leq P_{i} 
\leq 1\)です。\(\log_{2} 0\)は定義されませんが、ロピタルの定理\cite{integra1}より、

\begin{displaymath}
\lim_{p \to 0}p \log_{2} p
=\lim_{p \to 0}\frac{(\log_{2}\frac{1}{p^{-1}})^{'}}{(p^{-1})^{'}}
=\lim_{p \to 0}-\frac{p}{\log 2} = 0
\end{displaymath}

\noindent
となるので、\(0 \log 0 = 0\)と定義します。

エントロピー\(H\)は0に近ければ近いほど、塩基が大きく偏っていることを意味
し、2に近ければ近いほど塩基が均等に出現していることを意味します。例えばあ
る位置において、Aが100\%を占め、残りが0の場合、

\begin{displaymath}
H=-1\log_{2}1 - 0\log_{2}0 - 0\log_{2}0 - 0\log_{2}0 = 0
\end{displaymath}
となります。A,C,G,Tが25\%ずつ均等に存在した場合は、

\begin{eqnarray*}
H= -0.25\log_{2}0.25 -0.25\log_{2}0.25 -0.25\log_{2}0.25 -0.25\log_{2}0.25\\
= -0.25 \times -2 \times 4 = 2
\end{eqnarray*}
です。その間の偏りの例として、Aが50\%, C,Gが25\%, Tが0\%の場合は、
\begin{eqnarray*}
H= -0.5\log_{2}0.5 -0.25\log_{2}0.25 -0.25\log_{2}0.25 -0\log_{2}0\\
= 0.5 + 0.5 + 0.5 + 0 = 1.5
\end{eqnarray*}
となり、先ほどの２例の間の数となります。

ここで情報理論で扱う情報量の概念についてごく簡単に触れておきます。私たち
は普段テレビや新聞、本などから様々な情報を得ています。各地の天気の情報は
毎日報じられていますが、「山形県鶴岡市で4月7日の日中の気温は12℃でした」
という情報と、「山形県鶴岡市で4月7日の日中の気温は40℃でした」という情報
ではどちらが情報量が多いと感じるでしょうか？多くの人は後者の方ではないか
と思います。何故なら前者はほとんど当たり前のように起こる出来事なので、大
した情報のようには感じませんが、後者は起こる確率が極めて低いため、ものす
ごい情報だと感じるからです。情報理論では、このように確率が低い事象が起こ
ったときの通報を情報量が多いと考え、情報の生起確率を\(P\)としたときに、
その情報量を\(-\log P\)で表します。

配列解析の話に戻ると、ゲノム上のある領域において、塩基Aが観測される確率
が\(\frac{1}{2}\)で、実際にAが観測された場合、得た情報量は
\(-\log_{2}\frac{1}{2}=1\)ビットとなります\footnote{対数の底を2にする場
合、単位はビットになる。}。エントロピーとは、ゲノム上のある位置において
得られる情報量の期待値\footnote{期待値の定義は次の通り。確率変数Xが
\(p_{1},p_{2},\cdots, p_{n}\)の確率で、値\(x_{1},x_{2},\cdots x_{n}\)を
取るとき(\(P(X=x_{i})=p_{i}\))、期待値\(E(X)=\sum_{i=1}^{n}p_{i}x_{i}\)
となる。但し\(\sum_{i=1}^{n}p_{i}=1\)である。}のことを指すのです。

さてエントロピーを使って実際に大腸菌の開始コドン周辺のエントロピーを表
\ref{ecoli_prof}をもとに計算したのが図\ref{ecoli_entropy}です。大部分の
領域は定位置にシグナル配列を含んでいないと考えられ、塩基の分布も均等にな
っているので、エントロピーは多くの位置では2に近い値を示しています。しかし、
開始コドンの1文字目の多くはAであり、2文字目、3文字目はT、Gなので、開始コ
ドンの場所のエントロピーは0に近くなっています。そして開始コドンの上流の
-9の位置のエントロピーは1.75であり、ちょうど逆向きのピークになっています。
この周辺にSD配列が存在することが分かります。

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/ecoli_entropy.eps}
\caption{大腸菌開始コドン周辺のエントロピー}
\label{ecoli_entropy}
\end{figure}

\(x > 0\)に対し\(\log_{e} x \leq x - 1\)から、\(\log_{e} \frac{1}{4P_{i}} \leq 
\frac{1}{4P_{i}} - 1\)が成立します。従って、

\begin{eqnarray*}
-\sum_{i=\mbox{a,c,g,t}}P_{i}\log_{e} P_{i} + \sum_{i=\mbox{a,c,g,t}}P_{i}\log_{e} \frac{1}{4}
=\sum_{i=\mbox{a,c,g,t}} P_{i} \log_{e} \frac{1}{4P_{i}}\\
 \leq \sum_{i=\mbox{a,c,g,t}} P_{i}(\frac{1}{4P_{i}}-1)=0
\end{eqnarray*}

\noindent
より、
\begin{eqnarray*}
-\sum_{i=\mbox{a,c,g,t}} P_{i} \log_{e} P_{i} \leq \log_{e} 4
\end{eqnarray*}
が成立します。両辺を\(\log_{e} 2\)で割ると、
\begin{eqnarray*}
-\sum_{i=\mbox{a,c,g,t}} P_{i} \log_{2} P_{i} \leq 2
\end{eqnarray*}
となります。

また\(P_{i} \geq 0\)より、\(-P_{i} \log_{2} P_{i} \geq 0\)なので、
\(\sum_{i=\mbox{a,c,g,t}}-P_{i} \log_{2} P_{i} \geq 0\)が成立します。結局、
\begin{eqnarray*}
0 \leq H \leq 2
\end{eqnarray*}

\noindent
が成立することになります。但し\(H=0\)となるのは、ある塩基\(i\)について\(P_{i}=1\)であ
り、その他の全ての塩基\(j(i \neq j)\)について\(P_{j}=0\)のときに限ります。また\(H=2\)
となるのは全ての塩基\(i\)について、\(P_{i}=\frac{1}{4}\)が成り立つときに限ります。

\(H\)はコンセンサスが強ければ0に近づき、コンセンサスが弱ければ2に近づく
指標ですが、\(H^{*}=2-H\)は逆にコンセンサスが弱ければ0に近づき、強ければ2
に近づく指標となります。しかし\(H^{*} \geq 0\)となるので、コンセンサスが全く
ない（つまり4つの塩基が完全に1/4の確率で出現する）\(H^{*}\)場合でも、
\(H^{*}\)の期待値\(E(H^{*})\)は0にはなりません。解析対象となる塩基配列の数
\(N\)が十分大きければ、

\[
E\left(H^{*}-\frac{3}{2N}{\log_{e} 2}\right)=0
\]

\noindent
となるので(\ref{ic_detail}参照)、コンセンサスが全くない場合の指標の期待
値を0にしたい場合、\(H^{*}-\frac{3}{2N}{\log_{e} 2}\)を使うといいでしょ
う\cite{info_cont}。

\section{増加情報量}
\label{rel_entropy}

エントロピーは塩基の均等使用からの偏りを測る指標でした。しかし生物種に
よってはA,C,G,Tの4塩基が均等使用から大きくずれているものもあります。例
えば、マイコプラズマ菌の一種である{\it M. genitalium}はAT含有量が高いゲ
ノムをもっています。このような生物種では、仮にある位置の塩基がAとTに偏っ
ていたとしても、直ちにその場所に何らかのシグナルがあるとは言えません。このよ
うなケースでは、その場所がAとTに偏っているのは、単にゲノム全体の塩基組
成の傾向を反映しているだけと考えたほうが妥当です。そこでゲノム全体の
塩基組成と比べて注目している位置にどれだけ強いコンセンサスがあるかを測
る指標を考えましょう。

今、あるゲノム配列の塩基\(i\)の組成を\(B_{i}\)とします。ここで、
\(\sum_{i}B_{i}=1\)です。次に注目している位置の塩基\(i\)の組成を
\(P_{i}\)とします。ここでも\(\sum_{i}P_{i}=1\)です。ある塩基\(i\)が観測
されたとき、ゲノム全体の塩基組成を考えたときに得られる情報量は、
\(-\log_{2}B_{i}\)です。しかし特定の位置に着目した場合は
\(-\log_{2}P_{i}\)であり、その差は

\begin{equation}
\label{entropy_diff1}
-\log_{2}B_{i}--\log_{2}P_{i}=\log_{2}P_{i}-\log_{2}B_{i}=\log_{2}\frac
{P_{i}}{B_{i}}
\end{equation}

\noindent
です。この式が特定の位置の塩基組成／ゲノム全体の塩基組成の対数をとった
ものであることが分かります。特定の位置に塩基\(i\)が観測されたときの式
\ref{entropy_diff1}の期待値は、塩基\(i\)の出現頻度\(P_{i}\)を掛けて

\begin{equation}
\label{relative_ent}
\sum_{i}P_{i}(\log_{2}P_{i}-\log_{2}B_{i})=\sum_{i}P_{i}\log_{2}\frac{P_{i}}{B_{i}}
\end{equation}

\noindent
となります。この式\ref{relative_ent}が増加情報量\cite{statistics1}と呼ば
れる指標になります。増加情報量は、ゲノム全体の塩基組成\(B_{i}\)に比べて、
注目している位置の塩基組成\(P_{i}\)がどれだけ異なるかということを表して
います。ゲノム全体の塩基組成と注目している位置の塩基組成が全く同じ場合、
増加情報量は0になることが直ちに導かれます。また注目している位置の塩基組
成がゲノム全体の塩基組成から離れれば、それだけ増加情報量は高い値を示しま
す。ゲノム全体の塩基組成が均等のとき、つまり全ての塩基\(i\)について、
\(B_{i}=1/4\)のときは増加情報量は\(H^{*}\)に一致するので、本質的にはエン
トロピーと同じ指標になります。

\(x>0\)に対し\(\log_{e} x \leq x-1\)から、

\begin{displaymath}
-\log_{2}\frac{B_{i}}{P_{i}} \geq -\frac{1}{\log_{e} 2}(\frac{B_{i}}{P_{i}}-1)
\end{displaymath}

\noindent
が成立し、両辺に\(P_{i}\)を掛けて総和をとると、

\begin{equation}
\sum_{i}P_{i}\log_{2}\frac{P_{i}}{B_{i}}\geq 
=-\log_{2}\sum_{i}B_{i}\frac{P_{i}}{B_{i}}=-\log_{2}1=0 
\end{equation}

\noindent
となるので、増加情報慮は常に0以上の値になることが分かります。なお0になるのは、
\(P_{i}=B_{i}, i={\rm a,c,g,t}\)のときに限ります。

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/ecoli_rel_entropy.eps}
\caption{大腸菌開始コドン周辺の増加情報量}
\label{ecoli_rel_entropy}
\end{figure}

図\ref{ecoli_rel_entropy}に大腸菌の開始コドン周辺の増加情報量を示します。
まず、開始コドンの位置に大きなピークが見られることが分かります。そして
その上流にSD配列のピーク(矢印で示した部分)が見られます。


\section{塩基の偏りの統計的有意性}
\label{chi_test_single}

これまではエントロピーや増加情報量という値を用いてコンセンサスの強さを定
量化する方法を紹介してきました。しかし統計的に考えて、本当にシグナル配列があ
るかどうかを測る指標も同時に考える必要があります。つまり例えばある位置で増加
情報量が増えるのはそこに有意な塩基の偏りがあるためなのか、あるいはただ偶
然の変動によるものなのかをしっかりと考える必要があるのです。仮に塩基の偏りが有
意であれば、それはシグナル配列の存在を示唆する１つの結果になり得ます。

統計的有意性を考える上で、最も頻繁に使われるのが、\(\chi^{2}\)値で
す。今帰無仮説\(H_{0}\)を、ある位置の塩基の偏り\(P_{i}\)はゲノム全体の
偏り\(B_{i}\)と差がないという命題とします。

\[
H_{0}:B_{i}=P_{i}\quad\mbox{for all }i
\]

次に対立仮説\(H_{1}\)を、ある位置の塩基の偏りはゲノム全体の偏りと差があ
るという命題とします。

\[
H_{1}:B_{i} \neq P_{i}\quad\mbox{for some }i
\]

この場合、\(\chi^{2}\)値は以下の式で定義されます。

\begin{equation}
\label{chi3}
\chi^{2}\mbox{値}=N\sum_{i=\rm{a,c,g,t}}\frac{(P_{i}-B_{i})^{2}}{B_{i}}
\end{equation}

但し\(N\)は解析対象の配列数です。
仮説\(H_{0}\)が正しいとき、\(\chi^{2}\)値はどのような振る舞いを示すのでしょうか？
ゲノム全体の偏りと差が全くない多数の位置に対して、\ref{chi3}の式に基づい
て\(\chi^{2}\)値を算出してゆき、ヒストグラムを作ると理論的には図
\ref{dchisq3}に示すようなものになるはずです。

\begin{figure}
\includegraphics[scale=0.6]{Figures_EPS/dchisq3.ps}
\caption{自由度3の\(\chi^{2}\)分布}
\label{dchisq3}
\begin{quotation}
横軸が\(\chi^{2}\)値、縦軸がその値を取る頻度を表す。
なお、本図はR言語を用いて作成した。
\end{quotation}
\end{figure}

図\ref{dchisq3}に示されるような分布を自由度3の\(\chi^{2}\)分布\footnote{
ここで自由度と言っているのは、自由に動ける変数の数のこと。この例では
\(P_{\rm a}, P_{\rm c},P_{\rm g},P_{\rm t}\)がそれに該当するが、
\(P_{\rm a}+P_{\rm c}+P_{\rm g}+P_{\rm t}=1\)という制約が付いているため、
3つが決まると残りの1つは自動的に決まってしまう。従って自由度は3となる。
}
と呼びます
(\(\chi^{2}\)分布の概要については、\ref{chi_discr}参照)。
式\ref{chi3}の値がどのような分布を示すかを集計したとき、理論的に図
\ref{dchisq3}の形になるとき、式\ref{chi3}は自由度3の\(\chi^{2}\)分布に従
うといい、以下のように表現します。

\[
N\sum_{i=\rm{a,c,g,t}}\frac{(P_{i}-B_{i})^{2}}{B_{i}} \sim \mbox{自由度3の}\chi^{2}\mbox{分布}
\]



図\ref{dchisq3}の分布を調べると、\(\chi^{2}\)値が12.84を超える可能性は0.5\%未
満となることが分かります。従って、ある1つの位置に着目したとき、\(\chi^{2}\)値が12.84を超
える値だったなら、それが偶然に起こる確率は極めて低いため、\(H_{0}\)が成
立するとは考えにくいことになります\footnote{あくまで1つの位置に着目した場合。
例えば1,000,000箇所の位置について\(\chi^{2}\)値を調べれば、偶然高い値を
示すようなものが現れる可能性は十分にあるため、その中の１つが12.84を超え
ていたとしても、有意ということはできない。}。つまりその位置にはゲノム全
体の傾向とは異なる塩基の偏りがあると考えていいでしょう。もっと正確な言い方
をすれば、仮説\(H_{0}\)は0.5\%の有意水準で棄却されるのです。

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/ecoli_chi.eps}
\caption{大腸菌開始コドン周辺の塩基の出現頻度の\(\chi^{2}\)値}
\label{ecoli_chi}
\end{figure}

実際に大腸菌の開始コドン周辺の\(\chi^{2}\)を調べたのが、図\ref{ecoli_chi}
です。開始コドンのところに大きなピークが見られ、その上流手前にSD配列に
よる塩基の有意な偏りがあることが分かります。

有意性の検証は以下に示す対数尤度比統計量\cite{statistics1}と呼ばれる値を
使っても行うことができます。

\begin{equation}
\label{log_likelihood1}
\mbox{対数尤度比統計量}=2N\sum_{i}P_{i}\log_{2}\frac{P_{i}}{B_{i}}
\end{equation}

解析対象となる位置の数\(N\)が大きくなると、対数尤度比統計量は\(\chi^{2}\)
値に近づくことが知られています(\ref{cor_test}参照)。式\ref{log_likelihood1}
を見ると、対数尤度比統計量は増加情報量と解析対象となる位置の数の積になっ
ています。この式より塩基の偏りの程度が一定でも、位置の数が増えるとそれだけ
対数尤度比統計量は大きくなることが分かります。言い換えると、解析対象のデータ
の数が増せば、統計的な信頼性が上がってくるため、対数尤度比統計量や
\(\chi^{2}\)値は有意な値（つまり大きな値)を示すということです。


\section{配列パターンの出現頻度解析}

これまでは１塩基あるいは１つの位置ごとに塩基の頻度や偏りを評価していました。
しかし、１塩基のみがシグナル配列として働くことはどちらかというと稀で、
通常は数塩基から数十塩基がシグナル配列として働きます。従って、これまで述べて
きた方法だけでは、どのような塩基配列パターンがシグナル配列として働いてい
るのかを調べるには不十分です。そこで複数の塩基からなるシグナル配列を検
出する簡単な方法について考えましょう。

仮に複数の配列の中に共通のシグナル配列があるとすれば、そのシグナル配列の
配列パターンが多量に観測されることが考えられます。さらにシグナル配列の出現
位置がほぼ決まっていれば、ある位置に集中してそのシグナル配列の配列パター
ンがたくさん観測されることが考えられます。

ある位置におけるある配列パターンの出現頻度は以下のように表すことができます。

\[\mbox{出現頻度}=\frac{n}{N}\]

\noindent
但し、\(n\)はある位置におけるあるパターンの観測数、\(N\)は
解析対象となった配列の数です。

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/ecoli_agg_freq.eps}
\caption{大腸菌開始コドン周辺の"AGG"の出現頻度}
\label{ecoli_agg_freq}
\begin{quotation}
開始コドンの位置の頻度は省略した。
\end{quotation}
\end{figure}

図\ref{ecoli_agg_freq}は大腸菌の開始コドン周辺における"AGG"の出現頻度を
プロットしたものです。開始コドン直前の\(-11\)の位置に"AGG"のピークがある
ことが分かります。"AGG"はSD配列の一部であり、この結果からSD配列の存在が示唆
されます。

この結果からどの程度"AGG"が出現するのかが分かりましたが、次にその出現頻度が
どれだけ偶然からは程遠いものかを評価する方法について考えましょう。今、シグナ
ル配列が含まれていない領域で特定の位置において特定の配列パターンが観測さ
れる確率は\(p\)であるとしましょう。\(N\)本の配列の中で、それぞれの特定の位置
でその配列パターンが観測された本数\(X\)が\(n\)本となる確率\(P(X=n)\)は、

\begin{equation}
P(X=n)=\frac{N!}{n!(N-n)!}p^{n}(1-p)^{N-n}
\end{equation}

\noindent
となります。従って、\(n\)本以上の配列が観測される確率は、

\begin{equation}
P(X \geq n)=\sum_{i=n}^{N}\frac{N!}{i!(N-i)!}p^{i}(1-p)^{N-i}
\end{equation}

\noindent
となります。\(Np\)および\(N(1-p)\)が十分大きいとき\footnote{\(Np \geq 5\)か
つ、\(N(1-p) \geq 5\)が１つの基準になるだろう。}、\(X\)は正規分布と呼ば
れる分布に従うことが知られています。ここでZスコア(Z Score)と呼ばれる指標を以下
の式によって定義しましょう。

\begin{equation}
\mbox{Zスコア}=\frac{n-Np}{\sqrt{Np(1-p)}}
\end{equation}

Zスコアは標準正規分布と呼ばれる分布に従うことが知られており
(\ref{stdfreq_proof}参照)、以下のように表されます。

\[
\mbox{Z スコア}\sim N(0,1)
\]

Zスコアは平均が0、標準偏差が1です。実際に大腸菌の開始コドン周辺の"AGG"の
出現頻度をプロットした結果を図\ref{ecoli_agg_Z}に示します。開始コドンの
直前の位置にSD配列の存在を示す、統計的に有意なピークが観測されていること
が分かります。またそれ以外の位置ではZスコアはさほど有意な値を示していな
い(0の周辺を振動している)ことが分かります。

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/ecoli_agg_Z.eps}
\caption{大腸菌開始コドン周辺の"AGG"の出現頻度のZ Score}
\label{ecoli_agg_Z}
\begin{quotation}
Zスコアを算出するときの\(p\)の値は、開始コドン上流500塩基〜下流500塩基の
中に含まれる"AGG"の割合で推定している。
\end{quotation}
\end{figure}

実際にはどの塩基配列パターンが有意なのかは分かりません。そこでどのパターン
が統計的に有意に出現するかを調べるためには、3塩基なら\(4^{3}=64\)通り、4
塩基なら\(4^{4}=256\)通りの全ての塩基パターンについて網羅的にZスコアを調
べる必要があります。

\begin{table}
\noindent
{\it Escherichia coli}
\begin{verbatim}
16S rRNA 3- terminal: gcggttggatcacctcctta3 ccttaaagaa
Expected SD Sequence: ttctttaagg 5taaggaggtgatccaaccgc
\end{verbatim}

\noindent
\begin{center}
\begin{tabular}{clrcclr}
Pat. & Z-Sc. & Pos. & \verb+   + & Pat. & Z-Sc & Pos. \\
\hline
agga & 94.97 & -11 &  & aaaa & 29.46 & 3 \\
ggag & 82.94 & -10 &  & aata & 19.28 & 3 \\
aagg & 58.15 & -11 &  & agta & 18.28 & 3 \\
gagg & 53.08 & -11 &  & ctaa & 16.76 & 4 \\
gaga & 42.23 & -9 &  & attg & 15.29 & 15 \\
    &     \\
\end{tabular}
\end{center}

\noindent
{\it Bacillus subtilis}
\begin{verbatim}
16S rRNA 3- terminal: ggctggatcacctcctttct3 aaggatattt
Expected SD Sequence: aaatatcctt 5agaaaggaggtgatccagcc
\end{verbatim}

\noindent
\begin{center}
\begin{tabular}{clrcclr}
Pat. & Z-Sc. & Pos. & \verb+   + & Pat. & Z-Sc & Pos. \\
\hline
ggag & 132.85 & -12 &  & aaaa & 27.03 & 3 \\
gagg & 111.09 & -12 &  & aata & 18.52 & 3 \\
agga & 95.56 & -13 &  & taaa & 16.46 & 5 \\
gggg & 84.60 & -12 &  & ctaa & 14.54 & 4 \\
aagg & 82.83 & -14 &  & aaac & 14.31 & 6 \\
    &     \\
\end{tabular}
\end{center}

\noindent
{\it Methanococcus jannaschii}
\begin{verbatim}
16S rRNA 3- terminal: actgcggctggatcacctcc3 tgagaaaaaa
Expected SD Sequence: ttttttctca 5ggaggtgatccagccgcagt
\end{verbatim}

\noindent
\begin{center}
\begin{tabular}{clrcclr}
Pat. & Z-Sc. & Pos. & \verb+   + & Pat. & Z-Sc & Pos. \\
\hline
ggtg & 189.61 & -9 &  & gtga & 29.17 & 3 \\
gtga & 172.77 & -8 &  & tatg & 20.94 & 8 \\
aggt & 67.18 & -10 &  & atgg & 19.99 & 9 \\
tggt & 53.57 & -10 &  & atga & 18.60 & 9 \\
tgat & 46.59 & -7 &  & aatg & 12.63 & 8 \\
    &     \\
\end{tabular}
\end{center}

\noindent
{\it Synechocystis PCC6803}
\begin{verbatim}
16S rRNA 3- terminal: gtggctggatcacctccttt3 aagggagacc
Expected SD Sequence: ggtctccctt 5aaaggaggtgatccagccac
\end{verbatim}

\noindent
\begin{center}
\begin{tabular}{clrcclr}
Pat. & Z-Sc. & Pos. & \verb+   + & Pat. & Z-Sc & Pos. \\
\hline
aacc & 18.94 & -4 &  & ctaa & 15.51 & 4 \\
taac & 17.52 & -5 &  & acta & 13.40 & 3 \\
cacc & 16.49 & -4 &  & ttcc & 12.18 & 8 \\
aaac & 16.45 & -5 &  & ctga & 12.10 & 4 \\
agga & 15.49 & -13 &  & acca & 11.51 & 3 \\
    &     \\
\end{tabular}
\end{center}
\caption{４種のバクテリアの開始コドン周辺に出現する有意な4塩基パターン}
\label{bact_SD_quad}
\begin{quotation}
Pat.は配列パターン、Z-Sc.はZスコア、Pos.は開始コドンからの距離を表す。
同時に各生物の16S rRNAの3'末端の配列およびそれと相補的な配列を示した。
\end{quotation}
\end{table}

表\ref{bact_SD_quad}に4種類のバクテリアについて、開始コドンの上流と下流
において顕著に出現する4塩基のパターンをZスコアが高い順に１位から5位まで
を示しました。大腸菌では、"agga"というパターンが最も顕著に出現しているこ
とが分かります。これはSD配列の一部で、掲載した4種の16S rRNAの3'末端には
"agga"と相補的な配列があることが分かります。"agga"というパターンは、枯草
菌、メタノコッカス菌においても確認できます。5位になってしまいますが、シ
アノバクテリアでも"agga"というパターンが観測されることが分かりました。な
お、シアノバクテリアの開始コドン直前には"acc"というパターンが顕著に観測
されることが発見されており\cite{ent_cyano_SD}、それが一位として検出でき
ています。



\section{塩基間の相互作用の解析}

これまで説明してきた事柄は主にコンセンサス配列、つまり塩基の保存性に関
するものでした。確かに生体内である一定の働きをするシグナル配列は一定の
配列パターンを持っていることが多いといえます。しかしシグナルとなり得る
のは配列パターンそのものだけではありません。例えばtRNAはどの塩基とどの
塩基が結合しているかという二次構造も重要です。この場合、塩基配列にはど
のような特徴が見られるのでしょうか？

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/corr_2nd_str1.eps}
\caption{RNA二次構造上の塩基間の相互作用}
\label{corr_2nd_str1}
\end{figure}

図\ref{corr_2nd_str1}(a)〜(d)に同一の二次構造を持つRNA配列を示しました。この
中で太文字になっている塩基を変えていますが、ステム上、それと反対側にある塩
基を常に対合するようにしています。つまりAに対してT、Cに対してGが反対側に来
るようにしています。すると太文字の位置は常に結合するため、結果的に同じ二次
構造が維持されます。この場合は配列の保存性よりもむしろ塩基間の相互作用が重
要になっています。塩基間の相互作用とは簡単に言えば、ある位置の塩基と他の位
置の塩基の出現に何らかの従属関係があることだと言えます。

では、塩基間の相互作用の強さを測るにはどのような指標が考えられるでしょうか？
ここで位置uおよびvにおけるエントロピーをそれぞれ
\(H_{\mbox{u}},H_{\mbox{v}}\)とします。次に位置u,vにおける塩基の結合エント
ロピー\(H_{\mbox{u,v}}\)を以下のように定義します。

\begin{equation}
H_{\mbox{u,v}}=-\sum_{i={\rm a,c,g,t}}\sum_{j={\rm a,c,g,t}}
P_{\mbox{u}:i,\mbox{v}:j}\log_{2}P_{\mbox{u}:i,\mbox{v}:j}
\end{equation}

\noindent
但し\(P_{\mbox{u}:i,\mbox{v}:j}\)は、位置uに塩基\(i\)が観測され、かつ位
置vに塩基\(j\)が観測される配列の割合です。結合エントロピーは位置uの塩
基と、位置vの塩基を一続きのパターンと見立てたときのそのパターンのエント
ロピーと考えることができます。今位置uの塩基\(i\)の頻度を\(P_{\mbox{u}:i}\)、
位置vの塩基\(j\)の塩基の頻度を\(P_{\mbox{v}:j}\)とします。位置uの塩基と位
置vの塩基の間に何の従属関係もなければ、十分多くの配列に対し、

\begin{equation}
P_{\mbox{u}:i,\mbox{v}:j}=P_{\mbox{u}:i}P_{\mbox{v}:j}
\end{equation}

\noindent
が成立するはずです。この場合、

\begin{equation}
H_{\mbox{u,v}}=H_{\mbox{u}} + H_{\mbox{v}}
\label{no_corr}
\end{equation}

\noindent
が成立します。また逆に位置uとvの位置の塩基に完全な従属関係が成り立つ場合、
すなわち位置uの塩基が決まれば位置vの塩基が完全に決まる場合は、

\begin{equation}
\label{perf_corr}
H_{\mbox{u,v}}=H_{\mbox{u}}=H_{\mbox{v}}
\end{equation}

\noindent
が成立します。

ここで、位置uと位置vの間の塩基の相互作用の強さを表す相互情報量
\(I_{\mbox{u,v}}\)は以下のように定義されます\cite{texbook}。

\begin{equation}
\label{mutual_info1}
I_{\mbox{u,v}}=H_{\mbox{u}} + H_{\mbox{v}} - H_{\mbox{u,v}}
\end{equation}

位置uの塩基と位置vの塩基の間に何の従属関係もなければ、式\ref{no_corr}よ
り\(I_{\mbox{u,v}}=0\)であり、また逆に完全な従属関係が成り立つ場合は式
\ref{perf_corr}より\(I_{\mbox{u,v}}=H_{\mbox{u}}=H_{\mbox{v}}\)となります。

式\ref{mutual_info1}は以下のようにも書き換えられます。

\begin{equation}
\label{mutual_info2}
I_{\mbox{u,v}}=
\sum_{i={\rm a,c,g,t}}\sum_{j={\rm a,c,g,t}}P_{\mbox{u}:i,\mbox{v}:j}
\log_{2}\frac{P_{\mbox{u}:i,\mbox{v}:j}}{P_{\mbox{u}:i} P_{\mbox{v}:j}}
\end{equation}

\begin{figure}
\includegraphics[scale=0.4]{Figures_EPS/corr_sample2.eps}
\caption{相互情報量の計算例}
\label{corr_sample2}
\end{figure}

では図\ref{corr_sample2}の位置u,vの塩基について実際に相互情報量を計算し
てみましょう。(a)〜(c)のどれについても位置u,vに4種類の塩基a,c,g,tが均等に出
現するため、\(H_{\mbox{u}}=H_{\mbox{v}}=2\)です。次に結合エントロピー
と相互情報量を計算してみましょう。(a)のケースでは、16種類の
a-a,a-c,a-g,...,t-c,t-g,t-tの全ての組み合わせの塩基の組が均等に出現する
ため、\(H_{\mbox{u,v}}=4\)です。従って、\(I_{\mbox{u,v}}=0\)となります。次
に(b)のケースでは、位置u,vについて8種類の組み合わせの塩基の組が出現して
いるため、\(H_{\mbox{u,v}}=3\)であり、\(I_{\mbox{u,v}}=1\)となります。(c)の
ケースでは、位置u,vについて4種類の組み合わせの塩基の組しか出現していません。
従って、\(H_{\mbox{u,v}}=2\)、\(I_{\mbox{u,v}}=2\)となります。

(a)のケースでは、uの位置の塩基の出現と、vの位置の塩基の出現に関連は全く
なく、相互情報量が0になっています。一方(c)のケースでは、uの位置の塩基が決
まれば、vの位置の塩基は完全に決まっています。つまり、uとvの位置の塩基に強い相関
が見られ、相互情報量は最大値である2になっています。(b)の場合は、uの位置の塩基が
決まると、vの位置の塩基は2種類のうちの1つに限定され、相互情報量は1になり、(a)と
(c)のケースの中間になります。

\begin{figure}
\includegraphics[scale=0.5]{Figures_EPS/tRNA_str1.eps}
\caption{大腸菌tRNAの二次構造の例}
\label{tRNA_str1}
\end{figure}

\begin{table}
\includegraphics[scale=0.6]{Figures_EPS/tRNA76_77_aln.eps}
\caption{大腸菌tRNAの配列}
\label{tRNA76_77_aln}
\end{table}

実際に大腸菌のtRNAの配列を相互情報量によって解析した例を示します。tRNAは
コード領域のコドンとアミノ酸を対応させるRNA分子です。その二次構造は図
\ref{tRNA_str1}のようになっていることがわかっています。大腸菌で長さ
が76〜77塩基のものをアラインメントにかけたものを表
\ref{tRNA76_77_aln}に示します。

これらのtRNA配列の全位置の組み合わせに対して、相互情報量を計算したのが、
表\ref{ecoli_tRNAs76_77_mi}です。図\ref{tRNA_str1}で見られた塩基が対合して
いる領域(A-H, B-C, D-E, F-G)において相互情報量が高くなっているのが分かります。

\begin{table}
\includegraphics[scale=0.5]{Figures_EPS/ecoli_tRNAs76_77_mi.eps}
\caption{大腸菌tRNAの相互情報量}
\label{ecoli_tRNAs76_77_mi}
\begin{quotation}
表\ref{tRNA76_77_aln}に掲載したtRNA配列の全ての位置間の相互情報量を
計算した結果を示した。一番左の列と、一番上の行に組となる位置を示し、
対応する相互情報量(1の位のみ)をマスの中に書いた。相互情報量の大きさに応じて
マスの色を濃くした。表の欄外には図\ref{tRNA_str1}に対応する位置をラベルし、
対合している箇所(ステム構造)を丸の点線で囲った。
\end{quotation}
\end{table}



\section{塩基間の相互作用の統計的有意性}

最後に塩基間の従属関係の強さではなく、統計的な有意性を調べる方法について
触れておきます。これは節\ref{chi_test_single}で説明した方法と同一の理論的背景を
持っており、詳しくは\ref{cor_test}にまとめておきました。

今仮説\(H_{0}\)を、位置uとvの塩基はそれぞれ独立に出現するという命題とし
ます。

\[H_{0}: P_{\mbox{u,v}}(i,j)=P_{\mbox{u}}(i)P_{\mbox{v}}(j)\]

但し、\(P_{\mbox{u,v}}(i,j)\)はある一本の配列において、位置uに塩基\(i\)
が、位置vに塩基\(j\)が観測される確率とし、実際に観測された割合
\(P_{\mbox{u}:i,\mbox{v}:j}\)とは区別して考えます。同様に、
\(P_{\mbox{u}}(i)\)、\(P_{\mbox{v}}(j)\)はそれぞれ位置uに置いて塩基\(i\)
が観測される確率と位置vにおいて塩基\(j\)が観測される確率です。

次に対立仮説\(H_{1}\)を、位置uとvに出現する塩基の間には何らかの相関があ
るという命題とします。

\[H_{1}: P_{\mbox{u,v}}(i,j) \neq P_{\mbox{u}}(i)P_{\mbox{v}}(j)\]

仮説\(H_{0}\)が正しいとすれば、以下の式によって算出される\(\chi^{2}\)値は
自由度9の\(\chi^{2}\)分布に従います\cite{statistics1}。

\begin{equation}
\label{corr_test1}
\chi^{2}\mbox{値}=\sum_{i=\mbox{a,c,g,t}}\sum_{j=\mbox{a,c,g,t}}
\frac{(N_{\mbox{u}:i,\mbox{v}:j}-\frac{N_{\mbox{u}:i}N_{\mbox{v}:j}}{N})^{2}}
     {\frac{N_{\mbox{u}:i}N_{\mbox{v}:j}}{N}}
\end{equation}

但し、\(N\)は解析対象の配列の数、\(N_{\mbox{u}:i}\)は位置uに塩基\(i\)が
存在する配列の本数、\(N_{\mbox{v}:j}\)は位置vに塩基\(j\)が存在する配列の
本数、\(N_{\mbox{u}:i,\mbox{v}:j}\)は位置uに塩基\(i\)が存在し、位置vには
塩基\(j\)が存在する配列の本数です。以下の式が成り立つことに注意しましょう。

\[
P_{\mbox{u}:i}=\frac{N_{\mbox{u}:i}}{N}, \quad
P_{\mbox{v}:j}=\frac{N_{\mbox{v}:j}}{N}, \quad
P_{\mbox{u}:i,\mbox{v}:j}=\frac{N_{\mbox{u}:i,\mbox{v}:j}}{N}
\] 

\(N\)が十分大きいとき、式\ref{corr_test1}は近似的に以下の対数尤度比統計
量に近づきます(\ref{cor_test}参照)。

\begin{equation}
\label{corr_log_like}
\mbox{対数尤度比統計量}
=2N\sum_{i=1}^{r}\sum_{j=1}^{c}P_{\mbox{u}:i,\mbox{v}:j}
\log\frac{P_{\mbox{u}:i,\mbox{v}:j}}{P_{\mbox{u}:i}P_{\mbox{v}:j}}
\end{equation}

式\ref{corr_log_like}は配列の本数と相互情報量の積の2倍になっています。これ
は相互作用の程度が同じでも、配列の本数が多ければそれだけ有意になることを
意味しています。

\begin{practice}
\item 複数のDNA配列上のある特定の位置において、Aが50\%、
Cが50\%、G、Tが0\%観測されているときのこの位置のエントロピーを求めましょう。
\item 対照となる塩基の頻度を\(B_{\rm a}=0.3,B_{\rm c}=0.2,B_{\rm g}=0.2,B_{\rm t}=0.3\)として、
与えられた位置における塩基\(i\)の個数\(N_{i}\)が
\begin{enumerate}
\item \(N_{\rm a}=50, N_{\rm c}=30, N_{\rm g}=10, N_{\rm t}=10\)
\item \(N_{\rm a}=500, N_{\rm c}=300, N_{\rm g}=100, N_{\rm t}=100\)
\end{enumerate}
のときの増加情報量、\(\chi^{2}\)値をそれぞれ求めましょう。
\item 下の位置u,vの塩基間の相互情報量を求めましょう。
\begin{verbatim}

             u v
             ---
             A A
             A A
             A G
             A T
             C C
             C C
             C G
             C T

\end{verbatim}
\item 相互情報量を表す式\ref{mutual_info2}から式\ref{mutual_info1}を導出しましょう。
\end{practice}







