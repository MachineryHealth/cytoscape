\section{相関係数}
\setcounter{exer}{0}
\setcounter{preexer}{0}
\setcounter{theorem}{0}


これまで人の身長など単一の特徴を表した数値の羅列や、単一の確率変数の特徴
を表す指標として平均や分散を定義してきた。しかし現実には個人の身長と体重
など2つ1組となる数値も存在する。この場合、おそらくは身長が高い人は体重も
重くなるなるだろう。本節では、2つ1組の数値あるいは確率変数の関係性の強さ
を表す指標を導入しよう。

今2つ1組の数値\(n\)組\(
(x_{11},x_{21}),
(x_{12},x_{22}),
(x_{13},x_{23}),
\cdots,
(x_{1n},x_{2n}),
\)を考える。各組の先頭の数値データ\(x_{11},x_{12},\cdots,x_{1n}\)をグループ1、2番目の数値データ\(x_{21},x_{22},\cdots,x_{2n}\)
をグループ2とすると、それぞれのグループに対して
平均を求めることが可能である。すなわち、

\begin{displaymath}
\mu_{1}=\frac{1}{n}\sum_{i=1}^{n}x_{1i}\ \ \ \ \ \mu_{2}=\frac{1}{n}\sum_{i=1}^{n}x_{2i}
\end{displaymath}

\begin{displaymath}
\sigma_{1}=\frac{1}{n}(x_{1i}-\mu_{1})\ \ \ \ \ \sigma_{2}=\frac{1}{n}(x_{2i}-\mu_{2})
\end{displaymath}

\noindent
である。このとき

\begin{equation}
\sigma_{1,2}^{2}=\frac{1}{n}\sum_{i=1}^{n}(x_{1i}-\mu_{1})(x_{2i}-\mu_{2})
\label{eq_covar18}
\end{equation}

\noindent
で定義される\(\sigma_{1,2}^{2}\)を
\(x_{11},x_{12},\cdots,x_{1n}\)と\(x_{21},x_{22},\cdots,x_{2n}\)の{\bf 
共分散}\index{きょうぶんさん@共分散}という。式\ref{eq_covar18}を眺めると、
各々の数値の組\((x_{1i},x_{2i})\)が同時にそれぞれのグループの平均
\(\mu_{1},\mu_{2}\)を上回っていたり、逆に同時に下回っているときに、共分
散\(\sigma_{1,2}^{2}\)の値が大きくなることが想像できる。しかし2つのグループに、
一方が平均を上回っているときに他方が平均を下回るような関
係があるとき、共分散は負の値を示すようになる。両者が互いに全く関係ない値
を示すようになると、\((x_{1i}-\mu_{1})(x_{2i}-\mu_{2})\)は正の値も負の値
も示すようになり、それらの平均である共分散は0に近くなる。このように共分散は対応関係
のある2つのグループの数値が互いにどれほど強い関係を持っているかの指
標となる。
式\ref{eq_covar18}で
\(\sigma_{1,1}^{2}\)は\(\frac{1}{n}\sum_{i=1}^{n}(x_{1i}-\mu_{1})^{2}=\sigma_{1}^{2}\)
となり、\(x_{1i}(i=1,2,\cdots,n)\)の分散に一致し、\(\sigma_{2,2}^{2}\)は\(\frac{1}{n}\sum_{i=1}^{n}(x_{2i}-\mu_{2})^{2}=\sigma_{2}^{2}\)
となって\(x_{2i}(i=1,2,\cdots,n)\)の分散に一致することに注意されたい。

1つのグループに含まれる全要素を\(\beta\)倍すると、共分散も\(\beta\)倍されてしまう。
これは共分散は単位が変わると、値も変わってしまうことを意味する。例えば先程触れた身長と
体重の場合、身長の単位をm(メートル)からcm(センチメートル)に変えただけで、共分散は100倍になってしまうのである。
そこで、値の大小に関わらず
関係の強さを定量化できる指標を以下で紹介しよう。

まず\(x_{1i}\)と\(x_{2i}\)のデータの標準化(節\ref{avvar1}参照)を行う。

\begin{displaymath}
z_{1i}=\frac{x_{1i}-\mu_{1}}{\sigma_{1}}\ \ \ \ \ 
z_{2i}=\frac{x_{2i}-\mu_{2}}{\sigma_{2}}
\end{displaymath}

\noindent
こうすると、元のデータがどのような分布をしていても、それを変換した
\(z_{1i}, z_{2i} (i=1,2,\cdots, n)\)は2つとも平均が0、分散が1になる。そし
て{\bf 相関係数}\index{そうかんけいすう@相関係数}\(r\)は以下の式で定義さ
れる\footnote{正確にはピアソンの積率相関係数。}。

\begin{equation}
r=\frac{1}{n}\sum_{i=1}^{n}z_{1i}z_{2i}
\label{eqn_corr100}
\end{equation}

共分散のときと同じように、\(x_{1i}\)と\(x_{2i}\)が同時に大きな値または同時に小さな値を示せば、\(z_{1i}\)と
\(z_{2i}\)が同時に正または負になる機会が多くなり、その積の和である\(r\)
は正に大きくなることが分かる。逆に\(z_{1i}\)と\(z_{2i}\)の大きさが
ちょうど正反対であれば、\(z_{1i}\)と\(z_{2i}\)の符号が逆になる機会が多く
なり、その積の和である\(r\)は負に大きくなる。また\(z_{1i}\)と\(z_{2i}\)
の間に相関がなければ、\(z_{1i}z_{2i}\)は正の値も負の値もとるようになり、
その和は0に近くなる。\(r\)が取りうる値の範囲について以下の定理が成り立つ。

\vspace{1em}
\refstepcounter{theorem}
\noindent
{\bf 定理\thesection-\thetheorem}:~相関係数\(r\)について、

\begin{equation}
-1 \leq r \leq 1
\end{equation}

\noindent
が成立する。

\noindent
{\bf 証明\thesection-\thetheorem}:~
\(z_{1i},z_{2i}\)とも実数であり、\(n > 0\)であるから、
\(t\in R\)について、\(\frac{1}{n}\sum_{i=1}^{n}(z_{1i}-tz_{2i})^{2}\geq 0\)である。
ここで、

\begin{equation}
\frac{1}{n}\sum_{i=1}^{n}(z_{1i}-tz_{2i})^{2}
=\frac{1}{n}\sum_{i=1}^{n}z_{1i}^{2}-\frac{2t}{n}\sum_{i=1}^{n}z_{1i}z_{2i}+\frac{t^{2}}{n}\sum_{i=1}^{n}z_{2i}^{2}
\label{eqn_corr875}
\end{equation}

\noindent
となるが、\(z_{1i}\)も\(z_{2i}\)も平均が0、分散が1であるから、

\begin{eqnarray}
V(z_{1i})& = & \frac{1}{n}\sum_{i=1}^{n}(z_{1i}-E(z_{1i}))^{2}=\frac{1}{n}\sum_{i=1}^{n}z_{1i}^{2}=1\label{eqn_corr876}\\
V(z_{2i})& = & \frac{1}{n}\sum_{i=1}^{n}(z_{2i}-E(z_{2i}))^{2}=\frac{1}{n}\sum_{i=1}^{n}z_{2i}^{2}=1\label{eqn_corr877}
\end{eqnarray}

\noindent
が成立する。式\ref{eqn_corr100}、\ref{eqn_corr876}、\ref{eqn_corr877}を式\ref{eqn_corr875}に代入すると、

\begin{equation}
\frac{1}{n}\sum_{k=1}^{n}(z_{1i}-tz_{2i})^{2}=(t-r)^{2}-r^{2}+1 \geq 0
\label{eq_corr232}
\end{equation}

\noindent
が成立する。任意の\(t \in R\)に対して\((t-r)^{2} \geq 0\)なので、
\(-1 \leq r \leq 1\)となる。
\(r=\pm 1\)のとき、\(t=\pm 1\)とすると、式\ref{eq_corr232}より
\(\frac{1}{n}\sum_{k=1}^{n}(z_{1i}\pm z_{2i})^{2}=0\)(複号同順)。
\(z_{1i}\pm z_{2i}\)の平均が0であることに注意すると、これは
\(z_{1i}\pm z_{2i}\)の分散が0、すなわち\(z_{1i}\pm z_{2i}=\mbox{定数}=0\)である
ことを意味する。従って\(r=\pm 1\)となるのは、\(z_{1i}=\mp z_{2i}\)すなわち\(x_{2i}=\mu_{2}\pm \frac{\sigma_{2}}{\sigma_{1}}(x_{1i}-\mu_{1})\)
のときに限る。

\begin{flushright}
□
\end{flushright}


\begin{figure}
\includegraphics[scale=0.6]{Figures/corr_sample1.eps}
\caption{2つ1組の変数\((x_{i},y_{i})\)のプロットに対応する相関係数}
\label{corr_sample1}
\end{figure}

有意に\(r > 0\)が認められるとき、2つのグループの数値には正の相関があるといい、また有意に\(r < 0\)が認められるときは
負の相関があるという。両方とも認められないときは2つのグループは無相関であるという。
図\ref{corr_sample1}に3種類の\((x_{1i},x_{2i})\)をプロットし、相関係数を計算した結果を示す。(a)
には正の相関、(c)には負の相関が見られ、相関係数はそれぞれ正と負の値を示
している。

\vspace{1em}

\refstepcounter{exer}
\noindent
{\bf 問題\thesection-\theexer}:~ 数列\(5,4,6,2,8\)とこれに先頭から順に対応する数列\(-4,-4,-4,-4,6\)との間の相関係数を求めよ。

\refstepcounter{exer}
\noindent
{\bf 問題\thesection-\theexer}:~ 相関係数\(r\)は

\begin{equation}
r=\frac{\sum_{i=1}^{n}(x_{1i}-\mu_{1})(x_{2i}-\mu_{2})}{\sqrt{\sum_{i=1}^{n}(x_{1i}-\mu_{1})^{2}}\sqrt{\sum_{i=1}^{n}(x_{2i}-\mu_{1})^{2}}}
=\frac{\sigma_{1,2}^{2}}{\sigma_{1}\sigma_{2}}
\end{equation}

\noindent
と表せることを示せ。

\refstepcounter{exer}
\noindent
{\bf 問題\thesection-\theexer}:~ \(z_{1i}\)と\(z_{2i}\)との間に\(z_{2i}=az_{1i}+b\)\ (\(a,b\)は定数、\(a \neq 0\))の関係があるとき、\(r\)は1または-1になることを示せ。


