<!--
  ** build.xml - ant build file
  ** Written by Samad Lotia
  **
  ** ################################
  **
  **          COMPILING ISSUES
  **
  ** If you're having trouble with compiling,
  ** make sure to update the cytoscape.root.dir
  ** and cytoscape.distro.dir properties.
  **
  ** ################################
  -->

<project name="SessionForWebPlugin" default="all" basedir=".">

  <!-- ===================================================================	-->
  <!-- Properties								-->
  <!-- ===================================================================	-->

  <property name="root.dir"			location="."/>
  <property name="manifest.dir"			location="${root.dir}/manifest"/>
  <property name="build.dir"			location="${root.dir}/build"/>
  <property name="resources.dir"			location="${root.dir}/resources"/>

  <!-- Project directories and files -->
  <property name="project.src.dir"		location="${root.dir}/src"/>
  <property name="project.jar"			location="${root.dir}/SessionForWebPlugin.jar"/>
  <property name="project.jar.manifest"		location="${manifest.dir}/project.manifest"/>

  <!-- Cytoscape directories and files needed for compiling -->
  <property name="cytoscape.root.dir"		location="../../cytoscape-2.5"/>
  <property name="cytoscape.lib.dir"		location="${cytoscape.root.dir}/lib"/>
  <!-- Cytoscape directories and files needed for installing -->
  <property name="cytoscape.distro.dir"		location="${cytoscape.root.dir}/build/cytoscape-v2.5.1"/>
  <property name="cytoscape.distro.plugins.dir"	location="${cytoscape.distro.dir}/plugins"/>

  <!-- Project jar properties -->
  <property name="project.jar.main.class"	value="SessionForWebPlugin.SessionForWebPlugin"/>
  <path id="project.jar.class.path">
    <pathelement location="${cytoscape.root.dir}/cytoscape.jar"/>
    <pathelement location="${cytoscape.lib.dir}/cytoscape-render-stateful.jar"/>
    <pathelement location="${cytoscape.lib.dir}/cytoscape-task.jar"/>
    <pathelement location="${cytoscape.lib.dir}/swing-layout-1.0.1.jar"/>
  </path>
  
  <!-- ===================================================================	-->
  <!-- compile									-->
  <!-- ===================================================================	-->

  <target	name="compile"
  		description="compile project's class files">

    <mkdir dir="${build.dir}"/>
    <javac	srcdir="${project.src.dir}"
    		destdir="${build.dir}"
		debug="yes"
		classpathref="project.jar.class.path"/>
    
  </target>

  <!-- ===================================================================	-->
  <!-- manifest 								-->
  <!-- ===================================================================	-->

  <target	name="manifest"
  		description="generate project jar's manifest file">
		
    <mkdir dir="${manifest.dir}"/>
    <manifest file="${project.jar.manifest}">
      <attribute name="Cytoscape-Plugin" value="${project.jar.main.class}"/>
    </manifest>
    
  </target>

  <!-- ===================================================================	-->
  <!-- jar									-->
  <!-- ===================================================================	-->

  <target	name="jar"
  		depends="compile,manifest"
		description="package all class files into a jar">
    <copy file="${resources.dir}/plugin.props" todir="${build.dir}"/>
    <copy file="${resources.dir}/SessionForWeb.png" todir="${build.dir}/SessionForWebPlugin"/>
    <copy file="${resources.dir}/StatusMsgs.properties" todir="${build.dir}"/>
    <jar	jarfile="${project.jar}"
    		basedir="${build.dir}"
    		manifest="${project.jar.manifest}"/>
  </target>
  
  <!-- ===================================================================	-->
  <!-- install 									-->
  <!-- ===================================================================	-->

  <target	name="install"
  		depends="jar"
		description="install plugin into Cytoscape's plugin directory">
    <copy file="${project.jar}" todir="${cytoscape.distro.plugins.dir}"/>
  </target>

  <!-- ===================================================================	-->
  <!-- all				                                      	-->
  <!-- ===================================================================	-->
  <target name="all" depends="jar"/>

  <!-- ===================================================================	-->
  <!-- clean 									-->
  <!-- ===================================================================	-->
  <target name="clean">
  
    <delete dir="${build.dir}"/>
    <delete dir="${manifest.dir}"/>
    <delete file="${project.jar}"/>
    
  </target>

</project>
