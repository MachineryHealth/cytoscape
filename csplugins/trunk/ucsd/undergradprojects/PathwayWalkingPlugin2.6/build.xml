<!-- =================================================================== -->
<!-- NCBI Web Service Client plugin (NCBIClient.jar) build file     
			08/29/2007 Written by Keiichiro Ono (kono@ucsd.edu)       -->
<!-- =================================================================== -->

<project name="pathwayWalking" default="pathwayWalking" basedir=".">

	<!-- =================================================================== -->
	<!-- Initialization target                                               -->
	<!-- =================================================================== -->
	<target name="init-pathwayWalking">
		<tstamp />
		<property name="pathwayWalking.Name" value="Senior Design Pathway Walking" />
		<property name="pathwayWalking.name" value="pathwayWalking" />
		<property name="pathwayWalking.version" value="0.1" />
		<property name="pathwayWalking.year" value="2008" />

		<echo message="Building ${pathwayWalking.name} version ${pathwayWalking.version}." />

		<!-- Inheritable properties -->
		<property name="debug" value="on" />
		<property name="optimize" value="off" />
		<property name="deprecation" value="on" />
		<property name="nowarn" value="true" />
		<property name="fork" value="false" />
		<property name="pathwayWalking.root.dir" value="." />

		<!-- You need to modify this line to point to Cytoscape directory.  -->
		<property name="cytoscape.dir" value="${pathwayWalking.root.dir}/../newCytoscape" />

		<property name="cytoscape.lib.dir" value="${cytoscape.dir}/lib" />
		<property name="cytoscape.plugin.dir" value="${cytoscape.dir}/plugins" />
		<property name="cytoscape.build.dir" value="${cytoscape.dir}/build/cytoscape-v2.6.0-beta1" />

		<!-- JUnit report directory -->
		<property name="junit.report.dir" value="${pathwayWalking.root.dir}/junit-reports" />

		<path id="project.class.path">
			<pathelement path="${java.class.path}/" />
		</path>

		<!-- Define the directories -->
		<property name="pathwayWalking.root.dir" value="./" />
		<property name="pathwayWalking.src.dir" value="${pathwayWalking.root.dir}/src" />
		<property name="pathwayWalking.lib.dir" value="${pathwayWalking.root.dir}/lib" />
		<property name="pathwayWalking.tests.dir" value="${pathwayWalking.root.dir}/tests" />
		<property name="pathwayWalking.classes.dir" value="${pathwayWalking.root.dir}/classes" />
		<property name="pathwayWalking.testclasses.dir" value="${pathwayWalking.root.dir}/testClasses" />
		<property name="pathwayWalking.javadoc.dir" value="${javadoc.dir}/pathwayWalking" />
		<property name="pathwayWalking.resources.dir" value="${pathwayWalking.root.dir}/resources" />
		<property name="pathwayWalking.manifest.dir" value="${pathwayWalking.root.dir}/manifest" />
		<property name="pathwayWalking.packages" value="pathwayWalking.*" />
		<!-- Subdirectory for test reports -->
		<property name="pathwayWalking.tests.reports.dir" value="${pathwayWalking.root.dir}/reports/tests" />

		<!-- Define the condition for compilation -->
		<property name="cytoscape.jar" value="${cytoscape.dir}/cytoscape.jar" />

		<condition property="cytoscape.present">
			<and>
				<available file="${cytoscape.jar}" />
			</and>
		</condition>

		<!-- Define excludes for pathwayWalking compile and javadoc -->
		<property name="pathwayWalking.excludes" value="**/notyet/*" />
		<property name="pathwayWalking.tests.excludes" value="**/notyet/*" />
		<property name="pathwayWalking.packages.excludes" value="**.test.*,**.notyet.*" />

		<path id="pathwayWalking.project.class.path">
			<pathelement location="${pathwayWalking.classes.dir}" />
			<pathelement path="${pathwayWalking.root.dir}/pathwayWalkingTests.jar/" />
			<fileset dir="${pathwayWalking.lib.dir}">
				<include name="*.jar" />
			</fileset>
			<fileset dir="${cytoscape.dir}">
				<include name="*.jar" />
			</fileset>
			<fileset dir="${cytoscape.lib.dir}">
				<include name="*.jar" />
			</fileset>
			<fileset dir="${cytoscape.lib.dir}/build-libs">
				<include name="*.jar" />
			</fileset>
			<fileset dir="${pathwayWalking.root.dir}/../IntActClient">
				<include name="*.jar" />
			</fileset>
			<fileset dir="${pathwayWalking.root.dir}/../NCBIClientPlugin">
				<include name="*.jar" />
			</fileset>
			<fileset dir="${pathwayWalking.root.dir}/../NCBIClientPlugin/lib">
				<include name="*.jar" />
			</fileset>
			<fileset dir="${pathwayWalking.root.dir}/../NCBIClientPlugin/lib/axis-1_4/lib">
				<include name="*.jar" />
			</fileset>
		</path>


	</target>

	<!-- =================================================================== -->
	<!-- Clean up, get back to original state                                -->
	<!-- =================================================================== -->
	<target name="clean" depends="init-pathwayWalking">
		<delete dir="${pathwayWalking.classes.dir}" />
		<delete dir="${pathwayWalking.testclasses.dir}" />
		<delete dir="${pathwayWalking.tests.reports.dir}" />
		<delete file="pathwayWalking.jar" />
		<delete file="${pathwayWalking.lib.dir}/pathwayWalking.jar" />
	</target>

	<!-- =================================================================== -->
	<!-- Compiles the pathwayWalking project                                           -->
	<!-- =================================================================== -->
	<target name="compile-pathwayWalking" depends="init-pathwayWalking">

		<echo message=" COMPILE pathwayWalking " />

		<mkdir dir="${pathwayWalking.classes.dir}" />
		<javac srcdir="${pathwayWalking.src.dir}" excludes="${pathwayWalking.excludes}" classpathref="pathwayWalking.project.class.path" destdir="${pathwayWalking.classes.dir}" debug="${debug}" nowarn="${nowarn}" deprecation="${deprecation}" optimize="${optimize}" fork="${fork}" />
	</target>

	<!-- =================================================================== -->
	<!-- Creates the pathwayWalking.jar file                                           -->
	<!-- =================================================================== -->
	<target name="pathwayWalking" depends="compile-pathwayWalking">
		<!-- copy over images -->
		<copy todir="${pathwayWalking.classes.dir}/images">
			<fileset dir="${pathwayWalking.root.dir}/images" />
		</copy>

		<copy todir="${pathwayWalking.classes.dir}/edu/ucsd/bioeng/idekerlab/PathwayWalkingPlugin" file="${pathwayWalking.manifest.dir}/plugin.props" />

		<unjar dest="${pathwayWalking.classes.dir}">
			<fileset dir="${pathwayWalking.lib.dir}">
				<include name="*.jar" />

				<exclude name="pathwayWalking.jar" />
				<exclude name="pathwayWalkingTest.jar" />
			</fileset>
		</unjar>

		<jar destfile="pathwayWalking.jar" manifest="${pathwayWalking.manifest.dir}/pathwayWalking.manifest">
			<fileset dir="${pathwayWalking.classes.dir}" includes="**" />
			<fileset dir="${pathwayWalking.root.dir}/lib" includes="resources/**" />
		</jar>

	</target>

	<!-- =================================================================== -->
	<!-- release                                             -->
	<!-- =================================================================== -->
	<target name="release" depends="testAll">
		<copy todir="${pathwayWalking.lib.dir}" file="pathwayWalking.jar" />
	</target>

	<!-- =================================================================== -->
	<!-- Compiles the pathwayWalking tests                                             -->
	<!-- =================================================================== -->
	<target name="compile-tests" depends="pathwayWalking">
		<mkdir dir="${pathwayWalking.testclasses.dir}" />
		<javac srcdir="${pathwayWalking.tests.dir}" includes="**/*" classpathref="pathwayWalking.project.class.path" destdir="${pathwayWalking.testclasses.dir}" debug="${debug}" deprecation="${deprecation}" optimize="${optimize}" fork="${fork}" />
	</target>

	<!-- =================================================================== -->
	<!-- Creates the pathwayWalkingTests.jar file                                     -->
	<!-- =================================================================== -->
	<target name="tests" depends="compile-tests">
		<jar jarfile="pathwayWalkingTests.jar" basedir="${pathwayWalking.testclasses.dir}" includes="**/*" />
	</target>

	<!-- =================================================================== -->
	<!-- Build all jars                                                      -->
	<!-- =================================================================== -->
	<target name="all" depends="pathwayWalking" />

	<!-- =================================================================== -->
	<!-- Run the Plugin                                                      -->
	<!-- =================================================================== -->
	<target name="run" depends="pathwayWalking">
		<java classname="cytoscape.cytoscape" classpathref="pathwayWalking.project.class.path" fork="true" />
		<arg line="-p ${pathwayWalking.lib.dir}/pathwayWalking.jar" />
	</target>


	<!-- =================================================================== -->
	<!-- Runs the tests in pathwayWalkingTests.jar                                    -->
	<!-- =================================================================== -->
	<target name="runtests" depends="tests">
		<mkdir dir="${pathwayWalking.tests.reports.dir}" />
		<junit printsummary="yes" haltonfailure="no" dir="${pathwayWalking.classes.dir}" maxmemory="1G">
			<formatter type="plain" usefile="true" />
			<classpath refid="pathwayWalking.project.class.path" />
			<!-- The junit task doesn't support 'if' so we test for JUnit here -->
			<batchtest fork="yes" todir="${pathwayWalking.tests.reports.dir}" if="junit.present">
				<fileset dir="${pathwayWalking.classes.dir}" includes="**/test/*" excludes="${pathwayWalking.tests.excludes}" />
			</batchtest>
		</junit>
	</target>

	<!-- ======================================================= -->
	<!-- Run all of the Swing Unit Tests                       -->
	<!-- ======================================================= -->
	<target name="test-swing" depends="pathwayWalking">
		<mkdir dir="${pathwayWalking.tests.reports.dir}" />
		<junit printsummary="yes" haltonfailure="no" maxmemory="1G" filtertrace="off" includeantruntime="true" showoutput="on">

			<classpath>
				<fileset dir="${pathwayWalking.root.dir}">
					<include name="**/*.jar" />
				</fileset>
				<fileset dir="${pathwayWalking.root.dir}/lib">
					<include name="**/*.jar" />
				</fileset>
				<fileset dir="${cytoscape.lib.dir}">
					<include name="**/*.jar" />
				</fileset>
				<fileset dir="${cytoscape.lib.dir}/build-libs">
					<include name="**/*.jar" />
				</fileset>
				<fileset dir="${cytoscape.dir}">
					<include name="**/*.jar" />
				</fileset>
				<fileset dir="${pathwayWalking.root.dir}/testClasses">
					<include name="**/*" />
				</fileset>
			</classpath>
			<formatter type="plain" usefile="true" />
			<formatter type="xml" usefile="true" />
			<batchtest fork="yes" todir="${pathwayWalking.tests.reports.dir}">
				<fileset dir="${pathwayWalking.tests.dir}" includes="**/*TestSwing.java" />
			</batchtest>

		</junit>
		<junitreport todir="${pathwayWalking.tests.reports.dir}">
			<fileset dir="${pathwayWalking.tests.reports.dir}">
				<include name="TEST-*.xml" />
			</fileset>
			<report format="frames" todir="${pathwayWalking.tests.reports.dir}" />
		</junitreport>


		<fail message="JUnit Tests failed! Check ${pathwayWalking.tests.reports.dir}/index.html for details." if="junit.test.failure" />

	</target>


	<!-- =================================================================== -->
	<!-- Runs all test cases.                                    -->
	<!-- =================================================================== -->
	<target name="testAll" depends="tests">
		<echo>
	            ***********************************************
	            Running all unit tests individually. 
	            ***********************************************
		</echo>
		<mkdir dir="${junit.report.dir}" />
		<junit printsummary="yes" haltonfailure="no" maxmemory="512m">
			<classpath refid="pathwayWalking.project.class.path" />
			<formatter type="plain" usefile="true" />
			<formatter type="xml" usefile="true" />
			<batchtest fork="yes" todir="${junit.report.dir}" filtertrace="no">
				<fileset dir="${pathwayWalking.tests.dir}" includes="**/*Test.java" excludes="**/AllTests.java" />
			</batchtest>
		</junit>

		<junitreport todir="${junit.report.dir}">
			<fileset dir="${junit.report.dir}">
				<include name="TEST-*.xml" />
			</fileset>
			<report format="frames" todir="${junit.report.dir}" />
		</junitreport>
		<delete file="pathwayWalkingTests.jar" />
	</target>


	<!-- =================================================================== -->
	<!-- Creates the API documentation                                       -->
	<!-- =================================================================== -->
	<target name="docs" depends="init-pathwayWalking">
		<mkdir dir="${pathwayWalking.javadoc.dir}" />
		<javadoc packagenames="${pathwayWalking.packages}" excludepackagenames="${pathwayWalking.packages.excludes}" sourcepath="${pathwayWalking.src.dir}" destdir="${pathwayWalking.javadoc.dir}" classpathref="pathwayWalking.project.class.path" author="true" version="true" use="true" splitindex="true" noindex="false" windowtitle="${pathwayWalking.Name} API" doctitle="${pathwayWalking.Name}" />
	</target>

</project>

<!-- End of file -->
