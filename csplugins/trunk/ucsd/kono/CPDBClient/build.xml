<?xml version = "1.0"?>
<project name="cpdbClient" default="all" basedir=".">

	<property name="src" location="src" />
	<property name="build" location="build" />
	<property name="build.compiler" value="modern" />
	<!-- path to Cytoscape under development (CVS) -->
	<property name="cylib" location="../cytoscape" />
	<property name="lib" location="lib" />
	<property name="testlib" location="junitLib" />
	<property name="jar" location="jar" />
	<property name="doc" location="doc" />
	<property name="projectName" value="cpdbClient" />

	<property name="cytoscape.plugin" value="${lib}/plugins" />

	<path id="classpath">
		<fileset dir="${cylib}">
			<include name="**/*.jar" />
		</fileset>
		<fileset dir="${lib}">
			<include name="**/*.jar" />
		</fileset>
		<fileset dir="${testlib}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<target name="prepare" depends="clean">
		<mkdir dir="${build}" />
	</target>

	<target name="compile" depends="prepare"
		description="Compile with Cytoscape under development">
		<!-- Compile the java code from ${src} into ${build} -->
		<javac source="1.5" debug="true" deprecation="true" srcdir="${src}"
			destdir="${build}">
			<classpath refid="classpath" />
		</javac>
	</target>

	<target name="clean" description="clean up">
		<!-- Delete the ${build} and ${src} directory trees -->
		<delete dir="${build}" />
		<delete dir="${jar}" />
	</target>

	<target name="jar" depends="compile"
		description="makes a jar for Cytoscape under development">
		<mkdir dir="${jar}" />
		<unzip dest="${build}">
			<fileset dir="${lib}" includes="*" />
		</unzip>
		<copy todir="build/org/cytoscape/webservice/cpdb" file="resources/plugin.props" />
		
		<jar jarfile="${jar}/${projectName}.jar">
			<manifest>
				<attribute name="Cytoscape-Plugin"
					value="org.cytoscape.webservice.cpdb.CPDBClientPlugin" />
			</manifest>
			<fileset dir="${build}" />
		</jar>
	</target>

	<target name="all" depends="jar" />

	<target name="run" depends="jar" description="Run under development">
		<java classname="cytoscape.CyMain" classpathref="classpath" fork="true"
			maxmemory="1g">
			<arg line="--JLD" />
			<arg line="${jar}/${projectName}.jar" />
			<arg line="-vt" />
			<arg line="5000" />
		</java>
	</target>


	<!-- Target to Run JavaDoc -->
	<target name="doc" description="Runs JavaDoc.">
		<javadoc packagenames="cytoscape.groups.results.*" sourcepath="src"
			source="1.5" destdir="doc" classpathref="classpath_release">
			<link href="http://java.sun.com/j2se/1.5.0/docs/api/" />
			<link href="http://csbi.sourceforge.net/API/" />
			<link href="http://chianti.ucsd.edu/Cyto-2_6_3/javadoc/" />
		</javadoc>
	</target>

</project>