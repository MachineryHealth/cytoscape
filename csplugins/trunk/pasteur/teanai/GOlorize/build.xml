<?xml version="1.0"?>
<!--
	GOlorize Ant Build Script.
	Author:  Olivier Garcia
-->

<project name="GOlorize" default="all" basedir=".">

    <!-- The build directory -->
    <!-- All files generated by ant go here -->
    <property name="build.dir"    value="${basedir}/build"/>

    <!-- The java source directory-->
    <property name="src.dir"      value="${basedir}/src"/>

    <!-- The lib directory -->
    <!-- Contains all third-party JAR files, required for compilation -->
    <property name="lib.dir"       value="lib"/>

    <!-- The dist directory -->
    <property name="dist.dir"    value="${basedir}/plugins"/>

    <!-- The config directory -->
    <property name="config.dir"    value="${basedir}/config"/>

    <!-- The cytoscape directory -->
    <property name="cytoscape.dir"    value="../../../../../cytoscape-v2.2"/>

    <!-- ============= Custom Ant Task Definitions ======================= -->

	<!--  ============ Compilation Control Options ======================= -->
  	<property name="compile.debug"       value="true"/>
  	<property name="compile.deprecation" value="true"/>
  	<property name="compile.optimize"    value="true"/>

	<!-- ==================== Compilation Classpath ====================== -->
    <!--
        NB:  Compilation classpath assumes that main cytoscape project is checked out,
        and compiled.
    -->
    <path id="compile.classpath">
		<pathelement path="${build.dir}/classes"/>
                <fileset dir="${lib.dir}">
                     <include name="*.jar"/>
                </fileset>
		<fileset dir="${cytoscape.dir}/lib">
       		 	<include name="*.jar"/>
		</fileset>
                <fileset dir="${cytoscape.dir}">
                     <include name="cytoscape.jar"/>
                </fileset>
  	</path>

    <!-- ==================== Clean Target =============================== -->
    <target name="clean"
        description="Deletes all build files and starts fresh">
        <delete dir="${build.dir}"/>
        <delete file="${dist.dir}/GOlorize.jar"/>
    </target>

    <!-- ==================== Compile Target ==============================-->
    <target name="compile" depends="prepare"
        description="Compiles all Java source files">
        <mkdir dir="${build.dir}/classes"/>
        <javac srcdir="${src.dir}"
		    source="1.5"
            destdir="${build.dir}/classes"
            debug="${compile.debug}"
            deprecation="${compile.deprecation}"
            optimize="${compile.optimize}">
        <classpath refid="compile.classpath"/>
        </javac>
    </target>

    <!-- ==================== Jar Target ============================== -->
    <target name="jar" depends="compile"
            description="Creates Plugin Jar:  GOlorize.jar">
        <jar destfile="${dist.dir}/GOlorize.jar"
             basedir="${build.dir}/classes"/>
    </target>

    <!-- ==================== Run Target ============================== -->
    <target depends="jar" description="Runs Latest Version of Cytoscape with GOlorize Plugin"
        name="run">
        <java classname="cytoscape.CyMain" classpathref="compile.classpath"
            fork="true" maxmemory="1000M">
            <arg line="-p plugins"/>
        </java>
    </target>

    <!-- ==================== Build jar =================================== -->
    <target name="all" depends="jar"/>

    <!-- ==================== Prepare Target ============================== -->
    <target name="prepare">
        <!-- Create build directories as needed -->
        <mkdir  dir="${build.dir}"/>
        <mkdir  dir="${dist.dir}"/>
        <mkdir  dir="${build.dir}/classes"/>

        <!--  Copy over images / icons -->
        <copy todir="${build.dir}/classes">
          <fileset dir="${src.dir}">
            <include name="**/*.gif"/>
	    <include name="**/*.png"/>
          </fileset>
        </copy>
    </target>

</project>
