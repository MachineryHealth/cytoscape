<!doctype html>
<html>
	<head>
		<title>Cytoscape Web: SVG prototype</title>
		<style>
			#page {
				font-family: sans-serif;
				color: #404040;
				width: 640px;
				margin: 30px auto;
			}
		</style>
		<script type="text/javascript" src="springy.js"></script>
		<script type="text/javascript" src="cytoscapeweb-svg.js"></script>
		<script type="text/javascript" src="jquery-1.6.2.js"></script>
		<!-- <script type="text/javascript" src="arbor.js"></script> -->
		
		<script type="text/javascript">
		

			var styles = {};
			
			styles.basicStyle = {
				global: {
					backgroundColor: "#eeeeee"
				},
				nodes: {
					size: 16,
					color: "#f5f5f5",
					borderColor: "#666666",
					borderWidth: 3,
					opacity: 1,
				},
				edges: {
					color: "#999999",
					width: 3,
					opacity: 0.8
				}
			}
			
			
			styles.demoStyle = {
				global: {
					backgroundColor: "#fcfcfc"
				},
				nodes: {
					color: "#cccccc",
					size: 14,
					borderWidth: 2,
					borderColor: "#707070",
					labelColor: "none"
				},
				edges: {
					color: "#0b94b1",
					width: 2
				}
			}
			
			
			styles.darkStyle = {
				global: {
					backgroundColor: "#202020"
				},
				nodes: {
					color: "#d0d0d0",
					opacity: 0.8,
					borderWidth: 4,
					borderColor: "#f8f8f8",
				},
				edges: {
					color: "#ffffff",
					opacity: 0.7,
					width: 4
				}
			}
			
			
			var graphs = {};
			
			graphs.simpleGraph = {
				nodes: [{
					id: "n1",
					x: 220,
					y: 30
				}, {
					id: "n2",
					x: 0,
					y: 97
				}, {
					id: "n3",
					x: 54,
					y: 185
				}, {
					id: "n4",
					x: 200,
					y: 191
				}, {
					id: "n5",
					x: 210,
					y: 254
				}, {
					id: "n6",
					x: 60,
					y: -5
				}, {
					id: "n7",
					x: 280,
					y: 170
				}],
				edges: [{
					id: "e1",
					source: "n1",
					target: "n2",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e2",
					source: "n2",
					target: "n1",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e3",
					source: "n1",
					target: "n3",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e4",
					source: "n2",
					target: "n3",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e5",
					source: "n4",
					target: "n5",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e6",
					source: "n5",
					target: "n2",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e7",
					source: "n3",
					target: "n5",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e8",
					source: "n1",
					target: "n4",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e9",
					source: "n3",
					target: "n4",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e10",
					source: "n4",
					target: "n6",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e11",
					source: "n6",
					target: "n4",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e12",
					source: "n3",
					target: "n6",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e14",
					source: "n4",
					target: "n7",
					style: {
						forwardArrowShape: "DELTA",
						backwardArrowShape: "DELTA"
					}
				}, {
					id: "e13",
					source: "n4",
					target: "n7",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, {
					id: "e15",
					source: "n7",
					target: "n4",
					style: {
						forwardArrowShape: "DELTA"
					}
				}, ]
			}
			graphs.petersenGraph = {
				nodes: [{
					id: "nw2",
					x: -27,
					y: 97
				}, {
					id: "sw2",
					x: 24,
					y: 255
				}, {
					id: "se2",
					x: 210,
					y: 254
				}, {
					id: "ne2",
					x: 254,
					y: 90
				}, {
					id: "n2",
					x: 109,
					y: -10
				}, {
					id: "sw",
					x: 73,
					y: 190
				}, {
					id: "se",
					x: 154,
					y: 190
				}, {
					id: "nw",
					x: 46,
					y: 115
				}, {
					id: "ne",
					x: 176,
					y: 113
				}, {
					id: "n",
					x: 109,
					y: 65
				}],
				edges: [{
					id: "e1",
					source: "nw2",
					target: "n2"
				}, {
					id: "e2",
					source: "nw2",
					target: "nw"
				}, {
					id: "e4",
					source: "sw2",
					target: "nw2"
				}, {
					id: "e5",
					source: "sw2",
					target: "sw"
				}, {
					id: "e6",
					source: "se2",
					target: "sw2"
				}, {
					id: "e7",
					source: "se2",
					target: "se"
				}, {
					id: "e8",
					source: "ne2",
					target: "se2"
				}, {
					id: "e9",
					source: "ne2",
					target: "ne"
				}, {
					id: "e10",
					source: "n2",
					target: "ne2"
				}, {
					id: "e11",
					source: "n2",
					target: "n"
				}, {
					id: "e12",
					source: "sw",
					target: "se"
				}, {
					id: "e13",
					source: "nw",
					target: "sw"
				}, {
					id: "e14",
					source: "nw",
					target: "se"
				}, {
					id: "e15",
					source: "nw",
					target: "ne"
				}, {
					id: "e16",
					source: "ne",
					target: "sw"
				}, {
					id: "e17",
					source: "ne",
					target: "se"
				}, {
					id: "e18",
					source: "n",
					target: "sw"
				}, {
					id: "e19",
					source: "n",
					target: "se"
				}, {
					id: "e20",
					source: "n",
					target: "nw"
				}, {
					id: "e21",
					source: "n",
					target: "ne"
				}, ]
			}
			
			
			graphs.ringGraph = {
				"nodes": [{
					"id": "n1",
					"x": 38,
					"y": 219,
					"style": {
						size: 32,
						borderColor: "black",
						color: "teal",
						shape: "DIAMOND",
						borderWidth: 4
					}
				}, {
					"id": "n2",
					"x": 57,
					"y": 44,
					"style": {
						size: 26,
						color: "chocolate",
						borderWidth: 6
					}
				}, {
					"id": "n3",
					"x": 171,
					"y": 28,
					"style": {
						size: 16,
						borderColor: "green",
						shape: "RECTANGLE",
						borderWidth: 2
					}
				}, {
					"id": "n4",
					"x": 251,
					"y": 132,
					"style": {
						size: 12,
						borderColor: "blue",
						shape: "DIAMOND",
						borderWidth: 4
					}
				}, {
					"id": "n5",
					"x": 156,
					"y": 220,
					"style": {
						borderColor: "red"
					}
				}],
				"edges": [{
					"id": "e1",
					"source": "n1",
					"target": "n2",
					"style": {
						forwardArrowShape: "DELTA",
						color: "#394",
						width: 3
					}
				}, {
					"id": "e2",
					"source": "n2",
					"target": "n3",
					"style": {
						forwardArrowShape: "DELTA",
						backwardArrowShape: "DELTA",
						width: 3
					}
				}, {
					"id": "e3",
					"source": "n3",
					"target": "n4",
					"style": {
						color: "red",
						width: 6,
						style: "DASH"
					}
				}, {
					"id": "e4",
					"source": "n4",
					"target": "n5",
					"style": {
						forwardArrowShape: "DELTA",
						color: "blue",
						width: 5
					}
				}, {
					"id": "e5",
					"source": "n5",
					"target": "n4",
					"style": {
						forwardArrowShape: "DELTA",
						width: 5
					}
				}, {
					"id": "e6",
					"source": "n5",
					"target": "n1",
					"style": {
						style: "DOT"
					}
				}]
			}
			
			// Create a populated graph for stress testing
			var pg = {nodes:[], edges:[]};
			
			for (var x = 0; x < 100; x++) {
				pg.nodes.push({"id": "n"+x, "x": Math.floor(Math.random()*400)-86, "y": Math.floor(Math.random()*400)-50, "style": {"size": 6+ Math.floor(Math.random()*18)}});
			}
			
			for (var y = 0; y < 300; y++) {
				pg.edges.push({"id": "e"+y, "source": "n"+Math.floor(Math.random()*50), "target": "n"+ (50+Math.floor(Math.random()*50))});
			}
			graphs.pg = pg;
			
			// Initialize
			var vis;
			window.onload = function() {
				vis = new Visualization("container-div", 640, 640);
				sr = new SpringyRenderer();
				load("simpleGraph");
				setstyle("basicStyle");
			}
			
			// Load a graph
			var ps; // arbor.ParticleSystem
			var sr; // springyrenderer
			function load(graph) {
				vis.loadGraph(graphs[graph]);
				/*
				if (ps) {
					ps.renderer.die();
					ps.stop();
					ps = null;
				}
				ps = arbor.ParticleSystem(800, 600, 0.5);
				ps.parameters({gravity: true});
				ps.renderer = new ArborRenderer(vis);
				
				var nodes = vis.getNodes();
				for (var i = 0; i < nodes.length; i++) {
					ps.addNode(nodes[i]._id); 
				}
				
				var edges = vis.getEdges();
				
				for (var i = 0; i < edges.length; i++) {
					
					ps.addEdge(edges[i]._source._id,
					 edges[i]._target._id); 
				}
				*/
				//sr.render(vis);
				/*
				var clickEvent = function() {
					alert("Clicked node '" + this._id + "' at " + this._x + ", " + this._y);
				}
				
				for (var i = 0; i < nodes.length; i++) {
					nodes[i].addListener("click", clickEvent);
				}
				*/
				vis.draw();
			}
			
			function setstyle(style) {
				vis.loadStyles(styles[style]);
				vis.draw();
			}




			
			
				

		</script>
	</head>
	<body>
		<div id="page">
			<h1>Cytoscape Web &mdash; SVG</h1>
			<p>By Marek Zaluski for GSoC 2011</p>
			<div id="container-div"></div>
			Load graph:
			<select onchange="load(this.options[selectedIndex].value)">
				<option selected value="simpleGraph">Simple graph</option>
				<option value="petersenGraph">Petersen graph</option>
				<option value="ringGraph">Style demo</option>
				<option value="pg">Large graph</option>
			</select>
			Load style:
			<select onchange="setstyle(this.options[selectedIndex].value)">
				<option selected value="basicStyle">Basic Style</option>
				<option value="demoStyle">Classic Style</option>
				<option value="darkStyle">Dark style</option>
				
			</select>
			
		</div>
	</body>
</html>
