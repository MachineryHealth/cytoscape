<?xml version="1.0"?>
<!-- Filters Ant Build Script.  Author:  Peng-Liang Wang -->

<project name="filters" default="all" basedir=".">

 <!-- The build directory -->
 <!-- All files generated by ant go here -->
 <property name="build.dir"    value="${basedir}/build"/>

 <!-- The java source directory-->
 <property name="src.dir"      value="${basedir}/src"/>

 <!-- The lib directory -->
 <!-- Contains all third-party JAR files, required for compilation -->
 <property name="lib.dir"       value="lib"/>

 <!-- The dist directory -->
 <property name="dist.dir"    value="${basedir}/dist"/>

 <!--  ============ Compilation Control Options ======================= -->
 <property name="compile.debug"       value="true"/>
 <property name="compile.deprecation" value="true"/>
 <property name="compile.optimize"    value="true"/>
 <property name="cytoscape.dir"    value="../../cytoscape"/>

 <!-- ==================== Compilation Classpath ====================== -->
 <path id="compile.classpath">
  <fileset dir="${lib.dir}">
   <include name="*.jar"/>
  </fileset>
  <!--
  <fileset dir="${cytoscape.dir}/lib">
   <include name="*.jar"/>
  </fileset>
  -->
  <fileset dir="${cytoscape.dir}">
   <include name="cytoscape.jar"/>
  </fileset>
 </path>

 <!-- ==================== Clean Target =============================== -->
 <target name="clean"
        description="Deletes all build files and starts fresh">
  <delete dir="${build.dir}"/>
  <delete dir="${dist.dir}"/>
 </target>

 <!-- ==================== Compile Target ==============================-->
 <target name="compile" 
         depends="prepare"
         description="Compiles all Java source files">
  <mkdir dir="${build.dir}/classes"/>
  <javac srcdir="${src.dir}"
         source="1.5"
         destdir="${build.dir}/classes"
         debug="${compile.debug}"
         deprecation="${compile.deprecation}"
         optimize="${compile.optimize}">
   <classpath refid="compile.classpath"/>
  </javac>
 </target>

 <!-- ==================== Jar Target ============================== -->
 <target name="jar" 
         depends="compile"
         description="Creates Plugin Jar:  filters.jar">
  <jar destfile="${dist.dir}/filters.jar"
       basedir="${build.dir}/classes">
   <manifest>
    <attribute name="Cytoscape-Plugin" 
               value="cytoscape.filters.FilterPlugin"/>
   </manifest>
  </jar>
 </target>

 <!-- ==================== Build and test jar ============================== -->
 <target name="all" depends="jar,test"/>

 <!-- ==================== Prepare Target ============================== -->
 <target name="prepare">
  <!-- Create build directories as needed -->
  <mkdir  dir="${build.dir}"/>
  <mkdir  dir="${dist.dir}"/>
  <mkdir  dir="${build.dir}/classes"/>
  <!--  Copy over images / icons -->
  <copy todir="${build.dir}/classes">
   <fileset dir="${src.dir}">
    <include name="**/*.gif"/>
    <include name="**/*.png"/>
   </fileset>
  </copy>
 </target>

 <!-- ==================== JUnit Test Target =========================== -->
 <target name="test" 
         description="Runs all JUnit tests" 
         depends="compile">
  <junit printsummary="yes" 
         fork="yes" 
         haltonfailure="yes">
   <formatter type="plain" 
              usefile="false"/>
   <test name="csplugins.test.AllTest"/>
   <classpath refid="compile.classpath"/>
  </junit>
 </target>

</project>
